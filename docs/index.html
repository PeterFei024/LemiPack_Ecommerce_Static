<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>乐美包装电商平台</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://code.iconify.design/3/3.1.1/iconify.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
<style>
    html { min-height: 100%; }
    body { min-height: 100vh; display: flex; flex-direction: column; }
    main { flex: 1 0 auto; }
    footer { flex-shrink: 0; }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    .tab-content { display: none; }
    .tab-active { display: block; }
    .step { display: none; }
    .step-active { display: block; }
    .submenu-section { display: none; }
    .submenu-section-active { display: block; }
    .design-new-view { display: none; }
    .design-new-view:not(.hidden) { display: block; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .sku-table-row { transition: background-color 0.2s ease; }
    .sku-table-row:hover { background-color: #eff6ff; }
    #skuDetailContainer > div { animation: fadeIn 0.3s ease-in; }
    #companyInfoModal > div { animation: slideUp 0.3s ease-out; }
  </style>
</head>
<body class="bg-gray-100">
<!-- 顶部导航 -->
<header class="bg-blue-800 text-white sticky top-0 z-50 h-20 shadow-lg">
<div class="container mx-auto px-4 flex items-center justify-between h-full">
<div class="flex items-center pl-0">
<span class="iconify text-2xl" data-icon="mdi:package-variant"></span>
<h1 class="text-lg font-bold ml-2 whitespace-nowrap" data-i18n="nav.company-name">乐美包装</h1>
</div>
<nav class="flex items-center space-x-4 flex-1 justify-center">
<button class="tab-btn py-2 px-3 rounded-lg hover:bg-blue-700 transition text-sm whitespace-nowrap" data-tab="home" data-i18n="nav.home">首页</button>
<button class="tab-btn py-2 px-3 rounded-lg hover:bg-blue-700 transition text-sm whitespace-nowrap" data-tab="configurator" data-i18n="nav.configurator">订单配置</button>
<button class="tab-btn py-2 px-3 rounded-lg hover:bg-blue-700 transition text-sm whitespace-nowrap" data-tab="orders" data-i18n="nav.orders">我的订单</button>
<button class="tab-btn py-2 px-3 rounded-lg hover:bg-blue-700 transition text-sm whitespace-nowrap" data-tab="finance" data-i18n="nav.finance">财务信息</button>
<button class="tab-btn py-2 px-3 rounded-lg hover:bg-blue-700 transition text-sm whitespace-nowrap" data-tab="design-management-new" data-i18n="nav.design-management-new">画稿管理（新）</button>
<button class="tab-btn py-2 px-3 rounded-lg hover:bg-blue-700 transition text-sm whitespace-nowrap" data-tab="contact" data-i18n="nav.contact">联系我们</button>
</nav>
<div class="flex items-center space-x-3 flex-shrink-0">
<div class="relative">
<input id="searchInput" class="bg-blue-700 rounded-full py-1.5 pl-3 pr-20 text-white placeholder-blue-200 w-64 text-sm" placeholder="搜索产品..." type="text" data-i18n="nav.search-placeholder"/>
<span class="iconify absolute right-10 top-1.5 text-blue-200 text-sm pointer-events-none" data-icon="mdi:magnify"></span>
<button id="imageSearchBtn" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-blue-200 hover:text-white transition cursor-pointer" data-i18n-title="nav.image-search" title="图片搜索">
<span class="iconify text-sm" data-icon="mdi:camera"></span>
</button>
<!-- 图片粘贴区域 -->
<div id="imagePasteArea" class="hidden absolute top-full left-0 mt-2 bg-white rounded-lg shadow-lg border border-gray-200 p-4 w-64 z-50">
<div class="flex items-center justify-between mb-3">
<h4 class="text-sm font-semibold text-gray-800" data-i18n="nav.image-search-title">图片搜索</h4>
<button id="closeImagePasteArea" class="text-gray-400 hover:text-gray-600">
<span class="iconify text-sm" data-icon="mdi:close"></span>
</button>
</div>
<div id="pasteImageContainer" class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer hover:border-blue-500 transition min-h-32 flex flex-col items-center justify-center">
<div id="pasteImagePlaceholder">
<span class="iconify text-3xl text-gray-400 mb-2" data-icon="mdi:image-plus"></span>
<p class="text-xs text-gray-500" data-i18n="nav.paste-image">粘贴图片或拖拽图片到这里</p>
<p class="text-xs text-gray-400 mt-1" data-i18n="nav.image-formats">支持 JPG、PNG 格式</p>
</div>
<img id="pastedImagePreview" class="hidden max-w-full max-h-48 rounded" alt="粘贴的图片" data-i18n-alt="nav.pasted-image"/>
</div>
<div id="imageSearchActions" class="hidden mt-3 flex space-x-2">
<button id="searchByImageBtn" class="flex-1 bg-blue-600 hover:bg-blue-500 text-white py-2 px-4 rounded-lg text-sm font-semibold flex items-center justify-center" data-i18n="nav.search-similar">
<span class="iconify mr-2" data-icon="mdi:magnify"></span>
搜索相似图片
</button>
<button id="clearImageBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg text-sm" data-i18n="nav.clear">
清除
</button>
</div>
</div>
</div>
<button id="cartBtn" class="bg-green-600 hover:bg-green-500 text-white py-1.5 px-4 rounded-full flex items-center text-sm whitespace-nowrap relative">
<span class="iconify mr-1 text-sm" data-icon="mdi:cart"></span><span data-i18n="nav.cart">购物车</span>
<span id="cartCou
nt" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
        </button>
<div class="relative">
<select id="languageSelect" class="bg-blue-700 hover:bg-blue-600 text-white py-1.5 px-3 rounded-lg cursor-pointer appearance-none pr-6 border border-blue-600 text-sm">
<option value="zh">中文</option>
<option value="en">English</option>
</select>
<span class="iconify absolute right-1 top-1.5 text-white pointer-events-none text-sm" data-icon="mdi:chevron-down"></span>
</div>
<div class="bg-blue-700 rounded-lg px-3 py-1.5 text-xs max-w-xs cursor-pointer hover:bg-blue-600 transition group" id="companyInfoBtn" title="点击查看公司详细信息">
<div class="text-white font-semibold whitespace-nowrap flex items-center">
<span id="companyNameDisplay">章三包装有限公司</span>
<span class="iconify ml-1 text-xs transition-transform group-hover:translate-y-0.5" data-icon="mdi:chevron-down"></span>
</div>
</div>
</div>
</div>
</header>
<!-- 页面内容区 -->
<main class="container mx-auto p-6 max-w-6xl">
<!-- 首页 -->
<section class="tab-content tab-active" id="home">
<div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
<h2 class="text-2xl font-bold text-blue-800 mb-6" data-i18n="home.company-intro">公司介绍</h2>
<div class="flex items-center">
<div class="w-2/3 pr-8">
<p class="text-gray-700 mb-4 leading-relaxed" data-i18n="home.company-desc1">
              乐美包装是领先的包装材料解决方案提供商，专注于为食品饮料、电子产品等行业提供高质量包装产品。拥有超过10年行业经验，服务全球500+企业客户。
            </p>
<p class="text-gray-700 mb-6 leading-relaxed" data-i18n="home.company-desc2">
              我们提供纸箱、泡沫、胶带等全品类包装材料，支持定制化设计和批量生产，满足不同行业的包装需求。
            </p>
<div class="flex space-x-4">
<button class="bg-blue-600 hover:bg-blue-500 text-white py-3 px-8 rounded-full font-semibold transition" data-i18n="home.learn-more">
                了解更多
              </button>
<button class="bg-green-600 hover:bg-green-500 text-white py-3 px-8 rounded-full font-semibold transition" data-i18n="home.free-sample">
                免费样品
              </button>
</div>
</div>
<div class="w-1/3">
<img alt="Company building exterior view" class="rounded-xl shadow-md" id="1" src="lamipak_images/home_1.png"/>
</div>
</div>
</div>
<div class="bg-white rounded-2xl shadow-lg p-8">
<h2 class="text-2xl font-bold text-blue-800 mb-6" data-i18n="home.hot-products">热销产品</h2>
<div class="grid grid-cols-3 gap-8">
<!-- 产品卡片 -->
<div class="product-card bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden transition hover:shadow-lg">
<img alt="Cardboard box for packaging" class="w-full h-48 object-cover" id="2" src="lamipak_images/standard_1.png"/>
<div class="p-5">
<h3 class="text-lg font-semibold text-gray-800 mb-2">200S食品包装盒</h3>
<div class="flex justify-between mb-3">
<span class="text-gray-600">规格: 200S</span>
<span class="text-green-600 font-bold">¥45.80/箱</span>
</div>
<div class="flex justify-between">
<button class="text-blue-600 hover:text-blue-500 flex items-center">
<span class="iconify mr-1" data-icon="mdi:eye"></span> 详情
                </button>
<button class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm">
                  加入购物车
                </button>
</div>
</div>
</div>
<div class="product-card bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden transition hover:shadow-lg">
<img alt="Foam packaging material" class="w-full h-48 object-cover" id="3" src="lamipak_images/standard_2.png"/>
<div class="p-5">
<h3 class="text-lg font-semibold text-gray-800 mb-2">EPE泡沫包装</h3>
<div class="flex justify-between mb-3">
<span class="text-gray-600">规格: 50×30cm</span>
<span class="text-green-600 font-bold">¥28.50/卷</span>
</div>
<div class="flex justify-between">
<button class="text-blue-600 hover:text-blue-500 flex items-center">
<span class="iconify mr-1" data-icon="mdi:eye"></span> 详情
                </button>
<button class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm">
                  加入购物车
                </button>
</div>
</div>
</div>
<div class="product-card bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden transition hover:shadow-lg">
<img alt="Custom printed packaging tape" class="w-full h-48 object-cover" id="4" src="lamipak_images/standard_3.png"/>
<div class="p-5">
<h3 class="text-lg font-semibold text-gray-800 mb-2">定制胶带</h3>
<div class="flex justify-between mb-3">
<span class="text-gray-600">规格: 48mm×100m</span>
<span class="text-green-600 font-bold">¥15.20/卷</span>
</div>
<div class="flex justify-between">
<button class="text-blue-600 hover:text-blue-500 flex items-center">
<span class="iconify mr-1" data-icon="mdi:eye"></span> 详情
                </button>
<button class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm">
                  加入购物车
                </button>
</div>
</div>
</div>
</div>
</div>
</section>
<!-- 订单配置工具 -->
<section class="tab-content" id="configurator">
<div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
<div class="flex justify-between items-center mb-8">
<div class="flex space-x-2">
<button class="step-btn bg-blue-600 text-white px-4 py-2 rounded-lg" data-step="step1" data-i18n="config.step1">选择配置与设计</button>
<button class="step-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg" data-step="step2" data-i18n="config.step2">下单</button>
</div>
</div>
<!-- 步骤1: 选择配置与设计（合并后的步骤） -->
<div class="step step-active" id="step1">
<div class="flex justify-between items-center mb-6">
<h3 class="text-xl font-semibold text-gray-800" data-i18n="config.step1">选择配置与设计</h3>
<div class="flex items-center space-x-2">
<input id="filter-search" class="filter-input bg-white border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 w-64" type="text" placeholder="" data-i18n="config.search-placeholder"/>
<span class="iconify text-gray-400" data-icon="mdi:magnify"></span>
</div>
</div>
<div class="flex gap-6">
<!-- 左侧筛选条件区域（占1/3） -->
<div class="w-1/3 bg-gray-50 rounded-xl p-6 border border-gray-200">
<h4 class="text-lg font-semibold text-gray-800 mb-4" data-i18n="config.filter-title">筛选条件</h4>
<div class="space-y-4">
<div>
<label class="block text-gray-700 mb-2 font-medium" data-i18n="config.filter-format">规格选择 (Format)</label>
<select id="filter-format" class="filter-select w-full bg-white border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="config.filter-all-format">全部规格</option>
<option value="200S">200S 160C*4.2U-Straw</option>
<option value="LBA1000B">LBA1000B</option>
<option value="LBA100B-H">LBA100B-H</option>
<option value="1000B">1000B</option>
</select>
</div>
<div>
<label class="block text-gray-700 mb-2 font-medium" data-i18n="config.filter-machine">灌装机型号</label>
<select id="filter-machine" class="filter-select w-full bg-white border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="config.filter-all-machine">全部型号</option>
<option value="Tetra Pak A3">Tetra Pak A3</option>
<option value="SIG CFA122">SIG CFA122</option>
<option value="乐美 LP200">乐美 LP200</option>
</select>
</div>
<div>
<label class="block text-gray-700 mb-2 font-medium" data-i18n="config.filter-filling">填充物类型</label>
<select id="filter-filling" class="filter-select w-full bg-white border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="config.filter-all-filling">全部类型</option>
<option value="UHT牛奶">UHT牛奶</option>
<option value="果汁">果汁</option>
<option value="豆奶">豆奶</option>
<option value="乳制品">乳制品</option>
<option value="汤类">汤类</option>
</select>
</div>
<div>
<label class="block text-gray-700 mb-2 font-medium" data-i18n="config.filter-material">材料结构</label>
<select id="filter-material" class="filter-select w-full bg-white border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="config.filter-all-material">全部材料</option>
<option value="PE-Al-Paper">PE-Al-Paper</option>
<option value="PET-Paper">PET-Paper</option>
<option value="Paper">Paper</option>
<option value="PP">PP</option>
</select>
</div>
<div>
<label class="block text-gray-700 mb-2 font-medium" data-i18n="config.filter-product-group">产品组</label>
<select id="filter-product-group" class="filter-select w-full bg-white border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="config.filter-all-product-group">全部产品组</option>
<option value="10-无菌包">10-无菌包</option>
<option value="20-标准包">20-标准包</option>
<option value="30-定制包">30-定制包</option>
<option value="40-特殊包">40-特殊包</option>
</select>
</div>
<div>
<label class="block text-gray-700 mb-2 font-medium" data-i18n="config.filter-series">系列</label>
<select id="filter-series" class="filter-select w-full bg-white border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="config.filter-all-series">全部系列</option>
<option value="片材">片材</option>
<option value="卷材">卷材</option>
<option value="盖子">盖子</option>
</select>
</div>
<div>
<label class="block text-gray-700 mb-2 font-medium" data-i18n="config.filter-certification">认证要求</label>
<div class="space-y-2">
<label class="flex items-center">
<input id="filter-pefc" class="filter-checkbox rounded text-blue-600" type="checkbox"/>
<span class="ml-2">PEFC</span>
</label>
<label class="flex items-center">
<input id="filter-fsc" class="filter-checkbox rounded text-blue-600" type="checkbox"/>
<span class="ml-2">FSC</span>
</label>
</div>
</div>
</div>
</div>
<!-- 右侧产品展示区域（占2/3） -->
<div class="w-2/3">
<div id="products-container" class="space-y-6">
<!-- 产品将按规格分类显示在这里 -->
</div>
</div>
</div>
<div class="mt-8 flex justify-end">
<button class="next-step bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold" data-target="step2" data-i18n="config.next">
              下一步
            </button>
</div>
</div>
<!-- 步骤2: Order Placing -->
<div class="step" id="step2">
<h3 class="text-xl font-semibold text-gray-800 mb-6" data-i18n="config.order-placing">下单 (Order Placing)</h3>
<div class="flex mb-8 gap-8">
<div class="w-1/2">
<div class="bg-gray-100 rounded-xl p-4 mb-4 overflow-hidden">
<img alt="" class="w-full h-96 object-cover rounded-lg mb-3" id="mainProductImg" src="customer_designs/RFG/RFG-1.jpg" data-i18n-alt="config.product-main-image"/>
<div class="flex space-x-2 overflow-x-auto">
<img alt="" class="w-20 h-20 object-cover rounded cursor-pointer border-2 border-gray-300 hover:border-blue-600 transition" onclick="document.getElementById('mainProductImg').src=this.src" src="customer_designs/RFG/RFG-2.jpg" data-i18n-alt="config.detail-image"/>
<img alt="" class="w-20 h-20 object-cover rounded cursor-pointer border-2 border-gray-300 hover:border-blue-600 transition" onclick="document.getElementById('mainProductImg').src=this.src" src="customer_designs/RFG/RFG-3.jpg" data-i18n-alt="config.detail-image"/>
<img alt="" class="w-20 h-20 object-cover rounded cursor-pointer border-2 border-gray-300 hover:border-blue-600 transition" onclick="document.getElementById('mainProductImg').src=this.src" src="customer_designs/RFG/RFG-4.jpg" data-i18n-alt="config.detail-image"/>
<img alt="" class="w-20 h-20 object-cover rounded cursor-pointer border-2 border-gray-300 hover:border-blue-600 transition" onclick="document.getElementById('mainProductImg').src=this.src" src="customer_designs/RFG/RFG-5.jpg" data-i18n-alt="config.detail-image"/>
<img alt="" class="w-20 h-20 object-cover rounded cursor-pointer border-2 border-gray-300 hover:border-blue-600 transition" onclick="document.getElementById('mainProductImg').src=this.src" src="customer_designs/RFG/RFG-6.jpg" data-i18n-alt="config.detail-image"/>
</div>
</div>
</div>
<div class="w-1/2">
<div class="bg-gray-50 rounded-xl p-6 mb-6">
<h4 class="font-semibold text-lg text-gray-800 mb-4" data-i18n="config.product-info">产品信息</h4>
<div class="space-y-3">
<div class="flex justify-between">
<span class="text-gray-600" data-i18n="config.product-name">产品名称:</span>
<span class="font-medium" id="orderProductName">饮料包装设计 #DRK-2023</span>
</div>
<div class="flex justify-between">
<span class="text-gray-600" data-i18n="config.material-number">物料号:</span>
<span class="font-medium" id="orderMaterialNumber">NP-20345-1</span>
</div>
<div class="flex justify-between">
<span class="text-gray-600" data-i18n="config.format">规格:</span>
<span class="font-medium" id="orderFormat">200S</span>
</div>
<div class="flex justify-between">
<span class="text-gray-600" data-i18n="config.material">材料结构:</span>
<span class="font-medium" id="orderMaterial">PE-Al-Paper</span>
</div>
</div>
</div>
<div class="bg-gray-50 rounded-xl p-6">
<h4 class="font-semibold text-lg text-gray-800 mb-4" data-i18n="config.purchase-info">采购信息</h4>
<div class="space-y-4">
<div>
<label class="block text-gray-700 mb-2" data-i18n="config.quantity">数量</label>
<div class="flex items-center">
<button class="bg-gray-200 px-4 py-2 rounded-l-lg" onclick="decreaseQuantity()">-</button>
<input id="orderQuantity" class="w-20 text-center border-y border-gray-200 py-2" type="number" value="100" min="1"/>
<button class="bg-gray-200 px-4 py-2 rounded-r-lg" onclick="increaseQuantity()">+</button>
<span class="ml-4 text-gray-600" data-i18n="config.unit">(单位: 箱)</span>
</div>
</div>
<div>
<label class="block text-gray-700 mb-2" data-i18n="config.delivery-date">期望送达日期</label>
<input class="w-full bg-white border border-gray-300 rounded-lg px-4 py-2" type="date"/>
</div>
<div>
<label class="block text-gray-700 mb-2" data-i18n="config.special-requirements">特殊要求</label>
<textarea class="w-full bg-white border border-gray-300 rounded-lg px-4 py-2"></textarea>
</div>
</div>
</div>
</div>
</div>
<div class="mt-8 flex justify-between">
<button class="prev-step bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-3 rounded-lg font-semibold" data-target="step1" data-i18n="config.prev">
              上一步
            </button>
<div class="flex space-x-3">
<button class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold flex items-center" onclick="addToCart()">
              <span class="iconify mr-2" data-icon="mdi:cart"></span>
              <span data-i18n="config.add-to-cart">加入购物车</span>
            </button>
<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg font-semibold" onclick="confirmOrder()" data-i18n="config.confirm-order">
              确认下单
            </button>
</div>
</div>
</div>
</div>
</section>
<!-- 我的订单 -->
<section class="tab-content" id="orders">
<!-- 订单列表 -->
<div id="ordersList">
<div class="bg-white rounded-2xl shadow-lg p-8">
<div class="flex items-center justify-between mb-6">
<div class="flex">
<input class="bg-gray-50 border border-gray-300 rounded-l-lg px-4 py-2 w-64" placeholder="" type="text" data-i18n="orders.search-placeholder"/>
<button class="bg-blue-600 text-white px-6 py-2 rounded-r-lg">
<span class="iconify align-middle" data-icon="mdi:magnify"></span>
</button>
</div>
<div class="flex space-x-2">
<select class="bg-gray-50 border border-gray-300 rounded-lg px-4 py-2">
<option data-i18n="orders.all-status">全部状态</option>
<option data-i18n="orders.pending-review">待审核</option>
<option data-i18n="orders.pending-confirm">待客户确认</option>
<option data-i18n="orders.confirmed">已确认</option>
<option data-i18n="orders.completed">已完成</option>
</select>
<select class="bg-gray-50 border border-gray-300 rounded-lg px-4 py-2">
<option data-i18n="orders.last-30-days">最近30天</option>
<option data-i18n="orders.this-month">本月</option>
<option data-i18n="orders.last-month">上个月</option>
<option data-i18n="orders.year-2025">2025年</option>
</select>
</div>
</div>
<div class="bg-gray-50 rounded-lg overflow-hidden">
<div class="grid grid-cols-7 px-4 py-3 bg-gray-100 font-semibold text-gray-700">
<div data-i18n="orders.order-number">订单号</div>
<div data-i18n="orders.date">日期</div>
<div data-i18n="orders.product">产品</div>
<div data-i18n="orders.quantity">数量</div>
<div data-i18n="orders.amount">金额</div>
<div data-i18n="orders.status">状态</div>
<div data-i18n="orders.action">操作</div>
</div>
<!-- 订单行 -->
<div class="grid grid-cols-7 px-4 py-3 border-b border-gray-200 hover:bg-gray-100">
<div class="text-blue-600">ORD-20251118-001</div>
<div>2025-11-18</div>
<div>饮料包装盒</div>
<div>100箱</div>
<div>¥4,900.00</div>
<div><span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs" data-i18n="orders.pending-review">待审核</span></div>
<div>
<button class="view-order-btn text-blue-600 hover:text-blue-500 flex items-center text-sm" data-order-id="ORD-20251118-001">
<span class="iconify mr-1" data-icon="mdi:eye"></span><span data-i18n="orders.view">查看</span>
              </button>
</div>
</div>
<!-- 更多订单行 -->
<div class="grid grid-cols-7 px-4 py-3 border-b border-gray-200 hover:bg-gray-100">
<div class="text-blue-600">ORD-20251115-045</div>
<div>2025-11-15</div>
<div>EPE泡沫卷</div>
<div>50卷</div>
<div>¥1,425.00</div>
<div><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs" data-i18n="orders.completed">已完成</span></div>
<div>
<button class="view-order-btn text-blue-600 hover:text-blue-500 flex items-center text-sm" data-order-id="ORD-20251115-045">
<span class="iconify mr-1" data-icon="mdi:eye"></span><span data-i18n="orders.view">查看</span>
              </button>
</div>
</div>
</div>
<!-- 分页 -->
<div class="mt-6 flex justify-between items-center">
<div class="text-gray-600"><span data-i18n="orders.showing">显示</span> 1-2 <span data-i18n="orders.items">条</span>，<span data-i18n="orders.total">共</span> 24 <span data-i18n="orders.items">条</span></div>
<div class="flex space-x-2">
<button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg" data-i18n="orders.prev-page">上一页</button>
<button class="bg-blue-600 text-white px-4 py-2 rounded-lg">1</button>
<button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg">2</button>
<button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg" data-i18n="orders.next-page">下一页</button>
</div>
</div>
</div>
</div>
<!-- 订单详情 -->
<div id="orderDetail" class="hidden">
<div class="bg-white rounded-2xl shadow-lg p-8">
<!-- 面包屑导航 -->
<div class="mb-6">
<nav class="flex items-center space-x-2 text-sm">
<a href="#" id="breadcrumbOrders" class="text-blue-600 hover:text-blue-800" data-i18n="orders.title">我的订单</a>
<span class="text-gray-400">/</span>
<span class="text-gray-600" id="breadcrumbCurrent" data-i18n="order-detail.title">订单详情</span>
</nav>
</div>
<div class="flex items-center mb-6">
<button id="backToOrdersList" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg mr-4 flex items-center">
<span class="iconify mr-2" data-icon="mdi:arrow-left"></span><span data-i18n="order-detail.back">返回订单列表</span>
</button>
<h2 class="text-2xl font-bold text-blue-800" data-i18n="order-detail.title">订单详情</h2>
</div>
<!-- 订单详情内容 -->
<div id="orderDetailContent">
<!-- 订单状态流程 -->
<div class="mb-6 bg-gray-50 rounded-xl p-6">
<h3 class="text-lg font-semibold text-gray-800 mb-4" data-i18n="order-detail.status-flow">订单状态流程</h3>
<div class="flex items-center justify-between relative">
<div class="flex flex-col items-center flex-1 relative">
<div class="w-12 h-12 rounded-full bg-green-500 text-white flex items-center justify-center font-bold mb-2 z-10">1</div>
<div class="text-sm font-medium text-gray-800" data-i18n="order-detail.ordered">已下单</div>
<div class="text-xs text-gray-500 mt-1">2025-11-18 10:30</div>
<div class="absolute top-6 left-1/2 w-full h-0.5 bg-green-500 z-0"></div>
</div>
<div class="flex flex-col items-center flex-1 relative">
<div class="w-12 h-12 rounded-full bg-green-500 text-white flex items-center justify-center font-bold mb-2 z-10">2</div>
<div class="text-sm font-medium text-gray-800" data-i18n="order-detail.pending-review">待审核</div>
<div class="text-xs text-gray-500 mt-1" data-i18n="order-detail.current-status">当前状态</div>
<div class="absolute top-6 left-1/2 w-full h-0.5 bg-gray-300 z-0"></div>
</div>
<div class="flex flex-col items-center flex-1 relative">
<div class="w-12 h-12 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center font-bold mb-2 z-10">3</div>
<div class="text-sm font-medium text-gray-600" data-i18n="order-detail.pending-confirm">待客户确认</div>
<div class="absolute top-6 left-1/2 w-full h-0.5 bg-gray-300 z-0"></div>
</div>
<div class="flex flex-col items-center flex-1 relative">
<div class="w-12 h-12 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center font-bold mb-2 z-10">4</div>
<div class="text-sm font-medium text-gray-600" data-i18n="order-detail.confirmed">已确认</div>
<div class="absolute top-6 left-1/2 w-full h-0.5 bg-gray-300 z-0"></div>
</div>
<div class="flex flex-col items-center flex-1">
<div class="w-12 h-12 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center font-bold mb-2">5</div>
<div class="text-sm font-medium text-gray-600" data-i18n="order-detail.completed">已完成</div>
</div>
</div>
</div>
<!-- 操作按钮区域 -->
<div class="bg-blue-50 rounded-xl p-6 border border-blue-200 mb-6">
<h4 class="font-semibold text-lg text-blue-800 mb-4" data-i18n="order-detail.actions">订单操作</h4>
<div class="grid grid-cols-3 gap-4">
<button class="bg-green-600 hover:bg-green-500 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center">
<span class="iconify mr-2" data-icon="mdi:cart-plus"></span><span data-i18n="order-detail.repurchase">一键复购</span>
</button>
<button class="bg-blue-600 hover:bg-blue-500 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center">
<span class="iconify mr-2" data-icon="mdi:truck"></span><span data-i18n="order-detail.logistics">查看订单物流信息</span>
</button>
<button class="bg-yellow-600 hover:bg-yellow-500 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center">
<span class="iconify mr-2" data-icon="mdi:file-edit"></span><span data-i18n="order-detail.modify">发起修改申请</span>
</button>
<button id="openComplaintBtn" class="bg-red-600 hover:bg-red-500 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center">
<span class="iconify mr-2" data-icon="mdi:alert-circle"></span><span data-i18n="order-detail.complaint">发起客诉</span>
</button>
<button class="bg-purple-600 hover:bg-purple-500 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center">
<span class="iconify mr-2" data-icon="mdi:file-download"></span><span data-i18n="order-detail.export-order">导出订单信息</span>
</button>
<button class="bg-indigo-600 hover:bg-indigo-500 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center">
<span class="iconify mr-2" data-icon="mdi:receipt"></span><span data-i18n="order-detail.export-invoice">导出发票信息</span>
</button>
</div>
</div>
<!-- 订单基本信息 -->
<div class="bg-gray-50 rounded-xl p-6 mb-6">
<h4 class="font-semibold text-lg text-gray-800 mb-4" data-i18n="order-detail.basic-info">订单基本信息</h4>
<div class="grid grid-cols-4 gap-4">
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.order-number">订单号</label>
<div class="text-gray-800 font-medium" id="orderDetailNumber">ORD-20251118-001</div>
</div>
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.order-time">下单时间</label>
<div class="text-gray-800 font-medium">2025-11-18 10:30</div>
</div>
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.order-status">订单状态</label>
<div><span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs" data-i18n="orders.pending-review">待审核</span></div>
</div>
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.total-amount">订单总金额</label>
<div class="text-gray-800 font-medium text-green-600 text-lg">¥14,700.00</div>
</div>
</div>
<div class="mt-4 pt-4 border-t border-gray-200">
<div class="grid grid-cols-4 gap-4">
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.sku-count">SKU总数</label>
<div class="text-gray-800 font-medium">3</div>
</div>
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.total-quantity">总数量</label>
<div class="text-gray-800 font-medium">300 箱</div>
</div>
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.avg-price">平均单价</label>
<div class="text-gray-800 font-medium">¥49.00/箱</div>
</div>
<div>
<label class="block text-gray-600 mb-1 text-sm" data-i18n="order-detail.delivery-date">期望送达日期</label>
<div class="text-gray-800 font-medium">2025-12-18</div>
</div>
</div>
</div>
</div>
<!-- SKU列表 -->
<div class="mb-6">
<h4 class="font-semibold text-lg text-gray-800 mb-4" data-i18n="order-detail.product-list">订单商品列表</h4>
<div class="bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm">
<div class="overflow-x-auto">
<table class="w-full min-w-[800px]">
<thead>
<tr class="bg-gray-100 border-b border-gray-200">
<th class="px-4 py-3 text-left text-sm font-semibold text-gray-700" data-i18n="order-detail.sku-name">SKU名称</th>
<th class="px-4 py-3 text-left text-sm font-semibold text-gray-700" data-i18n="order-detail.material-number">物料号</th>
<th class="px-4 py-3 text-left text-sm font-semibold text-gray-700" data-i18n="order-detail.format">规格</th>
<th class="px-4 py-3 text-right text-sm font-semibold text-gray-700" data-i18n="orders.quantity">数量</th>
<th class="px-4 py-3 text-right text-sm font-semibold text-gray-700" data-i18n="order-detail.unit-price">单价</th>
<th class="px-4 py-3 text-right text-sm font-semibold text-gray-700" data-i18n="order-detail.subtotal">小计</th>
<th class="px-4 py-3 text-center text-sm font-semibold text-gray-700" data-i18n="orders.action">操作</th>
</tr>
</thead>
<tbody id="skuTableBody">
<!-- SKU行将通过JavaScript动态生成 -->
</tbody>
</table>
</div>
</div>
<!-- SKU详细信息展开区域 -->
<div id="skuDetailContainer" class="mt-4 space-y-4">
<!-- SKU详细信息将通过JavaScript动态生成，点击表格行展开 -->
</div>
</div>
</div>
</div>
</div>
<!-- 客诉页面 -->
<div id="complaintPage" class="hidden">
<div class="bg-white rounded-2xl shadow-lg p-8">
<!-- 面包屑导航 -->
<div class="mb-6">
<nav class="flex items-center space-x-2 text-sm">
<a href="#" id="breadcrumbOrders2" class="text-blue-600 hover:text-blue-800" data-i18n="orders.title">我的订单</a>
<span class="text-gray-400">/</span>
<a href="#" id="breadcrumbOrderDetail" class="text-blue-600 hover:text-blue-800" data-i18n="order-detail.title">订单详情</a>
<span class="text-gray-400">/</span>
<span class="text-gray-600" data-i18n="complaint.title">发起客诉</span>
</nav>
</div>
<h2 class="text-2xl font-bold text-blue-800 mb-6" data-i18n="complaint.title">发起客诉</h2>
<div class="max-w-3xl">
<div class="bg-gray-50 rounded-xl p-6 mb-6">
<h4 class="font-semibold text-lg text-gray-800 mb-4" data-i18n="complaint.order-info">订单信息</h4>
<div class="grid grid-cols-2 gap-4 text-sm">
<div>
<span class="text-gray-600" data-i18n="complaint.order-number">订单号:</span>
<span class="font-medium ml-2" id="complaintOrderNumber">ORD-20251118-001</span>
</div>
<div>
<span class="text-gray-600" data-i18n="complaint.product-name">产品名称:</span>
<span class="font-medium ml-2">饮料包装设计 #DRK-2023</span>
</div>
</div>
</div>
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="complaint.type">客诉类型</label>
<select class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3">
<option data-i18n="complaint.type-quality">产品质量问题</option>
<option data-i18n="complaint.type-logistics">物流配送问题</option>
<option data-i18n="complaint.type-service">服务态度问题</option>
<option data-i18n="complaint.type-invoice">发票问题</option>
<option data-i18n="complaint.type-other">其他问题</option>
</select>
</div>
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="complaint.content">客诉内容</label>
<textarea class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3" rows="8" placeholder="" data-i18n="complaint.content-placeholder"></textarea>
</div>
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="complaint.upload">上传凭证（可选）</label>
<input type="file" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-2" multiple accept="image/*"/>
<p class="text-gray-500 text-sm mt-2" data-i18n="complaint.upload-desc">支持上传多张图片，格式：JPG、PNG，单张不超过5MB</p>
</div>
<div class="flex justify-end space-x-3">
<button id="cancelComplaintBtn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-2 rounded-lg" data-i18n="complaint.cancel">取消</button>
<button class="bg-red-600 hover:bg-red-500 text-white px-6 py-2 rounded-lg" data-i18n="complaint.submit">提交客诉</button>
</div>
</div>
</div>
</div>
</section>
<!-- 财务信息 -->
<section class="tab-content" id="finance">
<div class="bg-white rounded-2xl shadow-lg p-8">
<!-- 财务概览 -->
<div class="grid grid-cols-4 gap-6 mb-8">
<div class="bg-blue-50 rounded-xl p-6 border border-blue-200">
<div class="text-gray-600 mb-1" data-i18n="finance.ordered-amount">已下单金额</div>
<div class="text-xs text-gray-500 mb-2" data-i18n="finance.this-year">本年度</div>
<div class="text-2xl font-bold text-blue-700">¥86,520.00</div>
</div>
<div class="bg-green-50 rounded-xl p-6 border border-green-200">
<div class="text-gray-600 mb-1" data-i18n="finance.rebate-amount">已返利金额</div>
<div class="text-xs text-gray-500 mb-2" data-i18n="finance.this-year">本年度</div>
<div class="text-2xl font-bold text-green-700">¥3,450.00</div>
</div>
<div class="bg-yellow-50 rounded-xl p-6 border border-yellow-200">
<div class="text-gray-600 mb-1" data-i18n="finance.due-soon">即将到期的付款</div>
<div class="text-xs text-gray-500 mb-2" data-i18n="finance.days">30天内到期</div>
<div class="text-2xl font-bold text-yellow-700">¥12,500.00</div>
</div>
<div class="bg-red-50 rounded-xl p-6 border border-red-200">
<div class="text-gray-600 mb-1" data-i18n="finance.overdue">已经到期的付款</div>
<div class="text-xs text-gray-500 mb-2" data-i18n="finance.overdue-desc">已逾期</div>
<div class="text-2xl font-bold text-red-700">¥8,200.00</div>
</div>
</div>
<!-- 财务明细 -->
<div class="bg-gray-50 rounded-lg p-6">
  <div class="flex items-center justify-between">
    <h3 class="font-semibold text-lg text-gray-800 mb-0" data-i18n="finance.details">财务明细</h3>
    <button class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg" data-i18n="finance.export">
      导出报表
    </button>
  </div>
<div class="overflow-x-auto">
<table class="w-full">
<thead>
<tr class="bg-gray-100">
<th class="px-4 py-2 text-left" data-i18n="finance.invoice-number">发票编号</th>
<th class="px-4 py-2 text-left" data-i18n="finance.invoice-time">发票时间</th>
<th class="px-4 py-2 text-right" data-i18n="finance.invoice-amount">发票金额</th>
<th class="px-4 py-2 text-right" data-i18n="finance.paid-amount">发票已付金额</th>
<th class="px-4 py-2 text-right" data-i18n="finance.unpaid-amount">发票未付金额 (Outstanding)</th>
<th class="px-4 py-2 text-left" data-i18n="finance.due-date">Due Date</th>
</tr>
</thead>
<tbody>
<tr class="border-b border-gray-200">
<td class="px-4 py-3 text-blue-600">INV-20251118-001</td>
<td class="px-4 py-3">2025-11-18</td>
<td class="px-4 py-3 text-right">¥4,900.00</td>
<td class="px-4 py-3 text-right text-green-600">¥4,900.00</td>
<td class="px-4 py-3 text-right">¥0.00</td>
<td class="px-4 py-3">2025-12-18</td>
</tr>
<tr class="border-b border-gray-200">
<td class="px-4 py-3 text-blue-600">INV-20251028-012</td>
<td class="px-4 py-3">2025-10-28</td>
<td class="px-4 py-3 text-right">¥12,500.00</td>
<td class="px-4 py-3 text-right text-green-600">¥12,500.00</td>
<td class="px-4 py-3 text-right">¥0.00</td>
<td class="px-4 py-3">2025-11-28</td>
</tr>
<tr class="border-b border-gray-200">
<td class="px-4 py-3 text-blue-600">INV-20251015-028</td>
<td class="px-4 py-3">2025-10-15</td>
<td class="px-4 py-3 text-right">¥8,200.00</td>
<td class="px-4 py-3 text-right">¥0.00</td>
<td class="px-4 py-3 text-right text-red-600">¥8,200.00</td>
<td class="px-4 py-3 text-red-600">2025-11-05</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<!-- 画稿管理（新） -->
<section class="tab-content" id="design-management-new">
<!-- 阶段概览视图 -->
<div id="design-new-stage-overview" class="design-new-view bg-white rounded-2xl shadow-lg p-8">
<div class="mb-8">
<h3 class="text-lg font-semibold text-gray-800 mb-4" data-i18n="design-new.upload-new">上传新画稿</h3>
<div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
<!-- 阶段1：上传文件 -->
<div class="stage-card group cursor-pointer border-2 border-blue-200 bg-blue-50 rounded-xl p-4 hover:border-blue-400 hover:shadow-md transition" data-stage="1">
<div class="flex items-center justify-between mb-2">
<span class="text-xs font-semibold text-blue-700 bg-blue-200 px-2 py-1 rounded" data-i18n="design-new.stage1">阶段 1</span>
<span class="iconify text-blue-600 text-xl" data-icon="mdi:upload"></span>
</div>
<h4 class="font-medium text-gray-800 mb-1" data-i18n="design-new.stage1-title">上传文件</h4>
<p class="text-xs text-gray-600" data-i18n="design-new.stage1-desc">上传预览文件和原文件</p>
</div>

<!-- 阶段2：AI解析和乐美人工复核 -->
<div class="stage-card group cursor-pointer border-2 border-gray-200 bg-gray-50 rounded-xl p-4 hover:border-gray-300 hover:shadow-md transition opacity-60" data-stage="2">
<div class="flex items-center justify-between mb-2">
<span class="text-xs font-semibold text-gray-600 bg-gray-200 px-2 py-1 rounded" data-i18n="design-new.stage2">阶段 2</span>
<span class="iconify text-gray-500 text-xl" data-icon="mdi:robot"></span>
</div>
<h4 class="font-medium text-gray-700 mb-1" data-i18n="design-new.stage2-title">AI解析和复核</h4>
<p class="text-xs text-gray-500" data-i18n="design-new.stage2-desc">AI解析 + 乐美人工复核</p>
</div>

<!-- 阶段3：画稿沟通和评论 -->
<div class="stage-card group cursor-pointer border-2 border-gray-200 bg-gray-50 rounded-xl p-4 hover:border-gray-300 hover:shadow-md transition opacity-60" data-stage="3">
<div class="flex items-center justify-between mb-2">
<span class="text-xs font-semibold text-gray-600 bg-gray-200 px-2 py-1 rounded" data-i18n="design-new.stage3">阶段 3</span>
<span class="iconify text-gray-500 text-xl" data-icon="mdi:comment-text"></span>
</div>
<h4 class="font-medium text-gray-700 mb-1" data-i18n="design-new.stage3-title">沟通和评论</h4>
<p class="text-xs text-gray-500" data-i18n="design-new.stage3-desc">画稿沟通和评论</p>
</div>

<!-- 阶段4：画稿制作 -->
<div class="stage-card group cursor-pointer border-2 border-gray-200 bg-gray-50 rounded-xl p-4 hover:border-gray-300 hover:shadow-md transition opacity-60" data-stage="4">
<div class="flex items-center justify-between mb-2">
<span class="text-xs font-semibold text-gray-600 bg-gray-200 px-2 py-1 rounded" data-i18n="design-new.stage4">阶段 4</span>
<span class="iconify text-gray-500 text-xl" data-icon="mdi:factory"></span>
</div>
<h4 class="font-medium text-gray-700 mb-1" data-i18n="design-new.stage4-title">画稿制作</h4>
<p class="text-xs text-gray-500" data-i18n="design-new.stage4-desc">进入制作流程</p>
</div>
</div>
</div>

<!-- 查看现有画稿入口 -->
<div class="mt-8 pt-8 border-t border-gray-200">
<h3 class="text-lg font-semibold text-gray-800 mb-4" data-i18n="design-new.artwork-management">画稿管理</h3>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
<div class="view-artworks-card group cursor-pointer border-2 border-purple-200 bg-purple-50 rounded-xl p-4 hover:border-purple-400 hover:shadow-md transition" data-view="artworks-list">
<div class="flex items-center justify-between mb-2">
<span class="text-xs font-semibold text-purple-700 bg-purple-200 px-2 py-1 rounded" data-i18n="design-new.artwork-library">画稿库</span>
<span class="iconify text-purple-600 text-xl" data-icon="mdi:view-list"></span>
</div>
<h4 class="font-medium text-gray-800 mb-1" data-i18n="design-new.view-existing">查看现有画稿</h4>
<p class="text-xs text-gray-600" data-i18n="design-new.view-all-records">查看所有画稿记录</p>
</div>
</div>
</div>
</div>

<!-- 阶段1：上传文件 -->
<div id="design-new-stage-1" class="design-new-view hidden bg-white rounded-2xl shadow-lg p-8">
<div class="flex items-center mb-6">
<button type="button" class="back-to-overview-btn flex items-center text-blue-600 hover:text-blue-800 font-medium mr-4 group">
<span class="iconify text-xl mr-2 group-hover:-translate-x-0.5 transition-transform" data-icon="mdi:arrow-left"></span>
<span data-i18n="design-new.back">返回</span>
</button>
<span class="text-gray-400">|</span>
<h3 class="ml-4 text-xl font-semibold text-gray-800" data-i18n="design-new.stage1-heading">阶段 1：上传文件</h3>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
<!-- 预览文件上传 -->
<div class="border-2 border-dashed border-gray-300 rounded-xl p-8 flex flex-col items-center justify-center bg-gray-50 hover:bg-gray-100 transition cursor-pointer" id="preview-upload-new">
<span class="iconify text-4xl text-blue-700 mb-4" data-icon="mdi:image"></span>
<h3 class="text-lg font-medium mb-2" data-i18n="design-new.upload-preview">上传预览文件</h3>
<p class="text-gray-600 text-center mb-4" data-i18n="design-new.upload-preview-desc">支持 JPG/PNG/PDF 格式<br/>用于AI解析和预览</p>
<input accept=".jpg,.jpeg,.png,.pdf" class="hidden" id="preview-file-input-new" type="file"/>
<button type="button" class="bg-blue-700 hover:bg-blue-800 text-white px-6 py-2 rounded-lg transition" data-i18n="design-new.select-file">选择文件</button>
<div class="mt-4 w-full hidden" id="preview-container-new">
<img class="w-full h-32 object-contain rounded-lg border border-gray-200" id="preview-image-new"/>
<div class="mt-2 text-sm text-gray-600 flex items-center justify-between">
<span id="preview-filename-new">filename.jpg</span>
<span id="preview-size-new">2.5MB</span>
</div>
</div>
</div>

<!-- 原文件上传 -->
<div class="border-2 border-dashed border-gray-300 rounded-xl p-8 flex flex-col items-center justify-center bg-gray-50 hover:bg-gray-100 transition cursor-pointer" id="original-upload-new">
<span class="iconify text-4xl text-orange-500 mb-4" data-icon="mdi:file"></span>
<h3 class="text-lg font-medium mb-2" data-i18n="design-new.upload-original">上传原文件</h3>
<p class="text-gray-600 text-center mb-4" data-i18n="design-new.upload-original-desc">原始设计文件 (最大600MB)<br/>用于后续制作处理</p>
<input accept=".ai,.psd,.cdr" class="hidden" id="original-file-input-new" multiple="" type="file"/>
<button type="button" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg transition" data-i18n="design-new.select-file">选择文件</button>
<div class="mt-4 w-full hidden" id="original-info-container-new">
<div class="space-y-2 mb-4" id="original-files-list-new"></div>
<div class="text-xs text-gray-600">
<div class="flex justify-between">
<span data-i18n="design-new.total-files">总文件数:</span>
<span id="original-file-count-new">0</span>
</div>
<div class="flex justify-between">
<span data-i18n="design-new.total-size">总大小:</span>
<span id="original-total-size-new">0 Bytes</span>
</div>
</div>
</div>
</div>
</div>

<!-- 文件链接输入 -->
<div class="mb-8">
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.file-link">或输入文件链接</label>
<input type="url" id="file-link-input" data-i18n="design-new.file-link-placeholder" placeholder="例如：https://example.com/files/design.pdf" class="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:ring-1 focus:ring-blue-200" />
<p class="mt-2 text-sm text-gray-500" data-i18n="design-new.file-link-desc">支持通过链接方式提交文件</p>
</div>

<div class="flex justify-end gap-3 pt-4 border-t border-gray-200">
<button type="button" class="back-to-overview-btn px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition" data-i18n="design-new.cancel">取消</button>
<button type="button" id="stage1-next-btn" class="px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition flex items-center">
<span class="iconify mr-2" data-icon="mdi:arrow-right"></span>
<span data-i18n="design-new.next">下一步</span>
</button>
</div>
</div>

<!-- 阶段2：AI解析和乐美人工复核 -->
<div id="design-new-stage-2" class="design-new-view hidden bg-white rounded-2xl shadow-lg p-8">
<div class="flex items-center mb-6">
<button type="button" class="back-to-overview-btn flex items-center text-blue-600 hover:text-blue-800 font-medium mr-4 group">
<span class="iconify text-xl mr-2 group-hover:-translate-x-0.5 transition-transform" data-icon="mdi:arrow-left"></span>
<span data-i18n="design-new.back">返回</span>
</button>
<span class="text-gray-400">|</span>
<h3 class="ml-4 text-xl font-semibold text-gray-800" data-i18n="design-new.stage2-heading">阶段 2：AI解析和乐美人工复核</h3>
</div>
<div class="bg-blue-50 border border-blue-200 rounded-xl p-8 text-center">
<span class="iconify text-6xl text-blue-500 mb-4 inline-block" data-icon="mdi:clock-outline"></span>
<h4 class="text-xl font-semibold text-blue-800 mb-2" data-i18n="design-new.files-received">文件已收到</h4>
<p class="text-blue-700 mb-4" data-i18n="design-new.processing">乐美已收到您提交的文件，正在处理中...</p>
<div class="bg-white rounded-lg p-4 inline-block">
<p class="text-sm text-gray-600 mb-1" data-i18n="design-new.estimated-time">预计处理时间</p>
<p class="text-lg font-semibold text-gray-800" data-i18n="design-new.working-day">1 个工作日</p>
</div>
<p class="text-sm text-blue-600 mt-4" data-i18n="design-new.notification">处理完成后，我们将通知您进入下一阶段</p>
</div>
<div class="flex justify-end gap-3 pt-6 mt-6 border-t border-gray-200">
<button type="button" class="back-to-overview-btn px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition" data-i18n="design-new.cancel">取消</button>
<button type="button" id="stage2-next-btn" class="px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition flex items-center">
<span class="iconify mr-2" data-icon="mdi:arrow-right"></span>
<span data-i18n="design-new.next">下一步</span>
</button>
</div>
</div>

<!-- 阶段3：画稿沟通和评论 -->
<div id="design-new-stage-3" class="design-new-view hidden bg-white rounded-2xl shadow-lg p-8">
<div class="flex items-center mb-6">
<button type="button" class="back-to-overview-btn flex items-center text-blue-600 hover:text-blue-800 font-medium mr-4 group">
<span class="iconify text-xl mr-2 group-hover:-translate-x-0.5 transition-transform" data-icon="mdi:arrow-left"></span>
<span data-i18n="design-new.back">返回</span>
</button>
<span class="text-gray-400">|</span>
<h3 class="ml-4 text-xl font-semibold text-gray-800" data-i18n="design-new.stage3-heading">阶段 3：画稿沟通和评论</h3>
</div>

<!-- AI解析完成提示 -->
<div class="bg-green-50 border border-green-200 rounded-xl p-4 mb-6">
<div class="flex items-start">
<span class="iconify text-green-600 text-xl mt-0.5 mr-3" data-icon="mdi:check-circle"></span>
<div>
<p class="font-medium text-green-800 mb-1" data-i18n="design-new.ai-completed">AI解析和乐美复核已完成</p>
<p class="text-sm text-green-700" data-i18n="design-new.confirm-info">请确认以下信息，如有需要可进行修改</p>
</div>
</div>
</div>

<!-- 画稿信息表单 -->
<form id="stage3-confirm-form" class="mb-6 space-y-6">
<!-- 乐美工作人员确定的信息 -->
<div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
<h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
<span class="iconify mr-2 text-blue-600" data-icon="mdi:shield-check"></span>
<span data-i18n="design-new.lamipak-determined">乐美工作人员确定</span>
</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<!-- Paperboard -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.paperboard">Paperboard</label>
<div id="stage3-paperboard-display" class="flex items-center h-10 px-4 bg-white border border-blue-200 rounded-lg text-gray-700 font-medium">
<span class="iconify mr-2 text-blue-500" data-icon="mdi:lock"></span>
<span>CB-Coated</span>
</div>
<input type="hidden" id="stage3-paperboard" name="paperboard" value="CB-Coated" />
</div>

<!-- Print Plant -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.print-plant">Print Plant</label>
<div id="stage3-printPlant-display" class="flex items-center h-10 px-4 bg-white border border-blue-200 rounded-lg text-gray-700 font-medium">
<span class="iconify mr-2 text-blue-500" data-icon="mdi:lock"></span>
<span data-i18n="design-new.plant-kunshan">昆山工厂</span>
</div>
<input type="hidden" id="stage3-printPlant" name="printPlant" value="昆山工厂" />
</div>
</div>
</div>

<!-- 客户确认和修改的信息 -->
<div class="bg-white border border-gray-200 rounded-xl p-6">
<h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
<span class="iconify mr-2 text-green-600" data-icon="mdi:pencil"></span>
<span data-i18n="design-new.customer-confirm">客户确认和修改</span>
</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<!-- Design Code -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.design-code">Design Code</label>
<div id="stage3-designCode" class="flex items-center h-10 px-4 bg-gray-50 border border-gray-200 rounded-lg text-gray-500 text-sm">
<span class="iconify mr-2 text-blue-500" data-icon="mdi:information-outline"></span>
<span>DC-20250209-ABC123</span>
</div>
</div>

<!-- Artwork type -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.artwork-type">Artwork type</label>
<select id="stage3-artworkType" name="artworkType" class="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 bg-white">
<option value="New" selected data-i18n="design-new.artwork-type-new">New - the SKU never printed by Lamipak before</option>
<option value="Existing" data-i18n="design-new.artwork-type-existing">Existing - the SKU has been printed by Lamipak</option>
</select>
</div>

<!-- Color target -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.color-target">Color target</label>
<select id="stage3-colorTarget" name="colorTarget" class="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 bg-white">
<option value="No" data-i18n="design-new.color-target-no">No</option>
<option value="According to the digital artwork" selected data-i18n="design-new.color-target-digital">According to the digital artwork</option>
</select>
</div>

<!-- Product title -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.product-title">Product title</label>
<input id="stage3-productTitle" name="productTitle" type="text" value="GUAVA TETRA FINAL 200ml" class="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:ring-1 focus:ring-blue-200" />
</div>

<!-- Format -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.format">Format</label>
<select id="stage3-format" name="format" class="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 bg-white">
<option value="LRBA200S" selected>LRBA200S</option>
<option value="LRBA1000B">LRBA1000B</option>
</select>
</div>

<!-- Opening -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.opening">Opening</label>
<select id="stage3-opening" name="opening" class="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 bg-white">
<option value="With Strawhole" selected data-i18n="design-new.opening-strawhole">With Strawhole</option>
<option value="Without strawhole" data-i18n="design-new.opening-no-strawhole">Without strawhole</option>
<option value="With screw cap" data-i18n="design-new.opening-screw-cap">With screw cap</option>
<option value="With spout" data-i18n="design-new.opening-spout">With spout</option>
</select>
</div>

<!-- 纸张类型 logo -->
<div>
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.logo-type">纸张类型 logo</label>
<select id="stage3-logo" name="logo" class="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 bg-white">
<option value="No FSC/PEFC logo" data-i18n="design-new.logo-none">No FSC/PEFC logo</option>
<option value="FSC logo" selected data-i18n="design-new.logo-fsc">FSC logo</option>
<option value="PEFC logo" data-i18n="design-new.logo-pefc">PEFC logo</option>
</select>
</div>

<!-- Multiple Styles -->
<div class="md:col-span-2">
<label class="block text-gray-700 font-medium mb-2" data-i18n="design-new.multiple-styles">Multiple Styles</label>
<div class="flex items-center gap-4">
<label class="inline-flex items-center cursor-pointer">
<input type="radio" name="stage3-multipleStyles" value="是" class="text-blue-600 h-4 w-4" />
<span class="ml-2" data-i18n="design-new.yes">是</span>
</label>
<label class="inline-flex items-center cursor-pointer">
<input type="radio" name="stage3-multipleStyles" value="否" class="text-blue-600 h-4 w-4" checked />
<span class="ml-2" data-i18n="design-new.no">否</span>
</label>
</div>
</div>
</div>
</div>
</form>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
<!-- 左侧：画稿图片 -->
<div class="bg-white border border-gray-200 rounded-xl p-6">
<h4 class="text-lg font-semibold text-gray-800 mb-4" data-i18n="design-new.artwork-preview">画稿预览</h4>
<div class="bg-gray-50 rounded-lg border border-gray-200 p-4 flex items-center justify-center min-h-[500px]">
<img id="stage3-artwork-image" src="" alt="画稿设计" class="max-w-full max-h-[500px] object-contain rounded-lg shadow-sm" />
</div>
</div>

<!-- 右侧：评论区域 -->
<div class="bg-white border border-gray-200 rounded-xl flex flex-col" style="height: 600px;">
<div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
<h4 class="text-lg font-semibold text-gray-800" data-i18n="design-new.comments">评论</h4>
<span id="stage3-comment-count" class="text-sm text-gray-500" data-i18n="design-new.comment-count-zero">0 条评论</span>
</div>

<!-- 评论列表 -->
<div id="stage3-comments-list" class="flex-1 overflow-y-auto p-4 space-y-4 min-h-0">
<!-- 评论由 JS 动态渲染 -->
</div>

<!-- 评论输入区 -->
<div class="px-4 py-4 border-t border-gray-200 bg-gray-50">
<div class="flex items-start gap-3">
<div class="flex-1">
<textarea id="stage3-comment-input" rows="2" data-i18n="design-new.comment-placeholder" placeholder="输入您的评论..." class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-200 resize-none"></textarea>
</div>
<button type="button" id="stage3-send-comment-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition flex items-center flex-shrink-0">
<span class="iconify mr-1" data-icon="mdi:send"></span>
<span data-i18n="design-new.send">发送</span>
</button>
</div>
</div>
</div>
</div>
<!-- 确认版本按钮和下一步 -->
<div class="mt-6 pt-6 border-t border-gray-200">
<div class="bg-green-50 border border-green-200 rounded-xl p-6 mb-4">
<div class="flex items-center justify-between">
<div class="flex-1">
<h4 class="text-lg font-semibold text-green-800 mb-2" data-i18n="design-new.confirm-version">确认画稿版本</h4>
<p class="text-sm text-green-700" data-i18n="design-new.confirm-version-desc">确认当前画稿版本后，将进入制作流程</p>
</div>
<button type="button" id="stage3-confirm-version-btn" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-semibold transition flex items-center shadow-md hover:shadow-lg">
<span class="iconify mr-2 text-lg" data-icon="mdi:check-circle"></span>
<span data-i18n="design-new.tag-confirmed">Tag as Confirmed Version</span>
</button>
</div>
</div>
<div class="flex justify-end gap-3">
<button type="button" class="back-to-overview-btn px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition" data-i18n="design-new.cancel">取消</button>
<button type="button" id="stage3-next-btn" class="px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition flex items-center">
<span class="iconify mr-2" data-icon="mdi:arrow-right"></span>
<span data-i18n="design-new.next">下一步</span>
</button>
</div>
</div>
</div>
<div id="design-new-stage-4" class="design-new-view hidden bg-white rounded-2xl shadow-lg p-8">
<div class="flex items-center mb-6">
<button type="button" class="back-to-overview-btn flex items-center text-blue-600 hover:text-blue-800 font-medium mr-4 group">
<span class="iconify text-xl mr-2 group-hover:-translate-x-0.5 transition-transform" data-icon="mdi:arrow-left"></span>
<span data-i18n="design-new.back">返回</span>
</button>
<span class="text-gray-400">|</span>
<h3 class="ml-4 text-xl font-semibold text-gray-800" data-i18n="design-new.stage4-heading">阶段 4：画稿制作</h3>
</div>
<!-- 制作状态 -->
<div class="bg-green-50 border border-green-200 rounded-xl p-8 mb-6">
<div class="text-center mb-6">
<span class="iconify text-6xl text-green-500 mb-4 inline-block" data-icon="mdi:check-circle"></span>
<h4 class="text-xl font-semibold text-green-800 mb-2" data-i18n="design-new.artwork-confirmed">画稿已确认</h4>
<p class="text-green-700 mb-6" data-i18n="design-new.production-started">画稿版本已确认，已进入制作流程</p>
</div>
<div class="bg-white rounded-lg p-6 max-w-md mx-auto">
<div class="flex items-center justify-between mb-4">
<span class="text-gray-600" data-i18n="design-new.production-status">制作状态</span>
<span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium" data-i18n="design-new.in-production">制作中</span>
</div>
<div class="text-left space-y-2 text-sm text-gray-600">
<div class="flex items-center">
<span class="iconify text-green-500 mr-2" data-icon="mdi:check-circle"></span>
<span data-i18n="design-new.files-received-status">文件已接收</span>
</div>
<div class="flex items-center">
<span class="iconify text-green-500 mr-2" data-icon="mdi:check-circle"></span>
<span data-i18n="design-new.ai-completed-status">AI解析完成</span>
</div>
<div class="flex items-center">
<span class="iconify text-green-500 mr-2" data-icon="mdi:check-circle"></span>
<span data-i18n="design-new.customer-confirmed-status">客户已确认</span>
</div>
<div class="flex items-center">
<span class="iconify text-blue-500 mr-2" data-icon="mdi:clock-outline"></span>
<span data-i18n="design-new.production-in-progress">制作进行中...</span>
</div>
</div>
</div>
</div>

<!-- 样品寄送 -->
<div class="bg-white border border-gray-200 rounded-xl p-6 mb-6">
<div class="flex items-center justify-between mb-6">
<div class="flex items-center">
<span class="iconify text-2xl text-blue-600 mr-3" data-icon="mdi:package-variant"></span>
<div>
<h4 class="text-lg font-semibold text-gray-800" data-i18n="design-new.sample-shipping">样品寄送</h4>
<p class="text-sm text-gray-500" data-i18n="design-new.sample-shipping-desc">选择是否需要寄送样品</p>
</div>
</div>
<label class="relative inline-flex items-center cursor-pointer">
<input type="checkbox" id="stage4-sample-shipping-toggle" class="sr-only peer">
<div class="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-600"></div>
</label>
</div>

<!-- 收件信息（当选择寄送时显示） -->
<div id="stage4-shipping-info" class="hidden border-t border-gray-200 pt-6 mt-6">
<h5 class="text-md font-semibold text-gray-800 mb-4 flex items-center">
<span class="iconify text-xl text-blue-600 mr-2" data-icon="mdi:map-marker"></span>
<span data-i18n="design-new.recipient-info">收件信息</span>
</h5>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<!-- 收件人 -->
<div>
<label for="stage4-recipient-name" class="block text-sm font-medium text-gray-700 mb-2">
<span data-i18n="design-new.recipient-name">收件人</span> <span class="text-red-500">*</span>
</label>
<input type="text" id="stage4-recipient-name" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100" data-i18n="design-new.recipient-name-placeholder" placeholder="请输入收件人姓名">
</div>
<!-- 收件地址 -->
<div class="md:col-span-2">
<label for="stage4-recipient-address" class="block text-sm font-medium text-gray-700 mb-2">
<span data-i18n="design-new.recipient-address">收件地址</span> <span class="text-red-500">*</span>
</label>
<textarea id="stage4-recipient-address" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 resize-none" data-i18n="design-new.recipient-address-placeholder" placeholder="请输入详细收件地址"></textarea>
</div>
</div>
<div class="mt-6 flex justify-end">
<button type="button" id="stage4-save-shipping-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition flex items-center shadow-md hover:shadow-lg">
<span class="iconify mr-2" data-icon="mdi:content-save"></span>
<span data-i18n="design-new.save-recipient-info">保存收件信息</span>
</button>
</div>
</div>
</div>
</div>
</div>

<!-- 查看现有画稿列表视图 -->
<div id="design-new-artworks-list" class="design-new-view hidden bg-white rounded-2xl shadow-lg p-8">
<div class="flex items-center mb-6">
<button type="button" class="back-to-overview-btn flex items-center text-blue-600 hover:text-blue-800 font-medium mr-4 group">
<span class="iconify text-xl mr-2 group-hover:-translate-x-0.5 transition-transform" data-icon="mdi:arrow-left"></span>
<span data-i18n="design-new.back">返回</span>
</button>
<span class="text-gray-400">|</span>
<h3 class="ml-4 text-xl font-semibold text-gray-800" data-i18n="design-new.view-artworks">查看现有画稿</h3>
</div>

<!-- 搜索栏 -->
<div class="bg-white border border-gray-200 rounded-xl p-6 mb-6">
<div class="grid grid-cols-1 md:grid-cols-4 gap-4">
<div>
<label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="design-new.search-format">规格</label>
<input type="text" id="artworks-search-format" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100" data-i18n="design-new.search-format-placeholder" placeholder="搜索规格...">
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="design-new.search-plant">工厂</label>
<select id="artworks-search-plant" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="design-new.all">全部</option>
<option value="昆山工厂" data-i18n="design-new.plant-kunshan">昆山工厂</option>
<option value="印尼工厂" data-i18n="design-new.plant-indonesia">印尼工厂</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="design-new.search-paperboard">纸张类型</label>
<select id="artworks-search-paperboard" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="design-new.all">全部</option>
<option value="CB-Coated">CB-Coated</option>
<option value="CTB-Coated">CTB-Coated</option>
<option value="CCB-Coated">CCB-Coated</option>
<option value="FBB">FBB</option>
<option value="GC1">GC1</option>
<option value="GC2">GC2</option>
<option value="PE-Coated Board">PE-Coated Board</option>
<option value="Uncoated Kraft">Uncoated Kraft</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="design-new.search-status">状态</label>
<select id="artworks-search-status" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-100">
<option value="" data-i18n="design-new.all">全部</option>
<option value="制作中" data-i18n="design-new.status-in-production">制作中</option>
<option value="已完成" data-i18n="design-new.status-completed">已完成</option>
<option value="待确认" data-i18n="design-new.status-pending">待确认</option>
<option value="已确认" data-i18n="design-new.status-confirmed">已确认</option>
</select>
</div>
</div>
<div class="mt-4 flex justify-end">
<button type="button" id="artworks-search-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition flex items-center">
<span class="iconify mr-2" data-icon="mdi:magnify"></span>
<span data-i18n="design-new.search">搜索</span>
</button>
<button type="button" id="artworks-reset-btn" class="ml-3 bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-lg font-medium transition" data-i18n="design-new.reset">重置</button>
</div>
</div>

<!-- 画稿列表表格 -->
<div class="bg-white border border-gray-200 rounded-xl overflow-hidden">
<div class="overflow-x-auto">
<table class="w-full">
<thead class="bg-gray-50 border-b border-gray-200">
<tr>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider" data-i18n="design-new.design-code-col">Design Code</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider" data-i18n="design-new.format-col">规格</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider" data-i18n="design-new.plant-col">工厂</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider" data-i18n="design-new.paperboard-col">纸张类型</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider" data-i18n="design-new.status-col">状态</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider" data-i18n="design-new.action-col">操作</th>
</tr>
</thead>
<tbody id="artworks-list-tbody" class="bg-white divide-y divide-gray-200">
<!-- 列表内容由 JavaScript 动态生成 -->
</tbody>
</table>
</div>
<div id="artworks-empty-state" class="hidden p-12 text-center">
<span class="iconify text-6xl text-gray-300 mb-4 inline-block" data-icon="mdi:file-document-outline"></span>
<p class="text-gray-500 text-lg" data-i18n="design-new.no-artworks">暂无画稿记录</p>
</div>
</div>
</div>

</section>

<!-- 查看画稿设计图片 - 弹窗 -->
<div id="designImagesModal" class="fixed inset-0 z-[60] flex items-center justify-center bg-black/50 hidden">
<div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col">
<div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gray-50">
<h3 id="designImagesModalTitle" class="text-lg font-semibold text-gray-800">画稿设计图片</h3>
<button id="closeDesignImagesModalBtn" type="button" class="text-gray-500 hover:text-gray-700 p-1 rounded hover:bg-gray-200 transition">
<span class="iconify text-xl" data-icon="mdi:close"></span>
</button>
</div>
<div id="designImagesModalBody" class="flex-1 overflow-y-auto p-6">
<!-- 设计版本与图片轮播，由 JS 渲染 -->
</div>
</div>
</div>
</div>
<!-- 联系我们 -->
<section class="tab-content" id="contact">
<div class="bg-white rounded-2xl shadow-lg p-8">
<div class="grid grid-cols-2 gap-8">
<div>
<div class="mb-6">
<h3 class="text-xl font-semibold text-gray-800 mb-4" data-i18n="contact.company-info">公司信息</h3>
<div class="space-y-3">
<div class="flex items-start">
<span class="iconify text-blue-600 mt-1 mr-3" data-icon="mdi:office-building"></span>
<div>
<div class="font-medium" data-i18n="contact.company-name">乐美包装材料有限公司</div>
<div class="text-gray-600" data-i18n="contact.company-address">昆山市新南西路369号</div>
</div>
</div>
<div class="flex items-center">
<span class="iconify text-blue-600 mr-3" data-icon="mdi:phone"></span>
<div class="text-gray-600" data-i18n="contact.company-phone">+86 21 8888 6666</div>
</div>
<div class="flex items-center">
<span class="iconify text-blue-600 mr-3" data-icon="mdi:email"></span>
<div class="text-gray-600" data-i18n="contact.company-email">service@lamipak.com</div>
</div>
<div class="flex items-center">
<span class="iconify text-blue-600 mr-3" data-icon="mdi:clock"></span>
<div class="text-gray-600" data-i18n="contact.company-hours">周一至周五 9:00-18:00 (GMT+8)</div>
</div>
</div>
</div>
<div>
<h3 class="text-xl font-semibold text-gray-800 mb-4" data-i18n="contact.social-media">社交媒体</h3>
<div class="flex space-x-4">
<button class="text-blue-500 hover:text-blue-700">
<span class="iconify text-2xl" data-icon="mdi:wechat"></span>
</button>
<button class="text-blue-500 hover:text-blue-700">
<span class="iconify text-2xl" data-icon="mdi:linkedin"></span>
</button>
<button class="text-blue-500 hover:text-blue-700">
<span class="iconify text-2xl" data-icon="mdi:twitter"></span>
</button>
</div>
</div>
</div>
<div>
<h3 class="text-xl font-semibold text-gray-800 mb-4" data-i18n="contact.message">在线留言</h3>
<form class="space-y-4">
<div>
<label class="block text-gray-700 mb-2" data-i18n="contact.your-name">您的姓名</label>
<input class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3" type="text"/>
</div>
<div>
<label class="block text-gray-700 mb-2" data-i18n="contact.company-name-label">公司名称</label>
<input class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3" type="text"/>
</div>
<div>
<label class="block text-gray-700 mb-2" data-i18n="contact.email">电子邮箱</label>
<input class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3" type="email"/>
</div>
<div>
<label class="block text-gray-700 mb-2" data-i18n="contact.inquiry-type">咨询类型</label>
<select class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3">
<option data-i18n="contact.product-inquiry">产品咨询</option>
<option data-i18n="contact.technical-support">技术支持</option>
<option data-i18n="contact.cooperation">合作建议</option>
<option data-i18n="contact.other">其他</option>
</select>
</div>
<div>
<label class="block text-gray-700 mb-2" data-i18n="contact.message-content">消息内容</label>
<textarea class="w-full bg-gray-50 border border-gray-300 rounded-lg px-4 py-3" rows="4"></textarea>
</div>
<button class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold" type="submit" data-i18n="contact.submit">
                提交留言
              </button>
</form>
</div>
</div>
</div>
</section>
<!-- 购物车 -->
<section class="tab-content" id="cart">
<div class="bg-white rounded-2xl shadow-lg p-8">
<div class="flex justify-between items-center mb-6">
<h2 class="text-2xl font-bold text-blue-800" data-i18n="cart.title">购物车</h2>
<div class="flex items-center space-x-4">
<div class="text-gray-600">
<span data-i18n="cart.total-items">共</span> <span id="cartTotalItems" class="font-semibold text-blue-600">0</span> <span data-i18n="cart.items">件商品</span>
</div>
<div class="text-lg font-bold text-green-600">
<span data-i18n="cart.total">总计:</span> ¥<span id="cartTotalPrice">0.00</span>
</div>
</div>
</div>
<div id="cartContainer" class="space-y-6">
<!-- 购物车商品将按规格分类显示在这里 -->
<div class="text-center py-12 text-gray-500" data-i18n="cart.empty">
购物车是空的，快去添加商品吧！
</div>
</div>
<div id="cartActions" class="hidden mt-8 flex justify-end space-x-4">
<button class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-3 rounded-lg font-semibold" data-i18n="cart.clear">
清空购物车
</button>
<button class="bg-green-600 hover:bg-green-500 text-white px-8 py-3 rounded-lg font-semibold" data-i18n="cart.checkout">
去结算
</button>
</div>
</div>
</section>
</main>

<!-- 页脚 -->
<footer class="mt-16 bg-slate-800 text-slate-200">
<div class="container mx-auto px-4 py-12 max-w-6xl">
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10">
<!-- 品牌与简介 -->
<div class="lg:col-span-1">
<div class="flex items-center mb-4">
<span class="iconify text-2xl text-blue-400" data-icon="mdi:package-variant"></span>
<span class="ml-2 font-bold text-white text-lg" data-i18n="footer.company-name">乐美包装</span>
</div>
<p class="text-slate-400 text-sm leading-relaxed" data-i18n="footer.description">
客户自助下单平台 · 在线配置订单、管理画稿、追踪物流，一站式包装采购体验。
</p>
</div>
<!-- 快捷入口 -->
<div>
<h4 class="font-semibold text-white mb-4 text-sm uppercase tracking-wider" data-i18n="footer.quick-links">快捷入口</h4>
<ul class="space-y-2.5">
<li><button class="tab-btn-footer text-slate-400 hover:text-white transition text-sm" data-tab="home" data-i18n="nav.home">首页</button></li>
<li><button class="tab-btn-footer text-slate-400 hover:text-white transition text-sm" data-tab="configurator" data-i18n="nav.configurator">订单配置</button></li>
<li><button class="tab-btn-footer text-slate-400 hover:text-white transition text-sm" data-tab="orders" data-i18n="nav.orders">我的订单</button></li>
<li><button class="tab-btn-footer text-slate-400 hover:text-white transition text-sm" data-tab="design-management-new" data-i18n="nav.design-management-new">画稿管理</button></li>
<li><button class="tab-btn-footer text-slate-400 hover:text-white transition text-sm" data-tab="contact" data-i18n="nav.contact">联系我们</button></li>
</ul>
</div>
<!-- 联系方式 -->
<div>
<h4 class="font-semibold text-white mb-4 text-sm uppercase tracking-wider" data-i18n="footer.contact">联系方式</h4>
<ul class="space-y-3">
<li class="flex items-start text-sm">
<span class="iconify text-blue-400 mr-2 mt-0.5 flex-shrink-0" data-icon="mdi:map-marker"></span>
<span class="text-slate-400" data-i18n="footer.address">昆山市新南西路369号</span>
</li>
<li class="flex items-center text-sm">
<span class="iconify text-blue-400 mr-2 flex-shrink-0" data-icon="mdi:phone"></span>
<a href="tel:+862188886666" class="text-slate-400 hover:text-white transition">+86 21 8888 6666</a>
</li>
<li class="flex items-center text-sm">
<span class="iconify text-blue-400 mr-2 flex-shrink-0" data-icon="mdi:email"></span>
<a href="mailto:service@lamipak.com" class="text-slate-400 hover:text-white transition">service@lamipak.com</a>
</li>
<li class="flex items-center text-sm">
<span class="iconify text-blue-400 mr-2 flex-shrink-0" data-icon="mdi:clock-outline"></span>
<span class="text-slate-400" data-i18n="footer.business-hours">周一至周五 9:00-18:00 (GMT+8)</span>
</li>
</ul>
</div>
<!-- 服务说明 -->
<div>
<h4 class="font-semibold text-white mb-4 text-sm uppercase tracking-wider" data-i18n="footer.services">平台服务</h4>
<ul class="space-y-2.5 text-sm text-slate-400">
<li data-i18n="footer.service-online">· 在线选品与配置</li>
<li data-i18n="footer.service-artwork">· 画稿上传与管理</li>
<li data-i18n="footer.service-tracking">· 订单跟踪与对账</li>
<li data-i18n="footer.service-query">· 7×24 自助查询</li>
</ul>
</div>
</div>
<div class="mt-12 pt-8 border-t border-slate-700 flex flex-col sm:flex-row items-center justify-between gap-4">
<p class="text-slate-500 text-sm" data-i18n="footer.copyright">© 2025 乐美包装材料有限公司 · 客户自助下单平台</p>
<div class="flex items-center gap-6 text-sm">
<a href="#" class="text-slate-500 hover:text-slate-300 transition" data-i18n="footer.terms">使用条款</a>
<a href="#" class="text-slate-500 hover:text-slate-300 transition" data-i18n="footer.privacy">隐私政策</a>
</div>
</div>
</div>
</footer>

<!-- 公司信息详情模态框 -->
<div id="companyInfoModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
<div class="bg-white rounded-2xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto mx-auto">
<!-- 模态框头部 -->
<div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-2xl">
<h2 class="text-xl font-bold text-gray-800" data-i18n="company.title">公司详细信息</h2>
<button id="closeCompanyInfoModal" class="text-gray-400 hover:text-gray-600 transition">
<span class="iconify text-2xl" data-icon="mdi:close"></span>
</button>
</div>
<!-- 模态框内容 -->
<div class="p-6">
<!-- 公司名称（可编辑） -->
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="company.name">公司名称 <span class="text-red-500">*</span></label>
<div class="flex items-center gap-3">
<input type="text" id="companyNameInput" disabled class="flex-1 border border-gray-300 rounded-lg px-4 py-2 bg-gray-50 text-gray-800 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 focus:bg-white disabled:bg-gray-50 disabled:cursor-not-allowed" value="章三包装有限公司"/>
<button id="editCompanyNameBtn" class="text-blue-600 hover:text-blue-800 font-medium flex items-center whitespace-nowrap">
<span class="iconify mr-1" data-icon="mdi:pencil"></span><span data-i18n="company.edit">修改</span>
</button>
</div>
<div id="companyNameEditActions" class="hidden mt-2 flex gap-2">
<button id="saveCompanyNameBtn" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-medium transition" data-i18n="company.save">保存</button>
<button id="cancelCompanyNameBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition" data-i18n="company.cancel">取消</button>
</div>
</div>
<!-- 税号 -->
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="company.tax-number">税号</label>
<div class="text-gray-800 bg-gray-50 rounded-lg px-4 py-2">91320583MA1N2P3Q4R</div>
</div>
<!-- 乐美销售负责人 -->
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="company.sales-manager">乐美销售负责人</label>
<div class="text-gray-800 bg-gray-50 rounded-lg px-4 py-2">张经理 (电话: 138-0000-0000)</div>
</div>
<!-- 收货地址 -->
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="company.delivery-address">收货地址</label>
<div class="text-gray-800 bg-gray-50 rounded-lg px-4 py-2">昆山市新南西路369号</div>
</div>
<!-- 联系人信息 -->
<div class="mb-6">
<label class="block text-gray-700 mb-2 font-medium" data-i18n="company.contact-info">联系人信息</label>
<div class="bg-gray-50 rounded-lg p-4 space-y-3">
<div class="flex items-center flex-wrap">
<span class="iconify text-blue-600 mr-2 text-lg" data-icon="mdi:account"></span>
<span class="text-gray-700 font-medium mr-4 min-w-[100px]" data-i18n="company.contact-name">联系人姓名:</span>
<span class="text-gray-800">章三</span>
</div>
<div class="flex items-center flex-wrap">
<span class="iconify text-blue-600 mr-2 text-lg" data-icon="mdi:phone"></span>
<span class="text-gray-700 font-medium mr-4 min-w-[100px]" data-i18n="company.contact-phone">联系电话:</span>
<a href="tel:138-0000-0000" class="text-blue-600 hover:text-blue-800 hover:underline">138-0000-0000</a>
</div>
<div class="flex items-center flex-wrap">
<span class="iconify text-blue-600 mr-2 text-lg" data-icon="mdi:email"></span>
<span class="text-gray-700 font-medium mr-4 min-w-[100px]" data-i18n="company.contact-email">联系邮箱:</span>
<a href="mailto:zhangsan@example.com" class="text-blue-600 hover:text-blue-800 hover:underline break-all">zhangsan@example.com</a>
</div>
</div>
</div>
</div>
<!-- 模态框底部 -->
<div class="sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end gap-3 rounded-b-2xl">
<button id="closeCompanyInfoModalBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-lg font-medium" data-i18n="company.close">关闭</button>
</div>
</div>
</div>
<script>
    // ==================== 多语言翻译系统 ====================
    // 翻译数据对象
    const translations = {
      zh: {
        // 导航栏
        'nav.home': '首页',
        'nav.configurator': '订单配置',
        'nav.orders': '我的订单',
        'nav.finance': '财务信息',
        'nav.design-management': '画稿管理',
        'nav.design-management-new': '画稿管理（新）',
        'nav.contact': '联系我们',
        'nav.cart': '购物车',
        'nav.search-placeholder': '搜索产品...',
        'nav.image-search': '图片搜索',
        'nav.image-search-title': '图片搜索',
        'nav.paste-image': '粘贴图片或拖拽图片到这里',
        'nav.image-formats': '支持 JPG、PNG 格式',
        'nav.search-similar': '搜索相似图片',
        'nav.searching-images': '正在搜索相似图片...（这里会调用后台API）',
        'nav.pasted-image': '粘贴的图片',
        'nav.clear': '清除',
        'nav.company-name': '乐美包装',
        
        // 首页
        'home.company-intro': '公司介绍',
        'home.company-desc1': '乐美包装是领先的包装材料解决方案提供商，专注于为食品饮料、电子产品等行业提供高质量包装产品。拥有超过10年行业经验，服务全球500+企业客户。',
        'home.company-desc2': '我们提供纸箱、泡沫、胶带等全品类包装材料，支持定制化设计和批量生产，满足不同行业的包装需求。',
        'home.learn-more': '了解更多',
        'home.free-sample': '免费样品',
        'home.hot-products': '热销产品',
        'home.view-details': '详情',
        'home.add-to-cart': '加入购物车',
        
        // 订单配置
        'config.title': '订单配置工具',
        'config.step1': '选择配置与设计',
        'config.step2': '下单',
        'config.filter-title': '筛选条件',
        'config.filter-format': '规格选择 (Format)',
        'config.filter-all-format': '全部规格',
        'config.filter-machine': '灌装机型号',
        'config.filter-all-machine': '全部型号',
        'config.filter-filling': '填充物类型',
        'config.filter-all-filling': '全部类型',
        'config.filter-material': '材料结构',
        'config.filter-all-material': '全部材料',
        'config.filter-product-group': '产品组',
        'config.filter-all-product-group': '全部产品组',
        'config.filter-series': '系列',
        'config.filter-all-series': '全部系列',
        'config.filter-certification': '认证要求',
        'config.search-placeholder': '搜索设计描述/产品代码...',
        'config.select-design': '选择此设计',
        'config.next': '下一步',
        'config.prev': '上一步',
        'config.product-info': '产品信息',
        'config.product-name': '产品名称:',
        'config.material-number': '物料号:',
        'config.format': '规格:',
        'config.material': '材料结构:',
        'config.purchase-info': '采购信息',
        'config.quantity': '数量',
        'config.unit': '(单位: 箱)',
        'config.delivery-date': '期望送达日期',
        'config.special-requirements': '特殊要求',
        'config.confirm-order': '确认下单',
        'config.add-to-cart': '加入购物车',
        'config.order-placing': '下单 (Order Placing)',
        'config.product-main-image': '产品主图',
        'config.detail-image': '细节图',
        
        // 订单列表
        'orders.title': '我的订单',
        'orders.search-placeholder': '搜索订单号...',
        'orders.all-status': '全部状态',
        'orders.pending-review': '待审核',
        'orders.pending-confirm': '待客户确认',
        'orders.confirmed': '已确认',
        'orders.completed': '已完成',
        'orders.order-number': '订单号',
        'orders.date': '日期',
        'orders.product': '产品',
        'orders.quantity': '数量',
        'orders.amount': '金额',
        'orders.status': '状态',
        'orders.action': '操作',
        'orders.view': '查看',
        'orders.showing': '显示',
        'orders.total': '共',
        'orders.items': '条',
        'orders.prev-page': '上一页',
        'orders.next-page': '下一页',
        'orders.last-30-days': '最近30天',
        'orders.this-month': '本月',
        'orders.last-month': '上个月',
        'orders.year-2025': '2025年',
        
        // 订单详情
        'order-detail.title': '订单详情',
        'order-detail.back': '返回订单列表',
        'order-detail.status-flow': '订单状态流程',
        'order-detail.ordered': '已下单',
        'order-detail.pending-review': '待审核',
        'order-detail.current-status': '当前状态',
        'order-detail.pending-confirm': '待客户确认',
        'order-detail.confirmed': '已确认',
        'order-detail.completed': '已完成',
        'order-detail.actions': '订单操作',
        'order-detail.repurchase': '一键复购',
        'order-detail.logistics': '查看订单物流信息',
        'order-detail.modify': '发起修改申请',
        'order-detail.complaint': '发起客诉',
        'order-detail.export-order': '导出订单信息',
        'order-detail.export-invoice': '导出发票信息',
        'order-detail.basic-info': '订单基本信息',
        'order-detail.order-number': '订单号',
        'order-detail.order-time': '下单时间',
        'order-detail.order-status': '订单状态',
        'order-detail.total-amount': '订单总金额',
        'order-detail.sku-count': 'SKU总数',
        'order-detail.total-quantity': '总数量',
        'order-detail.avg-price': '平均单价',
        'order-detail.delivery-date': '期望送达日期',
        'order-detail.product-list': '订单商品列表',
        'order-detail.sku-name': 'SKU名称',
        'order-detail.material-number': '物料号',
        'order-detail.format': '规格',
        'order-detail.unit-price': '单价',
        'order-detail.subtotal': '小计',
        'order-detail.view-details': '查看详情',
        'order-detail.hide-details': '隐藏详情',
        'order-detail.product-spec': '产品规格',
        'order-detail.product-params': '产品参数',
        'order-detail.machine-model': '灌装机型号',
        'order-detail.filling-type': '填充物类型',
        'order-detail.paper-requirement': '原纸要求',
        'order-detail.certification': '认证要求',
        'order-detail.material-number-label': '物料号',
        'order-detail.quantity-label': '数量',
        'order-detail.material-structure': '材料结构',
        'order-detail.format-label': '规格选择 (Format)',
        'order-detail.standard-paper': '标准原纸',
        'order-detail.no-certification': '无',
        'order-detail.unit-case': '箱',
        'order-detail.product-name-drk': '饮料包装设计 #DRK-2023',
        'order-detail.product-name-dary': '乳品包装设计 #DARY-2024',
        'order-detail.product-name-milk': '牛奶包装设计 #MILK-2024',
        'order-detail.filling-uht-milk': 'UHT牛奶',
        'order-detail.filling-dairy': '乳制品',
        'order-detail.paper-fsc': 'FSC认证原纸',
        
        // 客诉
        'complaint.title': '发起客诉',
        'complaint.order-info': '订单信息',
        'complaint.order-number': '订单号:',
        'complaint.product-name': '产品名称:',
        'complaint.type': '客诉类型',
        'complaint.type-quality': '产品质量问题',
        'complaint.type-logistics': '物流配送问题',
        'complaint.type-service': '服务态度问题',
        'complaint.type-invoice': '发票问题',
        'complaint.type-other': '其他问题',
        'complaint.content': '客诉内容',
        'complaint.content-placeholder': '请详细描述您遇到的问题...',
        'complaint.upload': '上传凭证（可选）',
        'complaint.upload-desc': '支持上传多张图片，格式：JPG、PNG，单张不超过5MB',
        'complaint.cancel': '取消',
        'complaint.submit': '提交客诉',
        
        // 财务信息
        'finance.title': '财务信息',
        'finance.ordered-amount': '已下单金额',
        'finance.this-year': '本年度',
        'finance.rebate-amount': '已返利金额',
        'finance.due-soon': '即将到期的付款',
        'finance.days': '30天内到期',
        'finance.overdue': '已经到期的付款',
        'finance.overdue-desc': '已逾期',
        'finance.details': '财务明细',
        'finance.export': '导出报表',
        'finance.invoice-number': '发票编号',
        'finance.invoice-time': '发票时间',
        'finance.invoice-amount': '发票金额',
        'finance.paid-amount': '发票已付金额',
        'finance.unpaid-amount': '发票未付金额 (Outstanding)',
        'finance.due-date': 'Due Date',
        
        // 画稿管理
        'design.title': '画稿管理',
        'design.upload': '上传新画稿',
        'design.browse': '查看已有画稿',
        'design.upload-preview': '上传预览文件',
        'design.upload-preview-desc': '支持 JPG/PNG/PDF 格式<br/>用于AI解析和预览',
        'design.select-file': '选择文件',
        'design.upload-original': '上传原文件',
        'design.upload-original-desc': '原始设计文件 (最大600MB)<br/>用于后续制作处理',
        'design.ai-result': 'AI解析结果',
        'design.ai-completed': '分析完成',
        'design.filling-type': '填充物类型',
        'design.capacity': '容量',
        'design.punched': '是否打孔',
        'design.yes': '是',
        'design.no': '否',
        'design.opening-device': '开启设备',
        'design.color-target': '物理颜色目标',
        'design.ai-match': 'AI分析判断：匹配到已有设计',
        'design.ai-similarity': '检测到相似度92%的设计版本：100s型号-V7',
        'design.view-match': '查看匹配设计',
        'design.ai-accept': '您是否认可AI的分析？',
        'design.new-design': '是新设计',
        'design.existing-design': '是已有设计',
        'design.not-sure': '不确认',
        'design.additional-notes': '附加说明',
        'design.contact-info': '联系人信息',
        'design.email': '联系邮箱',
        'design.backup-email': '备用邮箱',
        'design.backup-email-placeholder': '选填备用邮箱',
        'design.cancel': '取消',
        'design.submit': '提交设计',
        'design.version-library': '设计版本库',
        'design.spec': '规格：',
        'design.skus': '个SKU',
        'design.versions': '个版本',
        'design.current-version': '设计版本',
        'design.history-version': '设计版本',
        'design.current': '(当前版本)',
        'design.history': '(历史版本)',
        
        // 联系我们
        'contact.title': '联系我们',
        'contact.company-info': '公司信息',
        'contact.company-name': '乐美包装材料有限公司',
        'contact.company-address': '昆山市新南西路369号',
        'contact.company-phone': '+86 21 8888 6666',
        'contact.company-email': 'service@lamipak.com',
        'contact.company-hours': '周一至周五 9:00-18:00 (GMT+8)',
        'contact.social-media': '社交媒体',
        'contact.message': '在线留言',
        'contact.your-name': '您的姓名',
        'contact.company-name-label': '公司名称',
        'contact.email': '电子邮箱',
        'contact.inquiry-type': '咨询类型',
        'contact.product-inquiry': '产品咨询',
        'contact.technical-support': '技术支持',
        'contact.cooperation': '合作建议',
        'contact.other': '其他',
        'contact.message-content': '消息内容',
        'contact.submit': '提交留言',
        
        // 购物车
        'cart.title': '购物车',
        'cart.total-items': '共',
        'cart.items': '件商品',
        'cart.total': '总计:',
        'cart.empty': '购物车是空的，快去添加商品吧！',
        'cart.clear': '清空购物车',
        'cart.checkout': '去结算',
        'cart.uncategorized': '未分类',
        'cart.items-count': '个商品',
        'cart.material': '材料',
        'cart.machine': '灌装机',
        'cart.filling': '填充物',
        'cart.remove-item': '删除',
        
        // 公司信息
        'company.title': '公司详细信息',
        'company.name': '公司名称',
        'company.tax-number': '税号',
        'company.sales-manager': '乐美销售负责人',
        'company.delivery-address': '收货地址',
        'company.contact-info': '联系人信息',
        'company.contact-name': '联系人姓名:',
        'company.contact-phone': '联系电话:',
        'company.contact-email': '联系邮箱:',
        'company.edit': '修改',
        'company.save': '保存',
        'company.cancel': '取消',
        'company.close': '关闭',
        'company.name-required': '公司名称不能为空',
        'company.save-success': '公司名称修改成功！',
        
        // 画稿管理（新）
        'design-new.title': '画稿管理（新）',
        'design-new.upload-new': '上传新画稿',
        'design-new.artwork-management': '画稿管理',
        'design-new.artwork-library': '画稿库',
        'design-new.view-existing': '查看现有画稿',
        'design-new.view-all-records': '查看所有画稿记录',
        'design-new.stage-overview': '画稿流程阶段',
        'design-new.stage': '阶段',
        'design-new.stage1': '阶段 1',
        'design-new.stage2': '阶段 2',
        'design-new.stage3': '阶段 3',
        'design-new.stage4': '阶段 4',
        'design-new.stage1-title': '上传文件',
        'design-new.stage1-desc': '上传预览文件和原文件',
        'design-new.stage2-title': 'AI解析和复核',
        'design-new.stage2-desc': 'AI解析 + 乐美人工复核',
        'design-new.stage3-title': '沟通和评论',
        'design-new.stage3-desc': '画稿沟通和评论',
        'design-new.stage4-title': '画稿制作',
        'design-new.stage4-desc': '进入制作流程',
        'design-new.back': '返回',
        'design-new.stage1-heading': '阶段 1：上传文件',
        'design-new.upload-preview': '上传预览文件',
        'design-new.upload-preview-desc': '支持 JPG/PNG/PDF 格式<br/>用于AI解析和预览',
        'design-new.select-file': '选择文件',
        'design-new.upload-original': '上传原文件',
        'design-new.upload-original-desc': '原始设计文件 (最大600MB)<br/>用于后续制作处理',
        'design-new.file-link': '或输入文件链接',
        'design-new.file-link-placeholder': '例如：https://example.com/files/design.pdf',
        'design-new.file-link-desc': '支持通过链接方式提交文件',
        'design-new.cancel': '取消',
        'design-new.submit-files': '提交文件',
        'design-new.next': '下一步',
        'design-new.stage2-heading': '阶段 2：AI解析和乐美人工复核',
        'design-new.files-received': '文件已收到',
        'design-new.processing': '乐美已收到您提交的文件，正在处理中...',
        'design-new.estimated-time': '预计处理时间',
        'design-new.working-day': '1 个工作日',
        'design-new.notification': '处理完成后，我们将通知您进入下一阶段',
        'design-new.stage3-heading': '阶段 3：画稿沟通和评论',
        'design-new.artwork-info': '画稿信息',
        'design-new.lamipak-determined': '乐美工作人员确定',
        'design-new.customer-confirm': '客户确认和修改',
        'design-new.ai-completed': 'AI解析和乐美复核已完成',
        'design-new.confirm-info': '请确认以下信息，如有需要可进行修改',
        'design-new.design-code': 'Design Code',
        'design-new.paperboard': 'Paperboard',
        'design-new.artwork-type': 'Artwork type',
        'design-new.artwork-type-new': '新设计 - 该SKU从未由Lamipak印刷过',
        'design-new.artwork-type-existing': '已有设计 - 该SKU已由Lamipak印刷过',
        'design-new.color-target': 'Color target',
        'design-new.color-target-no': 'No',
        'design-new.color-target-digital': '根据数字画稿',
        'design-new.print-plant': 'Print Plant',
        'design-new.plant-kunshan': '昆山工厂',
        'design-new.plant-indonesia': '印尼工厂',
        'design-new.product-title': 'Product title',
        'design-new.format': 'Format',
        'design-new.opening': 'Opening',
        'design-new.opening-strawhole': '带吸管孔',
        'design-new.opening-no-strawhole': '不带吸管孔',
        'design-new.opening-screw-cap': '带螺旋盖',
        'design-new.opening-spout': '带出料口',
        'design-new.logo-type': '纸张类型 logo',
        'design-new.logo-none': '无FSC/PEFC标识',
        'design-new.logo-fsc': 'FSC标识',
        'design-new.logo-pefc': 'PEFC标识',
        'design-new.multiple-styles': 'Multiple Styles',
        'design-new.yes': '是',
        'design-new.no': '否',
        'design-new.confirm-submit': '确认并提交',
        'design-new.stage4-heading': '阶段 4：画稿制作',
        'design-new.artwork-preview': '画稿预览',
        'design-new.comments': '评论',
        'design-new.comment-count': '条评论',
        'design-new.comment-count-zero': '0 条评论',
        'design-new.comment-placeholder': '输入您的评论...',
        'design-new.send': '发送',
        'design-new.confirm-version': '确认画稿版本',
        'design-new.confirm-version-desc': '确认当前画稿版本后，将进入制作流程',
        'design-new.tag-confirmed': 'Tag as Confirmed Version',
        'design-new.no-comments': '暂无评论，开始讨论吧',
        'design-new.customer': '客户',
        'design-new.lemi': '乐',
        'design-new.lemi-service': '乐美客服',
        'design-new.initial-comment': '您好！这是AI解析后的画稿预览，请查看并告知您的意见。',
        'design-new.time-just-now': '刚刚',
        'design-new.time-minutes-ago': '分钟前',
        'design-new.time-hours-ago': '小时前',
        'design-new.time-days-ago': '天前',
        'design-new.reply-received': '收到，我们会尽快处理您的反馈。',
        'design-new.reply-recorded': '好的，我们已记录您的意见。',
        'design-new.reply-thanks': '感谢您的反馈，我们会认真考虑。',
        'design-new.reply-understood': '明白了，我们会按照您的要求调整。',
        'design-new.artwork-confirmed': '画稿已确认',
        'design-new.production-started': '画稿版本已确认，已进入制作流程',
        'design-new.production-status': '制作状态',
        'design-new.in-production': '制作中',
        'design-new.files-received-status': '文件已接收',
        'design-new.ai-completed-status': 'AI解析完成',
        'design-new.customer-confirmed-status': '客户已确认',
        'design-new.production-in-progress': '制作进行中...',
        'design-new.sample-shipping': '样品寄送',
        'design-new.sample-shipping-desc': '选择是否需要寄送样品',
        'design-new.recipient-info': '收件信息',
        'design-new.recipient-name': '收件人',
        'design-new.recipient-name-placeholder': '请输入收件人姓名',
        'design-new.recipient-address': '收件地址',
        'design-new.recipient-address-placeholder': '请输入详细收件地址',
        'design-new.save-recipient-info': '保存收件信息',
        'design-new.view-artworks': '查看现有画稿',
        'design-new.search-format': '规格',
        'design-new.search-format-placeholder': '搜索规格...',
        'design-new.search-plant': '工厂',
        'design-new.search-paperboard': '纸张类型',
        'design-new.search-status': '状态',
        'design-new.all': '全部',
        'design-new.search': '搜索',
        'design-new.reset': '重置',
        'design-new.design-code-col': 'Design Code',
        'design-new.format-col': '规格',
        'design-new.plant-col': '工厂',
        'design-new.paperboard-col': '纸张类型',
        'design-new.status-col': '状态',
        'design-new.action-col': '操作',
        'design-new.view-images': '查看图片',
        'design-new.no-artworks': '暂无画稿记录',
        'design-new.status-in-production': '制作中',
        'design-new.status-completed': '已完成',
        'design-new.status-pending': '待确认',
        'design-new.status-confirmed': '已确认',
        'design-new.total-files': '总文件数:',
        'design-new.total-size': '总大小:',
        'design-new.alert-upload-required': '请至少上传一个文件或输入文件链接',
        'design-new.alert-files-submitted': '文件已提交！乐美已收到您的文件，正在处理中...',
        'design-new.alert-info-submitted': '确认信息已提交！',
        'design-new.confirm-version-title': '确认将此画稿版本标记为已确认版本？确认后将进入制作流程。',
        'design-new.alert-version-confirmed': '画稿版本已确认！已进入制作流程。',
        'design-new.alert-select-shipping': '请先选择需要寄送样品',
        'design-new.alert-recipient-name-required': '请输入收件人姓名',
        'design-new.alert-recipient-address-required': '请输入收件地址',
        'design-new.alert-recipient-info-saved': '收件信息已保存！',
        
        // 通用
        'common.loading': '加载中...',
        'common.confirm': '确认',
        'common.delete': '删除',
        'common.edit': '编辑',
        'common.save': '保存',
        'common.cancel': '取消',
        'common.close': '关闭',
        'common.submit': '提交',
        'common.search': '搜索',
        'common.view': '查看',
        'common.delete-confirm': '确定要删除这个商品吗？',
        'common.clear-cart-confirm': '确定要清空购物车吗？',
        'common.added-to-cart': '商品已成功加入购物车！',
        'common.select-design-first': '请先选择商品设计',
        'common.no-products': '没有找到符合条件的产品',
        'common.spec': '规格:',
        'common.products': '个产品',
        'common.items': '个商品',
        
        // Footer
        'footer.company-name': '乐美包装',
        'footer.description': '客户自助下单平台 · 在线配置订单、管理画稿、追踪物流，一站式包装采购体验。',
        'footer.quick-links': '快捷入口',
        'footer.contact': '联系方式',
        'footer.address': '昆山市新南西路369号',
        'footer.business-hours': '周一至周五 9:00-18:00 (GMT+8)',
        'footer.services': '平台服务',
        'footer.service-online': '在线选品与配置',
        'footer.service-artwork': '画稿上传与管理',
        'footer.service-tracking': '订单跟踪与对账',
        'footer.service-query': '7×24 自助查询',
        'footer.copyright': '© 2025 乐美包装材料有限公司 · 客户自助下单平台',
        'footer.terms': '使用条款',
        'footer.privacy': '隐私政策',
      },
      en: {
        // Navigation
        'nav.home': 'Home',
        'nav.configurator': 'Order Configurator',
        'nav.orders': 'My Orders',
        'nav.finance': 'Finance',
        'nav.design-management': 'Design Management',
        'nav.design-management-new': 'Design Management (New)',
        'nav.contact': 'Contact Us',
        'nav.cart': 'Shopping Cart',
        'nav.search-placeholder': 'Search products...',
        'nav.image-search': 'Image Search',
        'nav.image-search-title': 'Image Search',
        'nav.paste-image': 'Paste or drag image here',
        'nav.image-formats': 'Supports JPG, PNG formats',
        'nav.search-similar': 'Search Similar Images',
        'nav.searching-images': 'Searching for similar images... (This will call the backend API)',
        'nav.pasted-image': 'Pasted image',
        'nav.clear': 'Clear',
        'nav.company-name': 'LamiPak',
        
        // Home
        'home.company-intro': 'Company Introduction',
        'home.company-desc1': 'LamiPak is a leading packaging materials solution provider, focusing on providing high-quality packaging products for food & beverage, electronics and other industries. With over 10 years of industry experience, serving 500+ corporate customers worldwide.',
        'home.company-desc2': 'We provide full range of packaging materials including cartons, foam, tape, etc., supporting customized design and mass production to meet packaging needs of different industries.',
        'home.learn-more': 'Learn More',
        'home.free-sample': 'Free Sample',
        'home.hot-products': 'Hot Products',
        'home.view-details': 'Details',
        'home.add-to-cart': 'Add to Cart',
        
        // Order Configurator
        'config.title': 'Order Configurator',
        'config.step1': 'Select Configuration & Design',
        'config.step2': 'Place Order',
        'config.filter-title': 'Filters',
        'config.filter-format': 'Format Selection',
        'config.filter-all-format': 'All Formats',
        'config.filter-machine': 'Filling Machine Model',
        'config.filter-all-machine': 'All Models',
        'config.filter-filling': 'Filling Type',
        'config.filter-all-filling': 'All Types',
        'config.filter-material': 'Material Structure',
        'config.filter-all-material': 'All Materials',
        'config.filter-product-group': 'Product Group',
        'config.filter-all-product-group': 'All Product Groups',
        'config.filter-series': 'Series',
        'config.filter-all-series': 'All Series',
        'config.filter-certification': 'Certification Requirements',
        'config.search-placeholder': 'Search design description/product code...',
        'config.select-design': 'Select This Design',
        'config.next': 'Next',
        'config.prev': 'Previous',
        'config.product-info': 'Product Information',
        'config.product-name': 'Product Name:',
        'config.material-number': 'Material Number:',
        'config.format': 'Format:',
        'config.material': 'Material Structure:',
        'config.purchase-info': 'Purchase Information',
        'config.quantity': 'Quantity',
        'config.unit': '(Unit: Case)',
        'config.delivery-date': 'Expected Delivery Date',
        'config.special-requirements': 'Special Requirements',
        'config.confirm-order': 'Confirm Order',
        'config.add-to-cart': 'Add to Cart',
        'config.order-placing': 'Order Placing',
        'config.product-main-image': 'Product Main Image',
        'config.detail-image': 'Detail Image',
        
        // Orders
        'orders.title': 'My Orders',
        'orders.search-placeholder': 'Search order number...',
        'orders.all-status': 'All Status',
        'orders.pending-review': 'Pending Review',
        'orders.pending-confirm': 'Pending Customer Confirmation',
        'orders.confirmed': 'Confirmed',
        'orders.completed': 'Completed',
        'orders.order-number': 'Order Number',
        'orders.date': 'Date',
        'orders.product': 'Product',
        'orders.quantity': 'Quantity',
        'orders.amount': 'Amount',
        'orders.status': 'Status',
        'orders.action': 'Action',
        'orders.view': 'View',
        'orders.showing': 'Showing',
        'orders.total': 'Total',
        'orders.items': 'items',
        'orders.prev-page': 'Previous',
        'orders.next-page': 'Next',
        'orders.last-30-days': 'Last 30 Days',
        'orders.this-month': 'This Month',
        'orders.last-month': 'Last Month',
        'orders.year-2025': 'Year 2025',
        
        // Order Detail
        'order-detail.title': 'Order Details',
        'order-detail.back': 'Back to Order List',
        'order-detail.status-flow': 'Order Status Flow',
        'order-detail.ordered': 'Ordered',
        'order-detail.pending-review': 'Pending Review',
        'order-detail.current-status': 'Current Status',
        'order-detail.pending-confirm': 'Pending Customer Confirmation',
        'order-detail.confirmed': 'Confirmed',
        'order-detail.completed': 'Completed',
        'order-detail.actions': 'Order Actions',
        'order-detail.repurchase': 'One-Click Repurchase',
        'order-detail.logistics': 'View Logistics',
        'order-detail.modify': 'Request Modification',
        'order-detail.complaint': 'File Complaint',
        'order-detail.export-order': 'Export Order Info',
        'order-detail.export-invoice': 'Export Invoice',
        'order-detail.basic-info': 'Basic Order Information',
        'order-detail.order-number': 'Order Number',
        'order-detail.order-time': 'Order Time',
        'order-detail.order-status': 'Order Status',
        'order-detail.total-amount': 'Total Amount',
        'order-detail.sku-count': 'Total SKUs',
        'order-detail.total-quantity': 'Total Quantity',
        'order-detail.avg-price': 'Average Unit Price',
        'order-detail.delivery-date': 'Expected Delivery Date',
        'order-detail.product-list': 'Order Product List',
        'order-detail.sku-name': 'SKU Name',
        'order-detail.material-number': 'Material Number',
        'order-detail.format': 'Format',
        'order-detail.unit-price': 'Unit Price',
        'order-detail.subtotal': 'Subtotal',
        'order-detail.view-details': 'View Details',
        'order-detail.hide-details': 'Hide Details',
        'order-detail.product-spec': 'Product Specifications',
        'order-detail.product-params': 'Product Parameters',
        'order-detail.machine-model': 'Filling Machine Model',
        'order-detail.filling-type': 'Filling Type',
        'order-detail.paper-requirement': 'Paper Requirement',
        'order-detail.certification': 'Certification Requirements',
        'order-detail.material-number-label': 'Material Number',
        'order-detail.quantity-label': 'Quantity',
        'order-detail.material-structure': 'Material Structure',
        'order-detail.format-label': 'Format Selection',
        'order-detail.standard-paper': 'Standard Paper',
        'order-detail.no-certification': 'None',
        'order-detail.unit-case': 'Case',
        'order-detail.product-name-drk': 'Beverage Packaging Design #DRK-2023',
        'order-detail.product-name-dary': 'Dairy Packaging Design #DARY-2024',
        'order-detail.product-name-milk': 'Milk Packaging Design #MILK-2024',
        'order-detail.filling-uht-milk': 'UHT Milk',
        'order-detail.filling-dairy': 'Dairy Products',
        'order-detail.paper-fsc': 'FSC Certified Paper',
        
        // Complaint
        'complaint.title': 'File Complaint',
        'complaint.order-info': 'Order Information',
        'complaint.order-number': 'Order Number:',
        'complaint.product-name': 'Product Name:',
        'complaint.type': 'Complaint Type',
        'complaint.type-quality': 'Product Quality Issue',
        'complaint.type-logistics': 'Logistics Delivery Issue',
        'complaint.type-service': 'Service Attitude Issue',
        'complaint.type-invoice': 'Invoice Issue',
        'complaint.type-other': 'Other Issue',
        'complaint.content': 'Complaint Content',
        'complaint.content-placeholder': 'Please describe the issue you encountered in detail...',
        'complaint.upload': 'Upload Evidence (Optional)',
        'complaint.upload-desc': 'Supports multiple images, formats: JPG, PNG, max 5MB per image',
        'complaint.cancel': 'Cancel',
        'complaint.submit': 'Submit Complaint',
        
        // Finance
        'finance.title': 'Finance Information',
        'finance.ordered-amount': 'Ordered Amount',
        'finance.this-year': 'This Year',
        'finance.rebate-amount': 'Rebate Amount',
        'finance.due-soon': 'Payment Due Soon',
        'finance.days': 'Due in 30 days',
        'finance.overdue': 'Overdue Payment',
        'finance.overdue-desc': 'Overdue',
        'finance.details': 'Finance Details',
        'finance.export': 'Export Report',
        'finance.invoice-number': 'Invoice Number',
        'finance.invoice-time': 'Invoice Time',
        'finance.invoice-amount': 'Invoice Amount',
        'finance.paid-amount': 'Paid Amount',
        'finance.unpaid-amount': 'Unpaid Amount (Outstanding)',
        'finance.due-date': 'Due Date',
        
        // Design Management
        'design.title': 'Design Management',
        'design.upload': 'Upload New Design',
        'design.browse': 'Browse Existing Designs',
        'design.upload-preview': 'Upload Preview File',
        'design.upload-preview-desc': 'Supports JPG/PNG/PDF formats<br/>For AI parsing and preview',
        'design.select-file': 'Select File',
        'design.upload-original': 'Upload Original File',
        'design.upload-original-desc': 'Original design file (max 600MB)<br/>For production processing',
        'design.ai-result': 'AI Analysis Result',
        'design.ai-completed': 'Analysis Completed',
        'design.filling-type': 'Filling Type',
        'design.capacity': 'Capacity',
        'design.punched': 'Punched',
        'design.yes': 'Yes',
        'design.no': 'No',
        'design.opening-device': 'Opening Device',
        'design.color-target': 'Physical Color Target',
        'design.ai-match': 'AI Analysis: Matched existing design',
        'design.ai-similarity': 'Detected 92% similar design version: 100s model-V7',
        'design.view-match': 'View Matched Design',
        'design.ai-accept': 'Do you accept AI analysis?',
        'design.new-design': 'New Design',
        'design.existing-design': 'Existing Design',
        'design.not-sure': 'Not Sure',
        'design.additional-notes': 'Additional Notes',
        'design.contact-info': 'Contact Information',
        'design.email': 'Contact Email',
        'design.backup-email': 'Backup Email',
        'design.backup-email-placeholder': 'Optional backup email',
        'design.cancel': 'Cancel',
        'design.submit': 'Submit Design',
        'design.version-library': 'Design Version Library',
        'design.spec': 'Specification:',
        'design.skus': 'SKUs',
        'design.versions': 'versions',
        'design.current-version': 'Design Version',
        'design.history-version': 'Design Version',
        'design.current': '(Current Version)',
        'design.history': '(History Version)',
        
        // Contact
        'contact.title': 'Contact Us',
        'contact.company-info': 'Company Information',
        'contact.company-name': 'LamiPak Packaging Materials Co., Ltd.',
        'contact.company-address': 'No. 369 Xinnan West Road, Kunshan',
        'contact.company-phone': '+86 21 8888 6666',
        'contact.company-email': 'service@lamipak.com',
        'contact.company-hours': 'Monday to Friday 9:00-18:00 (GMT+8)',
        'contact.social-media': 'Social Media',
        'contact.message': 'Online Message',
        'contact.your-name': 'Your Name',
        'contact.company-name-label': 'Company Name',
        'contact.email': 'Email',
        'contact.inquiry-type': 'Inquiry Type',
        'contact.product-inquiry': 'Product Inquiry',
        'contact.technical-support': 'Technical Support',
        'contact.cooperation': 'Cooperation Proposal',
        'contact.other': 'Other',
        'contact.message-content': 'Message Content',
        'contact.submit': 'Submit Message',
        
        // Shopping Cart
        'cart.title': 'Shopping Cart',
        'cart.total-items': 'Total',
        'cart.items': 'items',
        'cart.total': 'Total:',
        'cart.empty': 'Your cart is empty, go add some products!',
        'cart.clear': 'Clear Cart',
        'cart.checkout': 'Checkout',
        'cart.uncategorized': 'Uncategorized',
        'cart.items-count': 'items',
        'cart.material': 'Material',
        'cart.machine': 'Machine',
        'cart.filling': 'Filling',
        'cart.remove-item': 'Delete',
        
        // Company Info
        'company.title': 'Company Details',
        'company.name': 'Company Name',
        'company.tax-number': 'Tax Number',
        'company.sales-manager': 'LamiPak Sales Manager',
        'company.delivery-address': 'Delivery Address',
        'company.contact-info': 'Contact Information',
        'company.contact-name': 'Contact Name:',
        'company.contact-phone': 'Contact Phone:',
        'company.contact-email': 'Contact Email:',
        'company.edit': 'Edit',
        'company.save': 'Save',
        'company.cancel': 'Cancel',
        'company.close': 'Close',
        'company.name-required': 'Company name cannot be empty',
        'company.save-success': 'Company name updated successfully!',
        
        // Design Management (New)
        'design-new.title': 'Design Management (New)',
        'design-new.upload-new': 'Upload New Design',
        'design-new.artwork-management': 'Artwork Management',
        'design-new.artwork-library': 'Artwork Library',
        'design-new.view-existing': 'View Existing Artworks',
        'design-new.view-all-records': 'View All Artwork Records',
        'design-new.stage-overview': 'Artwork Process Stages',
        'design-new.stage': 'Stage',
        'design-new.stage1': 'Stage 1',
        'design-new.stage2': 'Stage 2',
        'design-new.stage3': 'Stage 3',
        'design-new.stage4': 'Stage 4',
        'design-new.stage1-title': 'Upload Files',
        'design-new.stage1-desc': 'Upload preview and original files',
        'design-new.stage2-title': 'AI Analysis & Review',
        'design-new.stage2-desc': 'AI Analysis + LamiPak Manual Review',
        'design-new.stage3-title': 'Communication & Comments',
        'design-new.stage3-desc': 'Artwork communication and comments',
        'design-new.stage4-title': 'Artwork Production',
        'design-new.stage4-desc': 'Enter production process',
        'design-new.back': 'Back',
        'design-new.stage1-heading': 'Stage 1: Upload Files',
        'design-new.upload-preview': 'Upload Preview File',
        'design-new.upload-preview-desc': 'Supports JPG/PNG/PDF formats<br/>For AI parsing and preview',
        'design-new.select-file': 'Select File',
        'design-new.upload-original': 'Upload Original File',
        'design-new.upload-original-desc': 'Original design file (max 600MB)<br/>For production processing',
        'design-new.file-link': 'Or Enter File Link',
        'design-new.file-link-placeholder': 'e.g., https://example.com/files/design.pdf',
        'design-new.file-link-desc': 'Supports submitting files via link',
        'design-new.cancel': 'Cancel',
        'design-new.submit-files': 'Submit Files',
        'design-new.next': 'Next',
        'design-new.stage2-heading': 'Stage 2: AI Analysis & LamiPak Manual Review',
        'design-new.files-received': 'Files Received',
        'design-new.processing': 'LamiPak has received your files and is processing...',
        'design-new.estimated-time': 'Estimated Processing Time',
        'design-new.working-day': '1 Working Day',
        'design-new.notification': 'We will notify you to proceed to the next stage once processing is complete',
        'design-new.stage3-heading': 'Stage 3: Artwork Communication & Comments',
        'design-new.artwork-info': 'Artwork Information',
        'design-new.lamipak-determined': 'Determined by LamiPak Staff',
        'design-new.customer-confirm': 'Customer Confirmation & Modification',
        'design-new.ai-completed': 'AI Analysis and LamiPak Review Completed',
        'design-new.confirm-info': 'Please confirm the following information, you can modify if needed',
        'design-new.design-code': 'Design Code',
        'design-new.paperboard': 'Paperboard',
        'design-new.artwork-type': 'Artwork type',
        'design-new.artwork-type-new': '新设计 - 该SKU从未由Lamipak印刷过',
        'design-new.artwork-type-existing': '已有设计 - 该SKU已由Lamipak印刷过',
        'design-new.color-target': 'Color target',
        'design-new.color-target-no': 'No',
        'design-new.color-target-digital': '根据数字画稿',
        'design-new.print-plant': 'Print Plant',
        'design-new.plant-kunshan': 'KUNSHAN',
        'design-new.plant-indonesia': 'IDN',
        'design-new.product-title': 'Product title',
        'design-new.format': 'Format',
        'design-new.opening': 'Opening',
        'design-new.opening-strawhole': 'With Strawhole',
        'design-new.opening-no-strawhole': 'Without Strawhole',
        'design-new.opening-screw-cap': 'With Screw Cap',
        'design-new.opening-spout': 'With Spout',
        'design-new.logo-type': 'Paper Type Logo',
        'design-new.logo-none': 'No FSC/PEFC Logo',
        'design-new.logo-fsc': 'FSC Logo',
        'design-new.logo-pefc': 'PEFC Logo',
        'design-new.multiple-styles': 'Multiple Styles',
        'design-new.yes': 'Yes',
        'design-new.no': 'No',
        'design-new.confirm-submit': 'Confirm & Submit',
        'design-new.stage4-heading': 'Stage 4: Artwork Production',
        'design-new.artwork-preview': 'Artwork Preview',
        'design-new.comments': 'Comments',
        'design-new.comment-count': 'comments',
        'design-new.comment-count-zero': '0 comments',
        'design-new.comment-placeholder': 'Enter your comment...',
        'design-new.send': 'Send',
        'design-new.confirm-version': 'Confirm Artwork Version',
        'design-new.confirm-version-desc': 'After confirming the current artwork version, it will enter the production process',
        'design-new.tag-confirmed': 'Tag as Confirmed Version',
        'design-new.no-comments': 'No comments yet, start the discussion',
        'design-new.customer': 'Customer',
        'design-new.lemi': 'L',
        'design-new.lemi-service': 'LamiPak Service',
        'design-new.initial-comment': 'Hello! This is the artwork preview after AI analysis. Please review and share your feedback.',
        'design-new.time-just-now': 'Just now',
        'design-new.time-minutes-ago': 'minutes ago',
        'design-new.time-hours-ago': 'hours ago',
        'design-new.time-days-ago': 'days ago',
        'design-new.reply-received': 'Received, we will process your feedback as soon as possible.',
        'design-new.reply-recorded': 'Okay, we have recorded your opinion.',
        'design-new.reply-thanks': 'Thank you for your feedback, we will consider it carefully.',
        'design-new.reply-understood': 'Understood, we will adjust according to your requirements.',
        'design-new.artwork-confirmed': 'Artwork Confirmed',
        'design-new.production-started': 'Artwork version confirmed, production process started',
        'design-new.production-status': 'Production Status',
        'design-new.in-production': 'In Production',
        'design-new.files-received-status': 'Files Received',
        'design-new.ai-completed-status': 'AI Analysis Completed',
        'design-new.customer-confirmed-status': 'Customer Confirmed',
        'design-new.production-in-progress': 'Production In Progress...',
        'design-new.sample-shipping': 'Sample Shipping',
        'design-new.sample-shipping-desc': 'Select whether to ship samples',
        'design-new.recipient-info': 'Recipient Information',
        'design-new.recipient-name': 'Recipient Name',
        'design-new.recipient-name-placeholder': 'Enter recipient name',
        'design-new.recipient-address': 'Recipient Address',
        'design-new.recipient-address-placeholder': 'Enter detailed recipient address',
        'design-new.save-recipient-info': 'Save Recipient Information',
        'design-new.view-artworks': 'View Existing Artworks',
        'design-new.search-format': 'Format',
        'design-new.search-format-placeholder': 'Search format...',
        'design-new.search-plant': 'Plant',
        'design-new.search-paperboard': 'Paperboard Type',
        'design-new.search-status': 'Status',
        'design-new.all': 'All',
        'design-new.search': 'Search',
        'design-new.reset': 'Reset',
        'design-new.design-code-col': 'Design Code',
        'design-new.format-col': 'Format',
        'design-new.plant-col': 'Plant',
        'design-new.paperboard-col': 'Paperboard Type',
        'design-new.status-col': 'Status',
        'design-new.action-col': 'Action',
        'design-new.view-images': 'View Images',
        'design-new.no-artworks': 'No Artwork Records',
        'design-new.status-in-production': 'In Production',
        'design-new.status-completed': 'Completed',
        'design-new.status-pending': 'Pending Confirmation',
        'design-new.status-confirmed': 'Confirmed',
        'design-new.total-files': 'Total Files:',
        'design-new.total-size': 'Total Size:',
        'design-new.alert-upload-required': 'Please upload at least one file or enter a file link',
        'design-new.alert-files-submitted': 'Files submitted! LamiPak has received your files and is processing...',
        'design-new.alert-info-submitted': 'Confirmation information submitted!',
        'design-new.confirm-version-title': 'Confirm marking this artwork version as confirmed? It will enter the production process after confirmation.',
        'design-new.alert-version-confirmed': 'Artwork version confirmed! Production process started.',
        'design-new.alert-select-shipping': 'Please select to ship samples first',
        'design-new.alert-recipient-name-required': 'Please enter recipient name',
        'design-new.alert-recipient-address-required': 'Please enter recipient address',
        'design-new.alert-recipient-info-saved': 'Recipient information saved!',
        
        // Common
        'common.loading': 'Loading...',
        'common.confirm': 'Confirm',
        'common.delete': 'Delete',
        'common.edit': 'Edit',
        'common.save': 'Save',
        'common.cancel': 'Cancel',
        'common.close': 'Close',
        'common.submit': 'Submit',
        'common.search': 'Search',
        'common.view': 'View',
        'common.delete-confirm': 'Are you sure you want to delete this item?',
        'common.clear-cart-confirm': 'Are you sure you want to clear the cart?',
        'common.added-to-cart': 'Item added to cart successfully!',
        'common.select-design-first': 'Please select a product design first',
        'common.no-products': 'No products found matching your criteria',
        'common.spec': 'Specification:',
        'common.products': 'products',
        'common.items': 'items',
        
        // Footer
        'footer.company-name': 'LamiPak',
        'footer.description': 'Customer self-service ordering platform · Online order configuration, artwork management, logistics tracking, one-stop packaging procurement experience.',
        'footer.quick-links': 'Quick Links',
        'footer.contact': 'Contact',
        'footer.address': 'No. 369, Xinnan West Road, Kunshan',
        'footer.business-hours': 'Monday to Friday 9:00-18:00 (GMT+8)',
        'footer.services': 'Platform Services',
        'footer.service-online': 'Online Product Selection & Configuration',
        'footer.service-artwork': 'Artwork Upload & Management',
        'footer.service-tracking': 'Order Tracking & Reconciliation',
        'footer.service-query': '7×24 Self-Service Inquiry',
        'footer.copyright': '© 2025 LamiPak Materials Co., Ltd. · Customer Self-Service Ordering Platform',
        'footer.terms': 'Terms of Use',
        'footer.privacy': 'Privacy Policy',
      }
    };
    
    // 当前语言，默认中文
    let currentLanguage = localStorage.getItem('language') || 'zh';
    
    // 翻译函数
    function t(key) {
      return translations[currentLanguage][key] || translations['zh'][key] || key;
    }
    
    // 更新页面翻译
    function updateTranslations() {
      // 更新所有带有data-i18n属性的元素
      document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = t(key);
        
        // 如果是input或textarea的placeholder
        if ((element.tagName === 'INPUT' && element.type !== 'submit' && element.type !== 'button') || element.tagName === 'TEXTAREA') {
          element.placeholder = translation;
        }
        // 如果是option元素
        else if (element.tagName === 'OPTION') {
          element.textContent = translation;
        }
        // 如果是a标签
        else if (element.tagName === 'A') {
          element.textContent = translation;
        }
        // 如果是th或td标签
        else if (element.tagName === 'TH' || element.tagName === 'TD') {
          element.textContent = translation;
        }
        // 如果是th或td标签
        else if (element.tagName === 'TH' || element.tagName === 'TD') {
          element.textContent = translation;
        }
        // 如果是span或其他内联元素，直接更新文本
        else if (element.tagName === 'SPAN' || element.tagName === 'DIV' || element.tagName === 'P' || element.tagName === 'H1' || element.tagName === 'H2' || element.tagName === 'H3' || element.tagName === 'H4' || element.tagName === 'H5' || element.tagName === 'H6' || element.tagName === 'LABEL') {
          // 如果有子元素是图标，保留图标
          const icons = element.querySelectorAll('.iconify');
          if (icons.length > 0) {
            // 找到所有文本节点
            const textNodes = Array.from(element.childNodes).filter(node => 
              node.nodeType === Node.TEXT_NODE && node.textContent.trim()
            );
            // 更新第一个文本节点
            if (textNodes.length > 0) {
              textNodes[0].textContent = ' ' + translation;
            } else {
              // 如果没有文本节点，在最后一个图标后添加
              const lastIcon = icons[icons.length - 1];
              lastIcon.after(' ' + translation);
            }
          } else {
            element.textContent = translation;
          }
        }
        // 如果是button或submit类型的input
        else if (element.tagName === 'BUTTON' || element.type === 'submit' || element.type === 'button') {
          // 保留图标，只更新文字
          const icons = element.querySelectorAll('.iconify');
          if (icons.length > 0) {
            // 有图标的情况，找到所有文本节点并更新
            const textNodes = Array.from(element.childNodes).filter(node => 
              node.nodeType === Node.TEXT_NODE
            );
            // 移除所有文本节点
            textNodes.forEach(node => node.remove());
            // 在最后一个图标后添加翻译文本
            const lastIcon = icons[icons.length - 1];
            if (lastIcon.nextSibling && lastIcon.nextSibling.nodeType === Node.TEXT_NODE) {
              lastIcon.nextSibling.textContent = ' ' + translation;
            } else {
              lastIcon.after(' ' + translation);
            }
          } else {
            element.textContent = translation;
          }
        }
        // 其他情况直接更新文本内容
        else {
          element.textContent = translation;
        }
      });
      
      // 更新title属性
      document.querySelectorAll('[data-i18n-title]').forEach(element => {
        const key = element.getAttribute('data-i18n-title');
        element.title = t(key);
      });
      
      // 更新alt属性
      document.querySelectorAll('[data-i18n-alt]').forEach(element => {
        const key = element.getAttribute('data-i18n-alt');
        element.alt = t(key);
      });
      
      // 更新语言选择器的值
      const languageSelect = document.getElementById('languageSelect');
      if (languageSelect) {
        languageSelect.value = currentLanguage;
      }
      
      // 保存语言设置
      localStorage.setItem('language', currentLanguage);
    }
    
    // 切换语言
    function changeLanguage(lang) {
      if (translations[lang]) {
        currentLanguage = lang;
        updateTranslations();
        // 重新渲染动态内容
        const artworksList = document.getElementById('design-new-artworks-list');
        if (artworksList && !artworksList.classList.contains('hidden')) {
          renderArtworksList();
        }
        // 重新渲染阶段3的评论和更新只读字段显示
        const stage3View = document.getElementById('design-new-stage-3');
        if (stage3View && !stage3View.classList.contains('hidden')) {
          renderStage3Comments();
          // 更新 Print Plant 显示值
          const printPlantDisplay = document.getElementById('stage3-printPlant-display');
          const printPlantHidden = document.getElementById('stage3-printPlant');
          if (printPlantDisplay && printPlantHidden) {
            const plantValue = printPlantHidden.value;
            const plantText = plantValue === '昆山工厂' ? t('design-new.plant-kunshan') : t('design-new.plant-indonesia');
            const spanElement = printPlantDisplay.querySelector('span:last-child');
            if (spanElement) {
              spanElement.textContent = plantText;
            }
          }
        }
        // 重新渲染订单详情中的SKU表格（如果订单详情页面可见）
        const orderDetailContent = document.getElementById('orderDetailContent');
        if (orderDetailContent && !orderDetailContent.classList.contains('hidden')) {
          // 检查是否有SKU数据需要重新渲染
          const skuTableBody = document.getElementById('skuTableBody');
          if (skuTableBody && skuTableBody.children.length > 0) {
            // 如果有SKU表格，重新渲染它
            // 注意：这里需要访问全局的 orderSKUData，如果不存在则跳过
            if (typeof orderSKUData !== 'undefined' && orderSKUData) {
              renderSKUTable(orderSKUData);
            }
          }
        }
        // 重新渲染订单配置工具中的产品列表（如果订单配置页面可见）
        const configuratorTab = document.getElementById('configurator');
        if (configuratorTab && configuratorTab.classList.contains('tab-active')) {
          if (typeof filterAndDisplayProducts === 'function') {
            filterAndDisplayProducts();
          }
        }
        // 重新渲染购物车（如果购物车页面可见）
        const cartTab = document.getElementById('cart');
        if (cartTab && cartTab.classList.contains('tab-active')) {
          if (typeof renderCart === 'function') {
            renderCart();
          }
        }
      }
    }
    
    // 初始化翻译
    document.addEventListener('DOMContentLoaded', () => {
      updateTranslations();
      
      // 绑定语言选择器事件
      const languageSelect = document.getElementById('languageSelect');
      if (languageSelect) {
        languageSelect.addEventListener('change', (e) => {
          changeLanguage(e.target.value);
        });
      }
    });
    
    // ==================== 翻译系统结束 ====================
    
    // 存储选中的设计图片URL
    let selectedDesignImage = null;
    
    // 图片搜索功能
    (function() {
      const imageSearchBtn = document.getElementById('imageSearchBtn');
      const imagePasteArea = document.getElementById('imagePasteArea');
      const closeImagePasteArea = document.getElementById('closeImagePasteArea');
      const pasteImageContainer = document.getElementById('pasteImageContainer');
      const pasteImagePlaceholder = document.getElementById('pasteImagePlaceholder');
      const pastedImagePreview = document.getElementById('pastedImagePreview');
      const imageSearchActions = document.getElementById('imageSearchActions');
      const searchByImageBtn = document.getElementById('searchByImageBtn');
      const clearImageBtn = document.getElementById('clearImageBtn');
      let pastedImageFile = null;
      
      // 点击相机图标显示/隐藏图片粘贴区域
      if (imageSearchBtn && imagePasteArea) {
        imageSearchBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          imagePasteArea.classList.toggle('hidden');
        });
        
        // 点击关闭按钮
        if (closeImagePasteArea) {
          closeImagePasteArea.addEventListener('click', () => {
            imagePasteArea.classList.add('hidden');
          });
        }
        
        // 点击外部区域关闭
        document.addEventListener('click', (e) => {
          if (!imagePasteArea.contains(e.target) && !imageSearchBtn.contains(e.target)) {
            imagePasteArea.classList.add('hidden');
          }
        });
      }
      
      // 粘贴图片功能
      if (pasteImageContainer) {
        // 监听粘贴事件
        document.addEventListener('paste', (e) => {
          if (!imagePasteArea.classList.contains('hidden')) {
            const items = e.clipboardData.items;
            for (let i = 0; i < items.length; i++) {
              if (items[i].type.indexOf('image') !== -1) {
                const blob = items[i].getAsFile();
                handleImageFile(blob);
                e.preventDefault();
                break;
              }
            }
          }
        });
        
        // 拖拽图片功能
        pasteImageContainer.addEventListener('dragover', (e) => {
          e.preventDefault();
          pasteImageContainer.classList.add('border-blue-500', 'bg-blue-50');
        });
        
        pasteImageContainer.addEventListener('dragleave', (e) => {
          e.preventDefault();
          pasteImageContainer.classList.remove('border-blue-500', 'bg-blue-50');
        });
        
        pasteImageContainer.addEventListener('drop', (e) => {
          e.preventDefault();
          pasteImageContainer.classList.remove('border-blue-500', 'bg-blue-50');
          
          const files = e.dataTransfer.files;
          if (files.length > 0 && files[0].type.startsWith('image/')) {
            handleImageFile(files[0]);
          }
        });
        
        // 点击区域选择文件
        pasteImageContainer.addEventListener('click', () => {
          const input = document.createElement('input');
          input.type = 'file';
          input.accept = 'image/*';
          input.onchange = (e) => {
            if (e.target.files.length > 0) {
              handleImageFile(e.target.files[0]);
            }
          };
          input.click();
        });
      }
      
      // 处理图片文件
      function handleImageFile(file) {
        if (!file.type.startsWith('image/')) {
          alert('请选择图片文件');
          return;
        }
        
        pastedImageFile = file;
        
        const reader = new FileReader();
        reader.onload = (e) => {
          pastedImagePreview.src = e.target.result;
          pastedImagePreview.classList.remove('hidden');
          pasteImagePlaceholder.classList.add('hidden');
          imageSearchActions.classList.remove('hidden');
        };
        reader.readAsDataURL(file);
      }
      
      // 搜索相似图片
      if (searchByImageBtn) {
        searchByImageBtn.addEventListener('click', () => {
          if (pastedImageFile) {
            // 这里可以调用后台API进行图片搜索
            // 例如：uploadImageAndSearch(pastedImageFile);
            console.log('搜索相似图片', pastedImageFile);
            alert(t('nav.searching-images'));
            // 实际实现时，可以发送图片到后台，然后显示搜索结果
          }
        });
      }
      
      // 清除图片
      if (clearImageBtn) {
        clearImageBtn.addEventListener('click', () => {
          pastedImageFile = null;
          pastedImagePreview.src = '';
          pastedImagePreview.classList.add('hidden');
          pasteImagePlaceholder.classList.remove('hidden');
          imageSearchActions.classList.add('hidden');
        });
      }
    })();
    
    // 产品数据（包含规格信息）
    const productsData = [
      {
        id: 1,
        name: "饮料包装设计 #DRK-2023",
        description: "适用于果汁和碳酸饮料的防渗透包装",
        image: "customer_designs/Unikai/UNIKAI-1.jpg",
        format: "200S",
        machine: "Tetra Pak A3",
        filling: "果汁",
        material: "PE-Al-Paper",
        productGroup: "10-无菌包",
        series: "片材",
        certifications: ["PEFC", "FSC"]
      },
      {
        id: 2,
        name: "乳品包装设计 #DARY-2024",
        description: "长效保鲜的乳制品无菌包装方案",
        image: "customer_designs/Unikai/UNIKAI-4.jpg",
        format: "LBA1000B",
        machine: "SIG CFA122",
        filling: "乳制品",
        material: "PET-Paper",
        productGroup: "10-无菌包",
        series: "片材",
        certifications: ["FSC"]
      },
      {
        id: 3,
        name: "定制礼盒 #GIFT-001",
        description: "高端商务礼品包装解决方案",
        image: "customer_designs/Unikai/UNIKAI-9.jpg",
        format: "1000B",
        machine: "乐美 LP200",
        filling: "汤类",
        material: "Paper",
        productGroup: "30-定制包",
        series: "盖子",
        certifications: ["PEFC"]
      },
      {
        id: 4,
        name: "牛奶包装设计 #MILK-2024",
        description: "UHT牛奶专用包装设计",
        image: "customer_designs/RFG/RFG-1.jpg",
        format: "200S",
        machine: "Tetra Pak A3",
        filling: "UHT牛奶",
        material: "PE-Al-Paper",
        productGroup: "10-无菌包",
        series: "片材",
        certifications: ["PEFC", "FSC"]
      },
      {
        id: 5,
        name: "豆奶包装设计 #SOY-2023",
        description: "豆奶专用无菌包装",
        image: "customer_designs/RFG/RFG-2.jpg",
        format: "LBA100B-H",
        machine: "SIG CFA122",
        filling: "豆奶",
        material: "PET-Paper",
        productGroup: "20-标准包",
        series: "卷材",
        certifications: []
      },
      {
        id: 6,
        name: "果汁包装设计 #JUICE-2024",
        description: "新鲜果汁包装方案",
        image: "customer_designs/RFG/RFG-3.jpg",
        format: "200S",
        machine: "Tetra Pak A3",
        filling: "果汁",
        material: "PE-Al-Paper",
        productGroup: "10-无菌包",
        series: "片材",
        certifications: ["FSC"]
      }
    ];
    
    // 筛选和显示产品
    function filterAndDisplayProducts() {
      const format = document.getElementById('filter-format')?.value || '';
      const machine = document.getElementById('filter-machine')?.value || '';
      const filling = document.getElementById('filter-filling')?.value || '';
      const material = document.getElementById('filter-material')?.value || '';
      const productGroup = document.getElementById('filter-product-group')?.value || '';
      const series = document.getElementById('filter-series')?.value || '';
      const pefc = document.getElementById('filter-pefc')?.checked || false;
      const fsc = document.getElementById('filter-fsc')?.checked || false;
      const search = document.getElementById('filter-search')?.value.toLowerCase() || '';
      
      // 筛选产品
      let filteredProducts = productsData.filter(product => {
        // 规格筛选
        if (format && !product.format.includes(format)) return false;
        // 灌装机型号筛选
        if (machine && product.machine !== machine) return false;
        // 填充物类型筛选
        if (filling && product.filling !== filling) return false;
        // 材料结构筛选
        if (material && product.material !== material) return false;
        // 产品组筛选
        if (productGroup && product.productGroup !== productGroup) return false;
        // 系列筛选
        if (series && product.series !== series) return false;
        // 认证要求筛选
        if (pefc && !product.certifications.includes('PEFC')) return false;
        if (fsc && !product.certifications.includes('FSC')) return false;
        // 搜索筛选
        if (search && !product.name.toLowerCase().includes(search) && 
            !product.description.toLowerCase().includes(search)) return false;
        return true;
      });
      
      // 按规格分组
      const groupedByFormat = {};
      filteredProducts.forEach(product => {
        if (!groupedByFormat[product.format]) {
          groupedByFormat[product.format] = [];
        }
        groupedByFormat[product.format].push(product);
      });
      
      // 渲染产品
      const container = document.getElementById('products-container');
      if (!container) return;
      
      if (Object.keys(groupedByFormat).length === 0) {
        container.innerHTML = `<div class="text-center py-12 text-gray-500">${t('common.no-products')}</div>`;
        return;
      }
      
      let html = '';
      Object.keys(groupedByFormat).sort().forEach(format => {
        html += `
          <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
            <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
              <span class="iconify text-blue-600 mr-2" data-icon="mdi:package-variant"></span>
              ${t('common.spec')} ${format}
              <span class="ml-2 text-sm font-normal text-gray-500">(${groupedByFormat[format].length} ${t('common.products')})</span>
            </h4>
            <div class="grid grid-cols-2 gap-4">
        `;
        
        groupedByFormat[format].forEach(product => {
          html += `
            <div class="bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition">
              <img alt="${product.name}" class="w-full h-32 object-cover" src="${product.image}"/>
              <div class="p-4">
                <h5 class="font-semibold text-gray-800 mb-2">${product.name}</h5>
                <p class="text-gray-600 text-sm mb-3">${product.description}</p>
                <div class="text-xs text-gray-500 mb-3 space-y-1">
                  <div>${t('config.filter-product-group')}: ${product.productGroup}</div>
                  <div>${t('config.filter-series')}: ${product.series}</div>
                  <div>${t('config.filter-machine')}: ${product.machine}</div>
                  <div>${t('config.filter-filling')}: ${product.filling}</div>
                  <div>${t('config.filter-material')}: ${product.material}</div>
                </div>
                <button class="select-design-btn w-full bg-blue-600 hover:bg-blue-500 text-white py-2 rounded-lg transition" 
                        data-image-src="${product.image}" 
                        data-product-id="${product.id}"
                        data-i18n="config.select-design">
                  ${t('config.select-design')}
                </button>
              </div>
            </div>
          `;
        });
        
        html += `
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
      
      // 重新绑定选择设计按钮事件
      document.querySelectorAll('.select-design-btn').forEach(button => {
        button.addEventListener('click', () => {
          selectedDesignImage = button.dataset.imageSrc;
          
          // 移除其他按钮的选中状态
          document.querySelectorAll('.select-design-btn').forEach(btn => {
            btn.classList.remove('bg-green-600');
            btn.classList.add('bg-blue-600');
          });
          
          // 高亮当前选中的按钮
          button.classList.remove('bg-blue-600');
          button.classList.add('bg-green-600');
        });
      });
    }
    
    // 初始化产品显示
    filterAndDisplayProducts();
    
    // 绑定筛选事件
    document.querySelectorAll('.filter-select, .filter-input, .filter-checkbox').forEach(element => {
      element.addEventListener('change', filterAndDisplayProducts);
      element.addEventListener('input', filterAndDisplayProducts);
    });
    
    // 确认下单函数 - 跳转到我的订单页面
    function confirmOrder() {
      // 切换到"我的订单"标签页
      const ordersTabBtn = document.querySelector('.tab-btn[data-tab="orders"]');
      const ordersSection = document.getElementById('orders');
      const ordersList = document.getElementById('ordersList');
      const orderDetail = document.getElementById('orderDetail');
      const complaintPage = document.getElementById('complaintPage');
      
      // 移除所有标签页按钮的激活状态
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('bg-blue-700'));
      // 移除所有标签页内容的激活状态
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('tab-active'));
      
      // 激活"我的订单"标签页
      ordersTabBtn.classList.add('bg-blue-700');
      ordersSection.classList.add('tab-active');
      
      // 确保显示订单列表，隐藏订单详情和客诉页面
      if (ordersList) ordersList.classList.remove('hidden');
      if (orderDetail) orderDetail.classList.add('hidden');
      if (complaintPage) complaintPage.classList.add('hidden');
    }
    
    // 购物车数据结构
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    // 更新购物车数量显示
    function updateCartCount() {
      const cartCount = document.getElementById('cartCount');
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      if (cartCount) {
        if (totalItems > 0) {
          cartCount.textContent = totalItems;
          cartCount.classList.remove('hidden');
        } else {
          cartCount.classList.add('hidden');
        }
      }
    }
    
    // 保存购物车到本地存储
    function saveCart() {
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartCount();
      renderCart();
    }
    
    // 添加商品到购物车
    function addToCart(productData) {
      // 如果没有传入productData，尝试从当前页面获取
      if (!productData) {
        // 从下单页面获取商品信息
        const productNameEl = document.getElementById('orderProductName');
        const materialNumberEl = document.getElementById('orderMaterialNumber');
        const formatEl = document.getElementById('orderFormat');
        const materialEl = document.getElementById('orderMaterial');
        const quantityEl = document.getElementById('orderQuantity');
        
        if (!productNameEl) {
          alert(t('common.select-design-first'));
          return;
        }
        
        const productName = productNameEl.textContent || '未命名商品';
        const materialNumber = materialNumberEl?.textContent || '';
        const format = formatEl?.textContent || '未分类';
        const material = materialEl?.textContent || '';
        const quantity = parseInt(quantityEl?.value) || 1;
        const price = 49.00; // 默认价格，实际应该从页面获取
        
        productData = {
          id: Date.now(),
          name: productName,
          materialNumber: materialNumber,
          image: selectedDesignImage || document.getElementById('mainProductImg')?.src || 'customer_designs/RFG/RFG-1.jpg',
          format: format,
          quantity: quantity,
          price: price,
          material: material,
          machine: 'Tetra Pak A3',
          filling: 'UHT牛奶'
        };
      }
      
      // 检查购物车中是否已有相同商品
      const existingItem = cart.find(item => 
        item.id === productData.id && 
        item.format === productData.format
      );
      
      if (existingItem) {
        existingItem.quantity += productData.quantity || 1;
      } else {
        cart.push({
          ...productData,
          quantity: productData.quantity || 1
        });
      }
      
      saveCart();
      alert(t('common.added-to-cart'));
    }
    
    // 从购物车移除商品
    function removeFromCart(itemId) {
      cart = cart.filter(item => item.id !== itemId);
      saveCart();
    }
    
    // 更新购物车商品数量
    function updateCartItemQuantity(itemId, quantity) {
      const item = cart.find(item => item.id === itemId);
      if (item) {
        if (quantity <= 0) {
          removeFromCart(itemId);
        } else {
          item.quantity = quantity;
          saveCart();
        }
      }
    }
    
    // 渲染购物车
    function renderCart() {
      const cartContainer = document.getElementById('cartContainer');
      const cartActions = document.getElementById('cartActions');
      const cartTotalItems = document.getElementById('cartTotalItems');
      const cartTotalPrice = document.getElementById('cartTotalPrice');
      
      if (!cartContainer) return;
      
      if (cart.length === 0) {
        cartContainer.innerHTML = `<div class="text-center py-12 text-gray-500">${t('cart.empty')}</div>`;
        if (cartActions) cartActions.classList.add('hidden');
        if (cartTotalItems) cartTotalItems.textContent = '0';
        if (cartTotalPrice) cartTotalPrice.textContent = '0.00';
        return;
      }
      
      // 按规格分组
      const groupedByFormat = {};
      cart.forEach(item => {
        const format = item.format || t('cart.uncategorized');
        if (!groupedByFormat[format]) {
          groupedByFormat[format] = [];
        }
        groupedByFormat[format].push(item);
      });
      
      // 计算总金额
      const totalPrice = cart.reduce((sum, item) => sum + (item.price || 0) * item.quantity, 0);
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      
      if (cartTotalItems) cartTotalItems.textContent = totalItems;
      if (cartTotalPrice) cartTotalPrice.textContent = totalPrice.toFixed(2);
      if (cartActions) cartActions.classList.remove('hidden');
      
      // 渲染商品列表
      let html = '';
      Object.keys(groupedByFormat).sort().forEach(format => {
        html += `
          <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
            <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
              <span class="iconify text-blue-600 mr-2" data-icon="mdi:package-variant"></span>
              ${t('common.spec')} ${format}
              <span class="ml-2 text-sm font-normal text-gray-500">(${groupedByFormat[format].length} ${t('cart.items-count')})</span>
            </h4>
            <div class="space-y-4">
        `;
        
        groupedByFormat[format].forEach(item => {
          const itemTotal = (item.price || 0) * item.quantity;
          html += `
            <div class="bg-gray-50 rounded-lg border border-gray-200 p-4 flex items-center gap-4">
              <img src="${item.image || 'customer_designs/RFG/RFG-1.jpg'}" alt="${item.name}" class="w-24 h-24 object-cover rounded-lg flex-shrink-0"/>
              <div class="flex-1">
                <h5 class="font-semibold text-gray-800 mb-1">${item.name}</h5>
                <div class="text-xs text-gray-500 space-y-1">
                  ${item.material ? `<div>${t('cart.material')}: ${item.material}</div>` : ''}
                  ${item.machine ? `<div>${t('cart.machine')}: ${item.machine}</div>` : ''}
                  ${item.filling ? `<div>${t('cart.filling')}: ${translateDataValue(item.filling, 'filling')}</div>` : ''}
                </div>
              </div>
              <div class="flex items-center space-x-4">
                <div class="text-right">
                  <div class="text-sm text-gray-600 mb-2">${t('order-detail.unit-price')}: ¥${(item.price || 0).toFixed(2)}</div>
                  <div class="font-semibold text-green-600">${t('order-detail.subtotal')}: ¥${itemTotal.toFixed(2)}</div>
                </div>
                <div class="flex items-center space-x-2">
                  <button class="update-quantity-btn bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded" data-item-id="${item.id}" data-action="decrease">-</button>
                  <input type="number" class="quantity-input w-16 text-center border border-gray-300 rounded py-1" value="${item.quantity}" min="1" data-item-id="${item.id}"/>
                  <button class="update-quantity-btn bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded" data-item-id="${item.id}" data-action="increase">+</button>
                </div>
                <button class="remove-item-btn text-red-500 hover:text-red-700 px-3 py-1" data-item-id="${item.id}" title="${t('cart.remove-item')}">
                  <span class="iconify" data-icon="mdi:delete"></span>
                </button>
              </div>
            </div>
          `;
        });
        
        html += `
            </div>
          </div>
        `;
      });
      
      cartContainer.innerHTML = html;
      
      // 绑定事件
      document.querySelectorAll('.update-quantity-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const itemId = parseInt(btn.dataset.itemId);
          const action = btn.dataset.action;
          const input = document.querySelector(`.quantity-input[data-item-id="${itemId}"]`);
          let quantity = parseInt(input.value) || 1;
          
          if (action === 'increase') {
            quantity += 1;
          } else if (action === 'decrease') {
            quantity = Math.max(1, quantity - 1);
          }
          
          input.value = quantity;
          updateCartItemQuantity(itemId, quantity);
        });
      });
      
      document.querySelectorAll('.quantity-input').forEach(input => {
        input.addEventListener('change', () => {
          const itemId = parseInt(input.dataset.itemId);
          const quantity = parseInt(input.value) || 1;
          updateCartItemQuantity(itemId, quantity);
        });
      });
      
      document.querySelectorAll('.remove-item-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const itemId = parseInt(btn.dataset.itemId);
          if (confirm(t('common.delete-confirm'))) {
            removeFromCart(itemId);
          }
        });
      });
      
      // 绑定清空购物车按钮
      const clearCartBtn = document.querySelector('#cartActions button.bg-gray-300');
      if (clearCartBtn) {
        clearCartBtn.onclick = () => {
          if (confirm(t('common.clear-cart-confirm'))) {
            cart = [];
            saveCart();
          }
        };
      }
    }
    
    // 初始化购物车
    updateCartCount();
    
    // 数量增减函数
    function increaseQuantity() {
      const quantityEl = document.getElementById('orderQuantity');
      if (quantityEl) {
        quantityEl.value = parseInt(quantityEl.value || 1) + 1;
      }
    }
    
    function decreaseQuantity() {
      const quantityEl = document.getElementById('orderQuantity');
      if (quantityEl) {
        const current = parseInt(quantityEl.value || 1);
        quantityEl.value = Math.max(1, current - 1);
      }
    }
    
    // 购物车按钮点击事件
    const cartBtn = document.getElementById('cartBtn');
    if (cartBtn) {
      cartBtn.addEventListener('click', () => {
        // 直接显示购物车section
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('tab-active'));
        const cartSection = document.getElementById('cart');
        if (cartSection) {
          cartSection.classList.add('tab-active');
        }
        renderCart();
      });
    }
    
    // 标签页切换功能
    document.querySelectorAll('.tab-btn').forEach(button => {
      button.addEventListener('click', () => {
        // 移除所有激活状态
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('bg-blue-700'));
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('tab-active'));
        
        // 添加当前激活状态
        button.classList.add('bg-blue-700');
        document.getElementById(button.dataset.tab).classList.add('tab-active');
      });
    });
    
    // 页脚快捷入口 - 点击切换 tab
    document.querySelectorAll('.tab-btn-footer').forEach(btn => {
      btn.addEventListener('click', () => {
        const tab = btn.dataset.tab;
        if (!tab) return;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('bg-blue-700'));
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('tab-active'));
        const navBtn = document.querySelector(`.tab-btn[data-tab="${tab}"]`);
        const content = document.getElementById(tab);
        if (navBtn) navBtn.classList.add('bg-blue-700');
        if (content) content.classList.add('tab-active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    });
    
    // ==================== 画稿管理（新）模块 - 阶段式流程 ====================
    const DESIGN_NEW_STORAGE_KEY = 'design_new_artworks';
    let currentStage = 1;
    
    function getDesignNewArtworks() {
      try {
        return JSON.parse(localStorage.getItem(DESIGN_NEW_STORAGE_KEY) || '[]');
      } catch {
        return [];
      }
    }
    
    function saveDesignNewArtworks(list) {
      localStorage.setItem(DESIGN_NEW_STORAGE_KEY, JSON.stringify(list));
    }
    
    function generateDesignCode() {
      const t = Date.now().toString(36).toUpperCase();
      const r = Math.random().toString(36).slice(2, 6).toUpperCase();
      return `DC-${t}-${r}`;
    }
    
    // 获取所有视图元素
    const stageOverview = document.getElementById('design-new-stage-overview');
    const stage1 = document.getElementById('design-new-stage-1');
    const stage2 = document.getElementById('design-new-stage-2');
    const stage3 = document.getElementById('design-new-stage-3');
    const stage4 = document.getElementById('design-new-stage-4');
    const artworksList = document.getElementById('design-new-artworks-list');
    const allViews = [stageOverview, stage1, stage2, stage3, stage4, artworksList];
    
    function showStageView(stageNum) {
      allViews.forEach((v, i) => {
        if (v) v.classList.toggle('hidden', i !== stageNum);
      });
      // stageNum 0 是概览，不应该改变 currentStage
      // currentStage 表示当前可访问的最高阶段
      if (stageNum > 0 && stageNum <= 4) {
        // 如果进入某个阶段，确保 currentStage 至少等于该阶段
        if (stageNum > currentStage) {
          currentStage = stageNum;
        }
        updateStageCards();
      }
      // stageNum 5 是画稿列表视图，不需要更新 currentStage
      if (stageNum === 5) {
        renderArtworksList();
      }
    }
    
    function updateStageCards() {
      document.querySelectorAll('.stage-card').forEach((card, i) => {
        const stageNum = i + 1;
        const badge = card.querySelector('.text-xs.font-semibold');
        const icon = card.querySelector('.iconify');
        const title = card.querySelector('h4');
        const desc = card.querySelector('p');
        
        if (stageNum <= currentStage) {
          card.classList.remove('border-gray-200', 'bg-gray-50', 'opacity-60');
          card.classList.add('border-blue-200', 'bg-blue-50');
          if (badge) {
            badge.classList.remove('text-gray-600', 'bg-gray-200');
            badge.classList.add('text-blue-700', 'bg-blue-200');
          }
          if (icon) {
            icon.classList.remove('text-gray-500');
            icon.classList.add('text-blue-600');
          }
          if (title) {
            title.classList.remove('text-gray-700');
            title.classList.add('text-gray-800');
          }
          if (desc) {
            desc.classList.remove('text-gray-500');
            desc.classList.add('text-gray-600');
          }
        } else {
          card.classList.remove('border-blue-200', 'bg-blue-50');
          card.classList.add('border-gray-200', 'bg-gray-50', 'opacity-60');
          if (badge) {
            badge.classList.remove('text-blue-700', 'bg-blue-200');
            badge.classList.add('text-gray-600', 'bg-gray-200');
          }
          if (icon) {
            icon.classList.remove('text-blue-600');
            icon.classList.add('text-gray-500');
          }
          if (title) {
            title.classList.remove('text-gray-800');
            title.classList.add('text-gray-700');
          }
          if (desc) {
            desc.classList.remove('text-gray-600');
            desc.classList.add('text-gray-500');
          }
        }
      });
    }
    
    // 阶段卡片点击事件（所有阶段都可直接进入）
    document.querySelectorAll('.stage-card').forEach((card, i) => {
      card.addEventListener('click', () => {
        const stageNum = i + 1;
        showStageView(stageNum);
      });
    });
    
    // 查看现有画稿卡片点击事件
    const viewArtworksCard = document.querySelector('.view-artworks-card');
    if (viewArtworksCard) {
      viewArtworksCard.addEventListener('click', () => {
        showStageView(5); // 5 是画稿列表视图的索引 (allViews[5] = artworksList)
      });
    }
    
    // 返回概览按钮
    document.querySelectorAll('.back-to-overview-btn').forEach(btn => {
      btn.addEventListener('click', () => showStageView(0));
    });
    
    // 阶段1：文件上传
    const previewUploadNew = document.getElementById('preview-upload-new');
    const previewFileInputNew = document.getElementById('preview-file-input-new');
    const originalUploadNew = document.getElementById('original-upload-new');
    const originalFileInputNew = document.getElementById('original-file-input-new');
    const stage1NextBtn = document.getElementById('stage1-next-btn');
    const stage2NextBtn = document.getElementById('stage2-next-btn');
    const stage3NextBtn = document.getElementById('stage3-next-btn');
    const fileLinkInput = document.getElementById('file-link-input');
    
    if (previewUploadNew && previewFileInputNew) {
      previewUploadNew.addEventListener('click', () => previewFileInputNew.click());
      previewFileInputNew.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          const container = document.getElementById('preview-container-new');
          const img = document.getElementById('preview-image-new');
          const filename = document.getElementById('preview-filename-new');
          const size = document.getElementById('preview-size-new');
          if (container && img && filename && size) {
            const reader = new FileReader();
            reader.onload = (ev) => {
              img.src = ev.target.result;
              container.classList.remove('hidden');
            };
            reader.readAsDataURL(file);
            filename.textContent = file.name;
            size.textContent = (file.size / 1024 / 1024).toFixed(2) + 'MB';
          }
        }
      });
    }
    
    if (originalUploadNew && originalFileInputNew) {
      originalUploadNew.addEventListener('click', () => originalFileInputNew.click());
      originalFileInputNew.addEventListener('change', (e) => {
        const files = Array.from(e.target.files);
        if (files.length > 0) {
          const container = document.getElementById('original-info-container-new');
          const list = document.getElementById('original-files-list-new');
          const count = document.getElementById('original-file-count-new');
          const totalSize = document.getElementById('original-total-size-new');
          if (container && list && count && totalSize) {
            list.innerHTML = files.map(f => `
<div class="flex items-center justify-between text-sm">
<span class="text-gray-700">${f.name}</span>
<span class="text-gray-500">${(f.size / 1024 / 1024).toFixed(2)}MB</span>
</div>
`).join('');
            const total = files.reduce((sum, f) => sum + f.size, 0);
            count.textContent = files.length;
            totalSize.textContent = total < 1024 * 1024 ? (total / 1024).toFixed(2) + 'KB' : (total / 1024 / 1024).toFixed(2) + 'MB';
            container.classList.remove('hidden');
          }
        }
      });
    }
    
    // Stage1 下一步按钮
    if (stage1NextBtn) {
      stage1NextBtn.addEventListener('click', () => {
        // 不需要验证，直接进入下一阶段
        currentStage = 2;
        updateStageCards();
        showStageView(2);
      });
    }
    
    // Stage2 下一步按钮
    if (stage2NextBtn) {
      stage2NextBtn.addEventListener('click', () => {
        // 不需要验证，直接进入下一阶段
        currentStage = 3;
        updateStageCards();
        showStageView(3);
      });
    }
    
    // Stage3 下一步按钮
    if (stage3NextBtn) {
      stage3NextBtn.addEventListener('click', () => {
        // 不需要验证，直接进入下一阶段
        currentStage = 4;
        updateStageCards();
        showStageView(4);
      });
    }
    
    // 阶段3：客户确认表单提交
    const stage3Form = document.getElementById('stage3-confirm-form');
    if (stage3Form) {
      stage3Form.addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(stage3Form);
        const data = {
          designCode: document.getElementById('stage3-designCode')?.textContent || generateDesignCode(),
          paperboard: formData.get('paperboard') || '',
          artworkType: formData.get('artworkType') || '',
          colorTarget: formData.get('colorTarget') || '',
          printPlant: formData.get('printPlant') || '',
          productTitle: document.getElementById('stage3-productTitle')?.value || '',
          format: formData.get('format') || '',
          opening: formData.get('opening') || '',
          logo: formData.get('logo') || '',
          multipleStyles: formData.get('stage3-multipleStyles') || '否',
        };
        alert(t('design-new.alert-info-submitted'));
        currentStage = 3;
        showStageView(3);
      });
    }
    
    // 阶段3：画稿沟通和评论
    const STAGE3_COMMENTS_KEY = 'stage3_comments';
    const stage3Image = document.getElementById('stage3-artwork-image');
    const stage3CommentsList = document.getElementById('stage3-comments-list');
    const stage3CommentInput = document.getElementById('stage3-comment-input');
    const stage3SendBtn = document.getElementById('stage3-send-comment-btn');
    const stage3CommentCount = document.getElementById('stage3-comment-count');
    
    // 随机图片列表
    const stage3ImagePool = [
      'customer_designs/OAT/FLOAT-1.jpg',
      'customer_designs/OAT/FLOAT-2.jpg',
      'customer_designs/OAT/FLOAT-3.jpg',
      'customer_designs/RFG/RFG-1.jpg',
      'customer_designs/RFG/RFG-2.jpg',
      'customer_designs/RFG/RFG-3.jpg',
      'customer_designs/Unikai/UNIKAI-1.jpg',
      'customer_designs/Unikai/UNIKAI-2.jpg',
      'customer_designs/Unikai/UNIKAI-3.jpg',
    ];
    
    function getStage3Comments() {
      try {
        return JSON.parse(localStorage.getItem(STAGE3_COMMENTS_KEY) || '[]');
      } catch {
        return [];
      }
    }
    
    function saveStage3Comments(comments) {
      localStorage.setItem(STAGE3_COMMENTS_KEY, JSON.stringify(comments));
    }
    
    function formatTime(date) {
      const d = new Date(date);
      const now = new Date();
      const diffMs = now - d;
      const diffMins = Math.floor(diffMs / 60000);
      const diffHours = Math.floor(diffMs / 3600000);
      const diffDays = Math.floor(diffMs / 86400000);
      
      if (diffMins < 1) return t('design-new.time-just-now');
      if (diffMins < 60) return `${diffMins} ${t('design-new.time-minutes-ago')}`;
      if (diffHours < 24) return `${diffHours} ${t('design-new.time-hours-ago')}`;
      if (diffDays < 7) return `${diffDays} ${t('design-new.time-days-ago')}`;
      const locale = currentLanguage === 'zh' ? 'zh-CN' : 'en-US';
      return d.toLocaleDateString(locale, { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
    }
    
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
    
    function renderStage3Comments() {
      const comments = getStage3Comments();
      if (!stage3CommentsList) return;
      
      if (comments.length === 0) {
        stage3CommentsList.innerHTML = `
<div class="text-center py-12 text-gray-400">
<span class="iconify text-4xl mb-2 inline-block" data-icon="mdi:comment-outline"></span>
<p class="text-sm">${t('design-new.no-comments')}</p>
</div>`;
        if (stage3CommentCount) stage3CommentCount.textContent = t('design-new.comment-count-zero');
        return;
      }
      
      if (stage3CommentCount) {
        const countText = currentLanguage === 'zh' 
          ? `${comments.length} ${t('design-new.comment-count')}`
          : `${comments.length} ${t('design-new.comment-count')}`;
        stage3CommentCount.textContent = countText;
      }
      
      stage3CommentsList.innerHTML = comments.map(c => {
        const isLemi = c.role === 'lemi';
        const bgColor = isLemi ? 'bg-blue-50 border-blue-200' : 'bg-gray-50 border-gray-200';
        const avatarBg = isLemi ? 'bg-blue-600' : 'bg-green-600';
        const flexDir = isLemi ? 'flex-row-reverse' : '';
        const textAlign = isLemi ? 'text-right' : '';
        const justifyAlign = isLemi ? 'justify-end' : '';
        const avatarText = isLemi ? t('design-new.lemi') : t('design-new.customer').charAt(0);
        return `
<div class="flex items-start gap-3 ${flexDir}">
<div class="flex-shrink-0 w-9 h-9 rounded-full ${avatarBg} flex items-center justify-center text-white text-xs font-semibold shadow-sm">
${avatarText}
</div>
<div class="flex-1 ${textAlign}">
<div class="inline-block max-w-[80%]">
<div class="flex items-center gap-2 mb-1.5 ${justifyAlign}">
<span class="text-sm font-semibold text-gray-800">${escapeHtml(c.name)}</span>
<span class="text-xs text-gray-500">${formatTime(c.time)}</span>
</div>
<div class="${bgColor} border rounded-lg px-3 py-2 text-sm text-gray-800 break-words shadow-sm">
${escapeHtml(c.content)}
</div>
</div>
</div>
</div>`;
      }).join('');
      
      // 滚动到底部
      setTimeout(() => {
        stage3CommentsList.scrollTop = stage3CommentsList.scrollHeight;
      }, 100);
    }
    
    // 初始化阶段3：加载随机图片和评论
    const stage3View = document.getElementById('design-new-stage-3');
    let stage3Initialized = false;
    
    function initStage3() {
      if (stage3Initialized) return;
      stage3Initialized = true;
      
      // 随机选择图片
      if (stage3Image) {
        const randomImg = stage3ImagePool[Math.floor(Math.random() * stage3ImagePool.length)];
        stage3Image.src = randomImg;
        stage3Image.onerror = function() {
          this.src = 'customer_designs/RFG/RFG-1.jpg'; // 备用图片
        };
      }
      
      // 如果没有评论，添加一条初始评论
      const comments = getStage3Comments();
      if (comments.length === 0) {
        const initialComment = {
          id: 'c-init',
          role: 'lemi',
          name: t('design-new.lemi-service'),
          content: t('design-new.initial-comment'),
          time: new Date(Date.now() - 3600000).toISOString(), // 1小时前
        };
        comments.push(initialComment);
        saveStage3Comments(comments);
      } else {
        // 如果已有初始评论，更新其翻译（仅更新初始评论）
        const initComment = comments.find(c => c.id === 'c-init');
        if (initComment) {
          initComment.name = t('design-new.lemi-service');
          initComment.content = t('design-new.initial-comment');
          saveStage3Comments(comments);
        }
      }
      
      // 加载评论
      renderStage3Comments();
    }
    
    if (stage3View) {
      const observer = new MutationObserver((mutations) => {
        if (!stage3View.classList.contains('hidden')) {
          initStage3();
        }
      });
      observer.observe(stage3View, { attributes: true, attributeFilter: ['class'] });
      // 如果已经显示，立即初始化
      if (!stage3View.classList.contains('hidden')) {
        initStage3();
      }
    }
    
    // 发送评论
    if (stage3SendBtn && stage3CommentInput) {
      stage3SendBtn.addEventListener('click', () => {
        const text = stage3CommentInput.value.trim();
        if (!text) return;
        
        const comments = getStage3Comments();
        const newComment = {
          id: 'c' + Date.now(),
          role: 'customer', // 客户发送
          name: t('design-new.customer'),
          content: text,
          time: new Date().toISOString(),
        };
        comments.push(newComment);
        saveStage3Comments(comments);
        stage3CommentInput.value = '';
        renderStage3Comments();
        
        // 模拟乐美员工回复（延迟1-2秒）
        setTimeout(() => {
          const lemiReplies = [
            t('design-new.reply-received'),
            t('design-new.reply-recorded'),
            t('design-new.reply-thanks'),
            t('design-new.reply-understood'),
          ];
          const reply = lemiReplies[Math.floor(Math.random() * lemiReplies.length)];
          const comments = getStage3Comments();
          comments.push({
            id: 'c' + Date.now(),
            role: 'lemi',
            name: t('design-new.lemi-service'),
            content: reply,
            time: new Date().toISOString(),
          });
          saveStage3Comments(comments);
          renderStage3Comments();
        }, 1000 + Math.random() * 1000);
      });
      
      stage3CommentInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          stage3SendBtn.click();
        }
      });
    }
    
    // 阶段3：确认版本按钮
    const stage3ConfirmBtn = document.getElementById('stage3-confirm-version-btn');
    if (stage3ConfirmBtn) {
      stage3ConfirmBtn.addEventListener('click', () => {
        if (confirm(t('design-new.confirm-version-title'))) {
          alert(t('design-new.alert-version-confirmed'));
          currentStage = 4;
          showStageView(4);
          updateStageCards();
        }
      });
    }
    
    // 阶段4：样品寄送功能
    const STAGE4_SHIPPING_KEY = 'design_new_stage4_shipping';
    
    // 从系统加载默认收件信息
    function loadDefaultShippingInfo() {
      // 尝试从localStorage获取已保存的信息
      const saved = localStorage.getItem(STAGE4_SHIPPING_KEY);
      if (saved) {
        try {
          const data = JSON.parse(saved);
          // 如果已保存的信息包含收件人信息，返回它
          if (data.recipientName || data.recipientAddress) {
            return {
              recipientName: data.recipientName || '章三',
              recipientAddress: data.recipientAddress || '昆山市新南西路369号'
            };
          }
        } catch {
          // 如果解析失败，使用默认值
        }
      }
      
      // 默认值（可以从公司信息中获取，这里使用示例数据）
      return {
        recipientName: '章三', // 联系人姓名
        recipientAddress: '昆山市新南西路369号' // 收货地址
      };
    }
    
    // 保存收件信息
    function saveShippingInfo(data) {
      localStorage.setItem(STAGE4_SHIPPING_KEY, JSON.stringify(data));
    }
    
    // 初始化阶段4的样品寄送功能
    function initStage4Shipping() {
      const shippingToggle = document.getElementById('stage4-sample-shipping-toggle');
      const shippingInfo = document.getElementById('stage4-shipping-info');
      const recipientNameInput = document.getElementById('stage4-recipient-name');
      const recipientAddressInput = document.getElementById('stage4-recipient-address');
      const saveShippingBtn = document.getElementById('stage4-save-shipping-btn');
      
      if (!shippingToggle || !shippingInfo || !recipientNameInput || !recipientAddressInput) return;
      
      // 检查是否已选择寄送样品并加载信息
      const savedShipping = localStorage.getItem(STAGE4_SHIPPING_KEY);
      if (savedShipping) {
        try {
          const data = JSON.parse(savedShipping);
          if (data.needShipping) {
            shippingToggle.checked = true;
            shippingInfo.classList.remove('hidden');
            // 加载已保存的收件信息
            recipientNameInput.value = data.recipientName || '';
            recipientAddressInput.value = data.recipientAddress || '';
          } else {
            // 即使未选择寄送，也加载默认信息以便用户切换时使用
            const defaultInfo = loadDefaultShippingInfo();
            recipientNameInput.value = defaultInfo.recipientName || '';
            recipientAddressInput.value = defaultInfo.recipientAddress || '';
          }
        } catch {
          // 如果解析失败，加载默认信息
          const defaultInfo = loadDefaultShippingInfo();
          recipientNameInput.value = defaultInfo.recipientName || '';
          recipientAddressInput.value = defaultInfo.recipientAddress || '';
        }
      } else {
        // 没有保存的信息，加载默认信息
        const defaultInfo = loadDefaultShippingInfo();
        recipientNameInput.value = defaultInfo.recipientName || '';
        recipientAddressInput.value = defaultInfo.recipientAddress || '';
      }
      
      // 样品寄送开关切换
      shippingToggle.addEventListener('change', (e) => {
        if (e.target.checked) {
          shippingInfo.classList.remove('hidden');
          // 加载默认信息或已保存的信息
          const info = loadDefaultShippingInfo();
          recipientNameInput.value = info.recipientName || '';
          recipientAddressInput.value = info.recipientAddress || '';
        } else {
          shippingInfo.classList.add('hidden');
          // 清除保存的寄送信息
          saveShippingInfo({
            needShipping: false,
            recipientName: '',
            recipientAddress: ''
          });
        }
      });
      
      // 保存收件信息
      if (saveShippingBtn) {
        saveShippingBtn.addEventListener('click', () => {
          if (!shippingToggle.checked) {
            alert(t('design-new.alert-select-shipping'));
            return;
          }
          
          const recipientName = recipientNameInput.value.trim();
          const recipientAddress = recipientAddressInput.value.trim();
          
          if (!recipientName) {
            alert(t('design-new.alert-recipient-name-required'));
            recipientNameInput.focus();
            return;
          }
          
          if (!recipientAddress) {
            alert(t('design-new.alert-recipient-address-required'));
            recipientAddressInput.focus();
            return;
          }
          
          const shippingData = {
            needShipping: true,
            recipientName: recipientName,
            recipientAddress: recipientAddress,
            savedAt: new Date().toISOString()
          };
          
          saveShippingInfo(shippingData);
          alert(t('design-new.alert-recipient-info-saved'));
        });
      }
    }
    
    // 当阶段5显示时，初始化样品寄送功能
    const stage4Observer = new MutationObserver((mutations) => {
      const stage4 = document.getElementById('design-new-stage-4');
      if (stage4 && !stage4.classList.contains('hidden')) {
        initStage4Shipping();
      }
    });
    
    const stage4Container = document.getElementById('design-new-stage-4');
    if (stage4Container) {
      stage4Observer.observe(stage4Container, {
        attributes: true,
        attributeFilter: ['class']
      });
    }
    
    // 画稿列表功能
    const ARTWORKS_STORAGE_KEY = 'design_new_artworks_list';
    
    // 生成示例画稿数据
    function generateSampleArtworks() {
      const sampleArtworks = [
        {
          id: 'artwork-1',
          designCode: 'DES-2025-001',
          format: 'LRBA200S',
          plant: '昆山工厂',
          paperboard: 'CB-Coated',
          status: '制作中',
          images: ['customer_designs/RFG/RFG-1.jpg', 'customer_designs/RFG/RFG-2.jpg', 'customer_designs/RFG/RFG-3.jpg', 'customer_designs/RFG/RFG-4.jpg', 'customer_designs/RFG/RFG-5.jpg']
        },
        {
          id: 'artwork-2',
          designCode: 'DES-2025-002',
          format: 'LRBA1000B',
          plant: '印尼工厂',
          paperboard: 'FBB',
          status: '已完成',
          images: ['customer_designs/OAT/FLOAT-1.jpg', 'customer_designs/OAT/FLOAT-2.jpg', 'customer_designs/OAT/FLOAT-3.jpg', 'customer_designs/OAT/FLOAT-4.jpg', 'customer_designs/OAT/FLOAT-5.jpg']
        },
        {
          id: 'artwork-3',
          designCode: 'DES-2025-003',
          format: 'LRBA200S',
          plant: '昆山工厂',
          paperboard: 'GC1',
          status: '待确认',
          images: ['customer_designs/Unikai/UNIKAI-1.jpg', 'customer_designs/Unikai/UNIKAI-2.jpg', 'customer_designs/Unikai/UNIKAI-3.jpg', 'customer_designs/Unikai/UNIKAI-4.jpg', 'customer_designs/Unikai/UNIKAI-5.jpg']
        },
        {
          id: 'artwork-4',
          designCode: 'DES-2025-004',
          format: 'LRBA1000B',
          plant: '昆山工厂',
          paperboard: 'CTB-Coated',
          status: '已确认',
          images: ['customer_designs/RFG/RFG-6.jpg', 'customer_designs/RFG/RFG-7.jpg', 'customer_designs/RFG/RFG-8.jpg', 'customer_designs/RFG/RFG-9.jpg']
        },
        {
          id: 'artwork-5',
          designCode: 'DES-2025-005',
          format: 'LRBA200S',
          plant: '印尼工厂',
          paperboard: 'PE-Coated Board',
          status: '制作中',
          images: ['customer_designs/OAT/FLOAT-6.jpg', 'customer_designs/OAT/FLOAT-7.jpg', 'customer_designs/OAT/FLOAT-8.jpg', 'customer_designs/OAT/FLOAT-9.jpg']
        }
      ];
      
      // 检查是否已有数据
      const existing = localStorage.getItem(ARTWORKS_STORAGE_KEY);
      if (!existing) {
        localStorage.setItem(ARTWORKS_STORAGE_KEY, JSON.stringify(sampleArtworks));
      }
      return sampleArtworks;
    }
    
    // 获取画稿列表
    function getArtworksList() {
      try {
        const stored = localStorage.getItem(ARTWORKS_STORAGE_KEY);
        if (stored) {
          return JSON.parse(stored);
        }
      } catch {}
      return generateSampleArtworks();
    }
    
    // 渲染画稿列表
    function renderArtworksList(filteredList = null) {
      const tbody = document.getElementById('artworks-list-tbody');
      const emptyState = document.getElementById('artworks-empty-state');
      if (!tbody || !emptyState) return;
      
      const artworks = filteredList !== null ? filteredList : getArtworksList();
      
      if (artworks.length === 0) {
        tbody.innerHTML = '';
        emptyState.classList.remove('hidden');
        return;
      }
      
      emptyState.classList.add('hidden');
      
      tbody.innerHTML = artworks.map(artwork => {
        const statusColors = {
          '制作中': 'bg-blue-100 text-blue-800',
          '已完成': 'bg-green-100 text-green-800',
          '待确认': 'bg-yellow-100 text-yellow-800',
          '已确认': 'bg-purple-100 text-purple-800'
        };
        const statusColor = statusColors[artwork.status] || 'bg-gray-100 text-gray-800';
        
        // 翻译状态文本
        const statusKeyMap = {
          '制作中': 'design-new.status-in-production',
          '已完成': 'design-new.status-completed',
          '待确认': 'design-new.status-pending',
          '已确认': 'design-new.status-confirmed'
        };
        const statusText = t(statusKeyMap[artwork.status] || artwork.status);
        
        // 翻译工厂名称
        const plantKeyMap = {
          '昆山工厂': 'design-new.plant-kunshan',
          '印尼工厂': 'design-new.plant-indonesia'
        };
        const plantText = t(plantKeyMap[artwork.plant] || artwork.plant);
        
        return `
          <tr class="hover:bg-gray-50 transition">
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${artwork.designCode}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">${artwork.format}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">${plantText}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">${artwork.paperboard}</td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="px-2 py-1 text-xs font-medium rounded-full ${statusColor}">${statusText}</span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm">
              <button type="button" class="btn-view-artwork-images text-blue-600 hover:text-blue-800 font-medium flex items-center" data-artwork-id="${artwork.id}">
                <span class="iconify mr-1" data-icon="mdi:image"></span>
                ${t('design-new.view-images')}
              </button>
            </td>
          </tr>
        `;
      }).join('');
    }
    
    // 搜索画稿
    function searchArtworks() {
      const format = document.getElementById('artworks-search-format')?.value.trim().toLowerCase() || '';
      const plant = document.getElementById('artworks-search-plant')?.value || '';
      const paperboard = document.getElementById('artworks-search-paperboard')?.value || '';
      const status = document.getElementById('artworks-search-status')?.value || '';
      
      const allArtworks = getArtworksList();
      const filtered = allArtworks.filter(artwork => {
        const matchFormat = !format || artwork.format.toLowerCase().includes(format);
        const matchPlant = !plant || artwork.plant === plant;
        const matchPaperboard = !paperboard || artwork.paperboard === paperboard;
        const matchStatus = !status || artwork.status === status;
        
        return matchFormat && matchPlant && matchPaperboard && matchStatus;
      });
      
      renderArtworksList(filtered);
    }
    
    // 重置搜索
    function resetSearch() {
      document.getElementById('artworks-search-format').value = '';
      document.getElementById('artworks-search-plant').value = '';
      document.getElementById('artworks-search-paperboard').value = '';
      document.getElementById('artworks-search-status').value = '';
      renderArtworksList();
    }
    
    // 查看画稿图片
    function openArtworkImagesModal(artwork) {
      const modal = document.getElementById('designImagesModal');
      const title = document.getElementById('designImagesModalTitle');
      const body = document.getElementById('designImagesModalBody');
      if (!modal || !body) return;
      
      if (title) title.textContent = `画稿设计图片 - ${artwork.designCode}`;
      
      // 生成版本数据（模拟）
      const versions = [
        { name: '设计版本 V1 (当前版本)', date: '2025-11-20', isCurrent: true },
        { name: '设计版本 V0 (历史版本)', date: '2025-11-15', isCurrent: false },
      ];
      
      body.innerHTML = `
        <div class="space-y-6">
          ${versions.map((v, i) => `
            <div class="border border-gray-200 rounded-xl overflow-hidden">
              <div class="px-4 py-3 bg-gray-50 flex items-center justify-between border-b border-gray-200">
                <div class="flex items-center">
                  <span class="iconify ${v.isCurrent ? 'text-green-500' : 'text-gray-400'} mr-2" data-icon="mdi:file-${v.isCurrent ? 'check' : 'document'}"></span>
                  <span class="text-sm font-medium">${v.name}</span>
                </div>
                <span class="text-xs text-gray-500">${v.date}</span>
              </div>
              <div class="p-4 flex items-center gap-3 overflow-x-auto pb-2">
                ${artwork.images.map((img, idx) => `
                  <div class="flex-shrink-0 w-32 h-32 bg-gray-100 rounded border-2 border-gray-300 overflow-hidden cursor-pointer hover:border-blue-500 transition group relative">
                    <img src="${img}" alt="设计图片 ${idx + 1}" class="w-full h-full object-cover group-hover:opacity-90 transition" 
                         onclick="this.closest('.bg-white') && (() => { const img = this.cloneNode(true); img.className = 'max-w-full max-h-[80vh] object-contain cursor-zoom-out'; img.onclick = () => img.remove(); const overlay = document.createElement('div'); overlay.className = 'fixed inset-0 bg-black/80 z-[70] flex items-center justify-center p-4'; overlay.onclick = (e) => e.target === overlay && overlay.remove(); overlay.appendChild(img); document.body.appendChild(overlay); })()">
                    <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition flex items-center justify-center">
                      <span class="iconify text-white text-2xl opacity-0 group-hover:opacity-100 transition" data-icon="mdi:eye"></span>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          `).join('')}
        </div>
      `;
      
      modal.classList.remove('hidden');
    }
    
    // 绑定搜索和重置按钮事件
    const searchBtn = document.getElementById('artworks-search-btn');
    const resetBtn = document.getElementById('artworks-reset-btn');
    const searchFormat = document.getElementById('artworks-search-format');
    const searchPlant = document.getElementById('artworks-search-plant');
    const searchPaperboard = document.getElementById('artworks-search-paperboard');
    const searchStatus = document.getElementById('artworks-search-status');
    
    if (searchBtn) {
      searchBtn.addEventListener('click', searchArtworks);
    }
    if (resetBtn) {
      resetBtn.addEventListener('click', resetSearch);
    }
    
    // 实时搜索（输入时自动搜索）
    if (searchFormat) {
      searchFormat.addEventListener('input', searchArtworks);
    }
    if (searchPlant) {
      searchPlant.addEventListener('change', searchArtworks);
    }
    if (searchPaperboard) {
      searchPaperboard.addEventListener('change', searchArtworks);
    }
    if (searchStatus) {
      searchStatus.addEventListener('change', searchArtworks);
    }
    
    // 绑定查看图片按钮事件（事件委托）
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('.btn-view-artwork-images');
      if (btn) {
        const artworkId = btn.dataset.artworkId;
        const artworks = getArtworksList();
        const artwork = artworks.find(a => a.id === artworkId);
        if (artwork) {
          openArtworkImagesModal(artwork);
        }
      }
    });
    
    // 初始化：显示概览并更新卡片样式
    currentStage = 1; // 初始可访问阶段1
    showStageView(0); // 显示概览
    updateStageCards(); // 更新卡片样式
    
    // 保留查看图片功能
    function openDesignImagesModal(artwork) {
      const modal = document.getElementById('designImagesModal');
      const title = document.getElementById('designImagesModalTitle');
      const body = document.getElementById('designImagesModalBody');
      if (!modal || !body) return;
      if (title) title.textContent = `画稿设计图片 - ${artwork.designCode || artwork.productTitle || '画稿'}`;
      const versions = [
        { name: '设计版本 V1 (当前版本)', date: '2025-11-20', isCurrent: true },
        { name: '设计版本 V0 (历史版本)', date: '2025-11-15', isCurrent: false },
      ];
      body.innerHTML = `
<div class="space-y-6">
${versions.map((v, i) => `
<div class="border border-gray-200 rounded-xl overflow-hidden">
<div class="px-4 py-3 bg-gray-50 flex items-center justify-between border-b border-gray-200">
<div class="flex items-center">
<span class="iconify ${v.isCurrent ? 'text-green-500' : 'text-gray-400'} mr-2" data-icon="mdi:file-${v.isCurrent ? 'check' : 'document'}"></span>
<span class="text-sm font-medium">${v.name}</span>
</div>
<span class="text-xs text-gray-500">${v.date}</span>
</div>
<div class="p-4 flex items-center gap-3 overflow-x-auto pb-2">
${[1,2,3,4,5].map(n => `
<div class="flex-shrink-0 w-24 h-24 bg-gray-100 rounded border border-gray-300 flex items-center justify-center cursor-pointer hover:border-blue-500 transition">
<span class="iconify text-3xl text-gray-400" data-icon="mdi:image"></span>
</div>
`).join('')}
</div>
</div>
`).join('')}
</div>`;
      modal.classList.remove('hidden');
    }
    
    document.addEventListener('click', (e) => {
      const viewBtn = e.target.closest('.btn-view-design');
      if (viewBtn) {
        const id = viewBtn.dataset.id;
        const list = getDesignNewArtworks();
        const a = list.find(x => x.id === id);
        if (a) openDesignImagesModal(a);
      }
    });
    
    function openDesignImagesModal(artwork) {
      const modal = document.getElementById('designImagesModal');
      const title = document.getElementById('designImagesModalTitle');
      const body = document.getElementById('designImagesModalBody');
      if (!modal || !body) return;
      if (title) title.textContent = `画稿设计图片 - ${artwork.designCode || artwork.productTitle || '画稿'}`;
      const versions = [
        { name: '设计版本 V1 (当前版本)', date: '2025-11-20', isCurrent: true },
        { name: '设计版本 V0 (历史版本)', date: '2025-11-15', isCurrent: false },
      ];
      body.innerHTML = `
<div class="space-y-6">
${versions.map((v, i) => `
<div class="border border-gray-200 rounded-xl overflow-hidden">
<div class="px-4 py-3 bg-gray-50 flex items-center justify-between border-b border-gray-200">
<div class="flex items-center">
<span class="iconify ${v.isCurrent ? 'text-green-500' : 'text-gray-400'} mr-2" data-icon="mdi:file-${v.isCurrent ? 'check' : 'document'}"></span>
<span class="text-sm font-medium">${v.name}</span>
</div>
<span class="text-xs text-gray-500">${v.date}</span>
</div>
<div class="p-4 flex items-center gap-3 overflow-x-auto pb-2">
${[1,2,3,4,5].map(n => `
<div class="flex-shrink-0 w-24 h-24 bg-gray-100 rounded border border-gray-300 flex items-center justify-center cursor-pointer hover:border-blue-500 transition">
<span class="iconify text-3xl text-gray-400" data-icon="mdi:image"></span>
</div>
`).join('')}
</div>
</div>
`).join('')}
</div>`;
      modal.classList.remove('hidden');
    }
    
    const closeDesignImagesModalBtn = document.getElementById('closeDesignImagesModalBtn');
    const designImagesModal = document.getElementById('designImagesModal');
    if (closeDesignImagesModalBtn && designImagesModal) {
      closeDesignImagesModalBtn.addEventListener('click', () => designImagesModal.classList.add('hidden'));
    }
    if (designImagesModal) {
      designImagesModal.addEventListener('click', (e) => {
        if (e.target === designImagesModal) designImagesModal.classList.add('hidden');
      });
    }
    
    // 订单配置步骤切换
    document.querySelectorAll('.step-btn').forEach(button => {
      button.addEventListener('click', () => {
        // 移除所有激活状态
        document.querySelectorAll('.step-btn').forEach(btn => btn.classList.remove('bg-blue-600', 'text-white'));
        document.querySelectorAll('.step').forEach(step => step.classList.remove('step-active'));
        
        // 添加当前激活状态
        button.classList.add('bg-blue-600', 'text-white');
        document.getElementById(button.dataset.step).classList.add('step-active');
      });
    });
    
    // 步骤导航按钮
    document.querySelectorAll('.next-step').forEach(button => {
      button.addEventListener('click', () => {
        if(button.dataset.target) {
          const currentStep = button.closest('.step');
          currentStep.classList.remove('step-active');
          document.getElementById(button.dataset.target).classList.add('step-active');
          
          // 如果是从step1切换到step2，且已选择设计图片，则更新下单页面的图片
          if(button.dataset.target === 'step2' && selectedDesignImage) {
            const mainProductImg = document.getElementById('mainProductImg');
            if(mainProductImg) {
              mainProductImg.src = selectedDesignImage;
            }
          }
          
          // 更新步骤按钮状态
          const stepBtn = document.querySelector(`.step-btn[data-step="${button.dataset.target}"]`);
          document.querySelectorAll('.step-btn').forEach(btn => btn.classList.remove('bg-blue-600', 'text-white'));
          stepBtn.classList.add('bg-blue-600', 'text-white');
        }
      });
    });
    
    document.querySelectorAll('.prev-step').forEach(button => {
      button.addEventListener('click', () => {
        const currentStep = button.closest('.step');
        currentStep.classList.remove('step-active');
        document.getElementById(button.dataset.target).classList.add('step-active');
        
        // 更新步骤按钮状态
        const stepBtn = document.querySelector(`.step-btn[data-step="${button.dataset.target}"]`);
        document.querySelectorAll('.step-btn').forEach(btn => btn.classList.remove('bg-blue-600', 'text-white'));
        stepBtn.classList.add('bg-blue-600', 'text-white');
      });
    });
    
    // 订单SKU数据（示例数据，实际应该从API获取）
    const orderSKUData = [
      {
        id: 1,
        name: "饮料包装设计 #DRK-2023",
        materialNumber: "NP-20345-1",
        format: "200S 160C*4.2U-Straw",
        material: "PE-Al-Paper",
        machine: "Tetra Pak A3",
        filling: "UHT牛奶",
        paperRequirement: "FSC认证原纸",
        certifications: ["PEFC", "FSC"],
        quantity: 100,
        unit: "箱",
        unitPrice: 45.80,
        subtotal: 4900.00,
        mainImage: "customer_designs/OAT/FLOAT-1.jpg",
        detailImages: [
          "customer_designs/OAT/FLOAT-2.jpg",
          "customer_designs/OAT/FLOAT-4.jpg",
          "customer_designs/OAT/FLOAT-5.jpg",
          "customer_designs/OAT/FLOAT-6.jpg"
        ]
      },
      {
        id: 2,
        name: "乳品包装设计 #DARY-2024",
        materialNumber: "NP-20345-2",
        format: "LBA1000B",
        material: "PET-Paper",
        machine: "SIG CFA122",
        filling: "乳制品",
        paperRequirement: "标准原纸",
        certifications: ["FSC"],
        quantity: 100,
        unit: "箱",
        unitPrice: 48.00,
        subtotal: 4800.00,
        mainImage: "customer_designs/Unikai/UNIKAI-4.jpg",
        detailImages: [
          "customer_designs/Unikai/UNIKAI-1.jpg",
          "customer_designs/Unikai/UNIKAI-9.jpg"
        ]
      },
      {
        id: 3,
        name: "牛奶包装设计 #MILK-2024",
        materialNumber: "NP-20345-3",
        format: "200S",
        material: "PE-Al-Paper",
        machine: "Tetra Pak A3",
        filling: "UHT牛奶",
        paperRequirement: "FSC认证原纸",
        certifications: ["PEFC", "FSC"],
        quantity: 100,
        unit: "箱",
        unitPrice: 50.00,
        subtotal: 5000.00,
        mainImage: "customer_designs/RFG/RFG-1.jpg",
        detailImages: [
          "customer_designs/RFG/RFG-2.jpg",
          "customer_designs/RFG/RFG-3.jpg",
          "customer_designs/RFG/RFG-4.jpg"
        ]
      }
    ];
    
    // 翻译数据值的辅助函数
    function translateDataValue(value, type) {
      const translations = {
        'unit': {
          '箱': t('order-detail.unit-case'),
          'case': t('order-detail.unit-case'),
        },
        'name': {
          '饮料包装设计 #DRK-2023': t('order-detail.product-name-drk'),
          'Beverage Packaging Design #DRK-2023': t('order-detail.product-name-drk'),
          '乳品包装设计 #DARY-2024': t('order-detail.product-name-dary'),
          'Dairy Packaging Design #DARY-2024': t('order-detail.product-name-dary'),
          '牛奶包装设计 #MILK-2024': t('order-detail.product-name-milk'),
          'Milk Packaging Design #MILK-2024': t('order-detail.product-name-milk'),
        },
        'filling': {
          'UHT牛奶': t('order-detail.filling-uht-milk'),
          'UHT Milk': t('order-detail.filling-uht-milk'),
          '乳制品': t('order-detail.filling-dairy'),
          'Dairy Products': t('order-detail.filling-dairy'),
        },
        'paperRequirement': {
          'FSC认证原纸': t('order-detail.paper-fsc'),
          'FSC Certified Paper': t('order-detail.paper-fsc'),
          '标准原纸': t('order-detail.standard-paper'),
          'Standard Paper': t('order-detail.standard-paper'),
        }
      };
      
      if (translations[type] && translations[type][value]) {
        return translations[type][value];
      }
      return value;
    }
    
    // 渲染SKU表格
    function renderSKUTable(skuData) {
      const tbody = document.getElementById('skuTableBody');
      const container = document.getElementById('skuDetailContainer');
      if (!tbody) return;
      
      // 清空之前的详情
      if (container) {
        container.innerHTML = '';
      }
      
      tbody.innerHTML = skuData.map((sku, index) => {
        const translatedName = translateDataValue(sku.name, 'name');
        const translatedUnit = translateDataValue(sku.unit, 'unit');
        return `
        <tr class="border-b border-gray-200 hover:bg-blue-50 transition cursor-pointer sku-table-row group" data-sku-id="${sku.id}">
          <td class="px-4 py-3 text-sm text-gray-800 font-medium">${translatedName}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${sku.materialNumber}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${sku.format}</td>
          <td class="px-4 py-3 text-sm text-gray-800 text-right">${sku.quantity} ${translatedUnit}</td>
          <td class="px-4 py-3 text-sm text-gray-800 text-right">¥${sku.unitPrice.toFixed(2)}/${translatedUnit}</td>
          <td class="px-4 py-3 text-sm font-semibold text-green-600 text-right">¥${sku.subtotal.toFixed(2)}</td>
          <td class="px-4 py-3 text-center">
            <button class="view-sku-detail-btn text-blue-600 hover:text-blue-800 text-sm font-medium px-3 py-1 rounded hover:bg-blue-100 transition" data-sku-id="${sku.id}">
              <span class="iconify inline-block" data-icon="mdi:chevron-down"></span> ${t('order-detail.view-details')}
            </button>
          </td>
        </tr>
      `;
      }).join('');
      
      // 绑定点击事件 - 整行和按钮都可以点击
      document.querySelectorAll('.sku-table-row').forEach(row => {
        row.addEventListener('click', (e) => {
          // 如果点击的是按钮，不阻止默认行为
          if (e.target.closest('.view-sku-detail-btn')) {
            return;
          }
          const skuId = parseInt(row.dataset.skuId);
          if (skuId) {
            toggleSKUDetail(skuId, skuData);
          }
        });
      });
      
      // 单独绑定按钮点击事件
      document.querySelectorAll('.view-sku-detail-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const skuId = parseInt(btn.dataset.skuId);
          if (skuId) {
            toggleSKUDetail(skuId, skuData);
          }
        });
      });
    }
    
    // 切换SKU详情显示
    function toggleSKUDetail(skuId, skuData) {
      const sku = skuData.find(s => s.id === skuId);
      if (!sku) return;
      
      const container = document.getElementById('skuDetailContainer');
      if (!container) return;
      
      const detailId = `sku-detail-${skuId}`;
      let detailElement = document.getElementById(detailId);
      const btn = document.querySelector(`.view-sku-detail-btn[data-sku-id="${skuId}"]`);
      const row = document.querySelector(`.sku-table-row[data-sku-id="${skuId}"]`);
      
      if (detailElement) {
        // 如果已存在，则切换显示/隐藏
        const isHidden = detailElement.classList.contains('hidden');
        detailElement.classList.toggle('hidden');
        
        // 更新按钮和行的样式
        if (btn) {
          const icon = isHidden ? 'mdi:chevron-up' : 'mdi:chevron-down';
          btn.innerHTML = `<span class="iconify inline-block transition-transform" data-icon="${icon}"></span> ${isHidden ? t('order-detail.hide-details') : t('order-detail.view-details')}`;
        }
        if (row) {
          if (isHidden) {
            row.classList.add('bg-blue-50');
          } else {
            row.classList.remove('bg-blue-50');
          }
        }
        
        // 滚动到详情区域
        if (isHidden) {
          setTimeout(() => {
            detailElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 100);
        }
      } else {
        // 创建新的详情元素
        detailElement = document.createElement('div');
        detailElement.id = detailId;
        detailElement.className = 'bg-white rounded-xl border border-gray-200 p-6 shadow-sm';
        
        const certificationsHtml = sku.certifications && sku.certifications.length > 0 
          ? sku.certifications.map(cert => 
              `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">${cert}</span>`
            ).join('')
          : `<span class="text-gray-400 text-xs">${t('order-detail.no-certification')}</span>`;
        
        const detailImagesHtml = sku.detailImages && sku.detailImages.length > 0
          ? sku.detailImages.map((img, idx) => 
              `<img alt="细节图${idx + 1}" class="w-20 h-20 object-cover rounded cursor-pointer border-2 border-gray-300 hover:border-blue-600 transition" onclick="document.getElementById('orderMainImg${skuId}').src=this.src" src="${img}"/>`
            ).join('')
          : '';
        
        detailElement.innerHTML = `
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- 左侧：产品图片 -->
            <div>
              <div class="bg-gray-100 rounded-xl p-4">
                <img alt="产品主图" class="w-full h-80 object-cover rounded-lg mb-3" id="orderMainImg${skuId}" src="${sku.mainImage || 'customer_designs/RFG/RFG-1.jpg'}"/>
                ${detailImagesHtml ? `<div class="flex space-x-2 overflow-x-auto">${detailImagesHtml}</div>` : ''}
              </div>
            </div>
            <!-- 右侧：产品规格信息 -->
            <div>
              <div class="mb-4">
                <h5 class="font-semibold text-lg text-gray-800 mb-2">SKU #${sku.id}: ${translateDataValue(sku.name, 'name')}</h5>
                <div class="text-sm text-gray-600 mb-4">${t('order-detail.material-number-label')}: ${sku.materialNumber}</div>
              </div>
              <div class="bg-gray-50 rounded-lg p-4 mb-4">
                <h6 class="font-semibold text-gray-800 mb-3">${t('order-detail.product-spec')}</h6>
                <div class="grid grid-cols-2 gap-3 mb-3">
                  <div>
                    <label class="block text-gray-600 mb-1 text-xs">${t('order-detail.format-label')}</label>
                    <div class="text-gray-800 font-medium text-sm">${sku.format}</div>
                  </div>
                  <div>
                    <label class="block text-gray-600 mb-1 text-xs">${t('order-detail.material-structure')}</label>
                    <div class="text-gray-800 font-medium text-sm">${sku.material}</div>
                  </div>
                </div>
                <h6 class="font-semibold text-gray-800 mb-3 mt-4">${t('order-detail.product-params')}</h6>
                <div class="grid grid-cols-2 gap-3">
                  <div>
                    <label class="block text-gray-600 mb-1 text-xs">${t('order-detail.machine-model')}</label>
                    <div class="text-gray-800 font-medium text-sm">${sku.machine}</div>
                  </div>
                  <div>
                    <label class="block text-gray-600 mb-1 text-xs">${t('order-detail.filling-type')}</label>
                    <div class="text-gray-800 font-medium text-sm">${translateDataValue(sku.filling, 'filling')}</div>
                  </div>
                  <div>
                    <label class="block text-gray-600 mb-1 text-xs">${t('order-detail.paper-requirement')}</label>
                    <div class="text-gray-800 font-medium text-sm">${translateDataValue(sku.paperRequirement || '标准原纸', 'paperRequirement')}</div>
                  </div>
                  <div>
                    <label class="block text-gray-600 mb-1 text-xs">${t('order-detail.certification')}</label>
                    <div class="flex flex-wrap gap-2">
                      ${certificationsHtml}
                    </div>
                  </div>
                </div>
              </div>
              <div class="bg-blue-50 rounded-lg p-4">
                <div class="flex justify-between items-center mb-2">
                  <span class="text-gray-600 text-sm">${t('order-detail.quantity-label')}:</span>
                  <span class="font-medium">${sku.quantity} ${translateDataValue(sku.unit, 'unit')}</span>
                </div>
                <div class="flex justify-between items-center mb-2">
                  <span class="text-gray-600 text-sm">${t('order-detail.unit-price')}:</span>
                  <span class="font-medium">¥${sku.unitPrice.toFixed(2)}/${translateDataValue(sku.unit, 'unit')}</span>
                </div>
                <div class="flex justify-between items-center pt-2 border-t border-blue-200">
                  <span class="text-gray-600 font-semibold">${t('order-detail.subtotal')}:</span>
                  <span class="font-bold text-green-600">¥${sku.subtotal.toFixed(2)}</span>
                </div>
              </div>
            </div>
          </div>
        `;
        
        container.appendChild(detailElement);
        
        // 更新按钮和行的样式
        if (btn) {
          btn.innerHTML = `<span class="iconify inline-block transition-transform" data-icon="mdi:chevron-up"></span> 隐藏详情`;
        }
        if (row) {
          row.classList.add('bg-blue-50');
        }
        
        // 滚动到详情区域
        setTimeout(() => {
          detailElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
      }
    }
    
    // 订单详情section控制
    const ordersList = document.getElementById('ordersList');
    const orderDetail = document.getElementById('orderDetail');
    const orderDetailContent = document.getElementById('orderDetailContent');
    const complaintPage = document.getElementById('complaintPage');
    const backToOrdersList = document.getElementById('backToOrdersList');
    const cancelComplaintBtn = document.getElementById('cancelComplaintBtn');
    const breadcrumbOrders = document.getElementById('breadcrumbOrders');
    const breadcrumbOrders2 = document.getElementById('breadcrumbOrders2');
    const breadcrumbOrderDetail = document.getElementById('breadcrumbOrderDetail');
    
    // 打开订单详情
    document.querySelectorAll('.view-order-btn').forEach(button => {
      button.addEventListener('click', () => {
        const orderId = button.dataset.orderId;
        // 这里可以根据orderId加载不同的订单数据
        document.getElementById('orderDetailNumber').textContent = orderId;
        document.getElementById('complaintOrderNumber').textContent = orderId;
        ordersList.classList.add('hidden');
        orderDetail.classList.remove('hidden');
        orderDetailContent.classList.remove('hidden');
        complaintPage.classList.add('hidden');
        
        // 清除之前的详情展开状态
        const container = document.getElementById('skuDetailContainer');
        if (container) {
          container.innerHTML = '';
        }
        
        // 渲染SKU表格
        renderSKUTable(orderSKUData);
      });
    });
    
    // 返回订单列表
    if (backToOrdersList) {
      backToOrdersList.addEventListener('click', () => {
        orderDetail.classList.add('hidden');
        orderDetailContent.classList.add('hidden');
        complaintPage.classList.add('hidden');
        ordersList.classList.remove('hidden');
      });
    }
    
    // 发起客诉按钮
    const openComplaintBtn = document.getElementById('openComplaintBtn');
    if (openComplaintBtn) {
      openComplaintBtn.addEventListener('click', () => {
        orderDetailContent.classList.add('hidden');
        complaintPage.classList.remove('hidden');
      });
    }
    
    if (cancelComplaintBtn) {
      cancelComplaintBtn.addEventListener('click', () => {
        complaintPage.classList.add('hidden');
        orderDetailContent.classList.remove('hidden');
      });
    }
    
    // 面包屑导航 - 返回订单列表
    if (breadcrumbOrders) {
      breadcrumbOrders.addEventListener('click', (e) => {
        e.preventDefault();
        orderDetail.classList.add('hidden');
        orderDetailContent.classList.add('hidden');
        complaintPage.classList.add('hidden');
        ordersList.classList.remove('hidden');
      });
    }
    
    if (breadcrumbOrders2) {
      breadcrumbOrders2.addEventListener('click', (e) => {
        e.preventDefault();
        orderDetail.classList.add('hidden');
        orderDetailContent.classList.add('hidden');
        complaintPage.classList.add('hidden');
        ordersList.classList.remove('hidden');
      });
    }
    
    // 面包屑导航 - 返回订单详情
    if (breadcrumbOrderDetail) {
      breadcrumbOrderDetail.addEventListener('click', (e) => {
        e.preventDefault();
        complaintPage.classList.add('hidden');
        orderDetailContent.classList.remove('hidden');
      });
    }
    

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    // 公司信息模态框功能
    (function() {
      const companyInfoBtn = document.getElementById('companyInfoBtn');
      const companyInfoModal = document.getElementById('companyInfoModal');
      const closeCompanyInfoModal = document.getElementById('closeCompanyInfoModal');
      const closeCompanyInfoModalBtn = document.getElementById('closeCompanyInfoModalBtn');
      const companyNameInput = document.getElementById('companyNameInput');
      const companyNameDisplay = document.getElementById('companyNameDisplay');
      const editCompanyNameBtn = document.getElementById('editCompanyNameBtn');
      const saveCompanyNameBtn = document.getElementById('saveCompanyNameBtn');
      const cancelCompanyNameBtn = document.getElementById('cancelCompanyNameBtn');
      const companyNameEditActions = document.getElementById('companyNameEditActions');
      
      let originalCompanyName = companyNameInput ? companyNameInput.value : '';
      
      // 打开模态框
      if (companyInfoBtn && companyInfoModal) {
        companyInfoBtn.addEventListener('click', () => {
          companyInfoModal.classList.remove('hidden');
          // 重置编辑状态
          if (companyNameInput) {
            companyNameInput.disabled = true;
            companyNameInput.value = originalCompanyName;
          }
          if (companyNameEditActions) {
            companyNameEditActions.classList.add('hidden');
          }
        });
      }
      
      // 关闭模态框
      function closeModal() {
        if (companyInfoModal) {
          companyInfoModal.classList.add('hidden');
        }
        // 重置编辑状态
        if (companyNameInput) {
          companyNameInput.disabled = true;
          companyNameInput.value = originalCompanyName;
          companyNameInput.classList.remove('bg-white');
          companyNameInput.classList.add('bg-gray-50', 'cursor-not-allowed');
        }
        if (companyNameEditActions) {
          companyNameEditActions.classList.add('hidden');
        }
      }
      
      if (closeCompanyInfoModal) {
        closeCompanyInfoModal.addEventListener('click', closeModal);
      }
      
      if (closeCompanyInfoModalBtn) {
        closeCompanyInfoModalBtn.addEventListener('click', closeModal);
      }
      
      // 点击模态框外部关闭
      if (companyInfoModal) {
        companyInfoModal.addEventListener('click', (e) => {
          if (e.target === companyInfoModal) {
            closeModal();
          }
        });
      }
      
      // 编辑公司名称
      if (editCompanyNameBtn && companyNameInput) {
        editCompanyNameBtn.addEventListener('click', () => {
          companyNameInput.disabled = false;
          companyNameInput.classList.remove('bg-gray-50', 'cursor-not-allowed');
          companyNameInput.classList.add('bg-white');
          companyNameInput.focus();
          companyNameInput.select();
          if (companyNameEditActions) {
            companyNameEditActions.classList.remove('hidden');
          }
        });
      }
      
      // 保存公司名称
      if (saveCompanyNameBtn && companyNameInput && companyNameDisplay) {
        saveCompanyNameBtn.addEventListener('click', () => {
          const newName = companyNameInput.value.trim();
          if (!newName) {
            alert(t('company.name-required'));
            companyNameInput.focus();
            return;
          }
          
          // 这里应该调用API保存公司名称
          // 示例：await updateCompanyName(newName);
          // 实际使用时，可以这样：
          // try {
          //   const response = await fetch('/api/company/name', {
          //     method: 'PUT',
          //     headers: { 'Content-Type': 'application/json' },
          //     body: JSON.stringify({ companyName: newName })
          // });
          //   if (!response.ok) throw new Error('保存失败');
          // } catch (error) {
          //   alert('保存失败，请稍后重试');
          //   return;
          // }
          
          // 更新显示
          originalCompanyName = newName;
          companyNameDisplay.textContent = newName;
          
          // 禁用输入框并隐藏操作按钮
          companyNameInput.disabled = true;
          companyNameInput.classList.remove('bg-white');
          companyNameInput.classList.add('bg-gray-50', 'cursor-not-allowed');
          if (companyNameEditActions) {
            companyNameEditActions.classList.add('hidden');
          }
          
          // 显示成功提示
          alert(t('company.save-success'));
        });
      }
      
      // 取消编辑公司名称
      if (cancelCompanyNameBtn && companyNameInput) {
        cancelCompanyNameBtn.addEventListener('click', () => {
          companyNameInput.value = originalCompanyName;
          companyNameInput.disabled = true;
          companyNameInput.classList.remove('bg-white');
          companyNameInput.classList.add('bg-gray-50', 'cursor-not-allowed');
          if (companyNameEditActions) {
            companyNameEditActions.classList.add('hidden');
          }
        });
      }
      
      // ESC键关闭模态框
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && companyInfoModal && !companyInfoModal.classList.contains('hidden')) {
          closeModal();
        }
      });
    })();
  </script>
</body>
</html>

